// https://github.com/russellsamora/scrollama
// Version: 2.2.0
// Author: Russell Samora
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).scrollama=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}var a=(function(){var e=["debug"];function n(t){e.indexOf(t)>-1&&console&&console.log("scrollama ~ ["+t+"]")}return function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];"object"===e(o[0])&&o[0].msg&&n(o[0].msg)}}(),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(" ")}),t=function(){return window.innerHeight},n=function(){return"scrollama__debug-offset"},o=function(){return"scrollama__debug-step--active"},i=function(){return"scrollama__debug-step--offset-"+u()},r=function(){return"scrollama__debug-step"},s=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data-scrollama-index";return document.querySelectorAll("[".concat(n,'="').concat(e,'"]'))},c=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"data-scrollama-index",i=s(e,o);Array.prototype.forEach.call(i,function(e){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")});var r=s(n,o);if(r.length){var c=r[0].classList?r[0].classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(r[0].className);c||Array.prototype.forEach.call(r,function(e){e.classList?e.classList.add(t):e.className+=" "+t})}},l=function(e){if("object"!==e(e))throw new Error("scrollama error: query option must be an Dom element or selector");var t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error("scrollama error: couldn't find a Dom element matching that query");return t},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.getBoundingClientRect();return{top:n.top+t,bottom:n.bottom+t,height:n.height,width:n.width}},f=function(e,t){var n=function(e,t){var n=e.getBoundingClientRect();return{top:n.top+t,right:n.right,bottom:n.bottom+t,left:n.left,width:n.width,height:n.height}}(e,0),o=t||0;return{top:n.top+o,right:n.right,bottom:n.bottom+o,left:n.left,width:n.width,height:n.height}},u=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=String(e),i=o.split("."),r=i[0],s=i.length>1?"."+i[1]:"",c=r.length,l=void 0===t?-1:t,p=void 0===n?"":n,f=c;f<l;f++)r="0"+r;return p+r+s};return function(){var e,s,g,d=!1,m={},h=[],v=!1,b=0,y=.5,w=0,E=0,S=!1,A=!1,x=!1,D=[],N=0,k=!1,q=!1,_=!1,L="step",j="edge",I="px",B="",M="[data-scrollama-index]",C=0,F=0,H=function(){k=!1,d=!1,m={step:"step",offset:.5,progress:!1,threshold:4,order:!0,once:!1,debug:!1,container:window,gutter:0,entered:!1},h=[]},P=function(e){v&&e&&(e.id?m.id=e.id:m.id||(m.id=u(E)),g=l(e.step||e.stepEl||M),m.offset="number"==typeof e.offset?e.offset:m.offset,m.progress="boolean"==typeof e.progress?e.progress:m.progress,m.threshold="number"==typeof e.threshold?e.threshold:m.threshold,m.order="boolean"==typeof e.order?e.order:m.order,m.once="boolean"==typeof e.once?e.once:m.once,m.debug="boolean"==typeof e.debug?e.debug:m.debug,m.gutter="number"==typeof e.gutter?e.gutter:m.gutter,m.entered="boolean"==typeof e.entered?e.entered:m.entered,m.container=void 0!==e.container?l(e.container):m.container,m.step=g,L=Object.prototype.toString.call(g),j=m.progress?"top":"edge",x=L.indexOf("HTMLCollection")>-1||L.indexOf("NodeList")>-1,S=!x&&L.indexOf("Element")>-1,B="client",m.container!==window)&&(B="offset",s=l(m.container),A=!0);m.threshold>1&&(m.threshold=1),m.threshold<0&&(m.threshold=0),m.offset>=1&&(m.offset=1),m.offset<0&&(m.offset=0),N=x?g.length:S?1:0},O=function(){var e,t;C=m.container===window?0:p(m.container).top,F=m.container===window?0:p(m.container).left,x&&(h=Array.from(g).map(function(n,o){var i=p(n);return(e=i.bottom-i.top,t=i.right-i.left,y=Math.floor(e*m.offset),{el:n,offset:m.entered?p(n).top:m.offset,index:o,top:i.top-C,bottom:i.bottom-C,height:e,width:t,left:i.left,right:i.right})})),S&&(e=(i=p(g)).bottom-i.top,t=i.right-i.left,y=Math.floor(e*m.offset),h.push({el:g,offset:m.entered?p(g).top:m.offset,index:0,top:i.top-C,bottom:i.bottom-C,height:e,width:t,left:i.left,right:i.right}));var i},T=function(e){for(var t=e.strokeStyle,n=e.fillStyle,o=e.textAlign,a=e.lineWidth,d=m.id?s("[data-scrollama-id='".concat(m.id,"']")):s(b),u=d.length,g=0;g<u;g++){var w=d[g],E=w.nodeName.toLowerCase();if("mark"===E)var S=w.getBoundingClientRect(),A=p(w),D=A.top,k=A.left,q=A.width,_=A.height;else if("p"===E)var L={top:m.offset,bottom:m.offset,height:1};else if("svg"===E){var j=w.querySelector(".scrollama__debug-step--offset-line"),C=w.querySelector(".scrollama__debug-step"),F=w.querySelector(".scrollama__debug-step--above"),H=w.querySelector(".scrollama__debug-step--below"),M=w.querySelector(".scrollama__debug-step--edge"),P=w.querySelectorAll(".scrollama__debug-group-above path"),O=w.querySelectorAll(".scrollama__debug-group-below path"),T=w.querySelector(".scrollama__debug-step--above-text tspan"),R=w.querySelector(".scrollama__debug-step--below-text tspan");if(j){var V,G,J=p(m.step[0]);j.setAttribute("y1",G=m.entered?0:v&&A?(V=p(m.step[0]).top-p(i().querySelector("body")).top+J.height*m.offset,p(w).height/2+J.height-V):Math.floor(J.height*m.offset)),j.setAttribute("y2",G),j.setAttribute("transform","translate(0, ".concat(m.gutter,")")),C&&C.setAttribute("transform","translate(0, ".concat(N!==h.length?m.gutter:0,")")),M&&M.setAttribute("transform","translate(".concat(0,", ").concat(m.entered?window.innerHeight/2:G,")")),T&&(T.textContent=m.entered?"".concat(Math.round(y),"px from viewport ").concat(0<y?"bottom":"top"):Math.round(100*m.offset)+"%"),R&&(R.textContent=m.entered?"".concat(Math.round(y),"px from viewport ").concat(0<y?"bottom":"top"):Math.round(100*m.offset)+"%");for(var W=Math.ceil(J.height*m.threshold),z=0;z<W;z+=1){var $=z/W,Q=10,U=300,K=m.entered?0:Math.floor(J.height*(m.offset-$)),X=m.entered?p(w).height/2+J.height-K:Math.floor(J.height*(m.offset-$)),Y=1-$;P[z]&&P[z].setAttribute("transform","translate(0, ".concat(X-Q,")")),P[z]&&P[z].setAttribute("opacity",Y),O[z]&&O[z].setAttribute("transform","translate(0, ".concat(X+U+Q,")")),O[z]&&O[z].setAttribute("opacity",Y)}F&&F.setAttribute("transform","translate(0, ".concat(X-U,")")),H&&H.setAttribute("transform","translate(0, ".concat(X+U,")"))}}}if("canvas"===E){var Z=w,ee=Z.getContext("2d"),te=Z.width,ne=Z.height,oe=te/2,ie=ne/2,re=5,se=3,ce=20,le=10,pe=v?Math.min(y,f(g[0]).height):"x";ee.clearRect(0,0,te,ne),ee.strokeStyle=t||"black",ee.fillStyle=n||"#f4f4f4",ee.textAlign=o||"center",(d.lineWidth=a||1.5)*=2,ee.beginPath(),ee.moveTo(0,ie),ee.lineTo(te,ie),ee.closePath(),ee.stroke(),ee.beginPath(),ee.moveTo(oe,0),ee.lineTo(oe,ne),ee.closePath(),ee.stroke(),ee.lineWidth=a/2||1.5,e.id&&(ee.fillStyle=r?r:"black",ee.textBaseline="middle",ee.fillText("id = ".concat(e.id),oe,re*ce),le+=re*ce),ee.fillStyle=n||"#f4f4f4",h.forEach(function(e,t){var n=e.top,o=e.bottom,i=e.height,r=m.offset,s=i*r;if(m.entered){var c=n;n=n-c-s,o=o-c-s}var l=(n+o)/2,p=x?ne/N:ne;ee.fillRect(0,0,te,p),ee.fillStyle="black",le+=re*ce,ee.strokeRect(0,0,te,p),ee.fillStyle="black";var f=h.length>1?"[".concat(t,"] "):"";"number"!=typeof pe&&(ee.fillText("".concat(f).concat(Math.round(100*r),"%"),oe,p/2),ee.beginPath(),ee.moveTo(0,s),ee.lineTo(te,s),ee.closePath(),ee.stroke(),ee.fillRect(oe-le/2,s,le,1))})}}},R=function(){var e=document.createElement("div"),n=a("scrollama__debug-step",o()),i=document.createElement("div"),r=a("scrollama__debug-offset");m.id&&e.setAttribute("data-scrollama-id",m.id),m.id&&i.setAttribute("data-scrollama-id",m.id),e.className=n,i.className=r;var s=h.map(function(e){return e.height}).join(" ");x?(e.style.height=s,e.style.top=0,e.style.left=0,e.style.position="absolute",i.style.height="2px",i.style.top=m.entered?"0":y+"px",i.style.left=0,i.style.right=0,i.style.position="fixed",i.style.zIndex=999,i.style.background="red"):(e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.background="black",e.style.height="100%",e.style.width="1px",e.style.zIndex=888,i.style.position="fixed",i.style.zIndex=999,i.style.top=y+"px",i.style.left=0,i.style.width="100%",i.style.height="1px",i.style.background="red"),document.body.appendChild(e),document.body.appendChild(i);var c=window.scrollY,l=window.innerHeight,p=document.querySelector("[data-scrollama-index='0']").getBoundingClientRect(),f=p.top+c,u=f+p.height,g=t(),d=function(){return{top:c,bottom:c+l,height:l}}(),m={id:b,gutter:f,height:g,top:d.top,bottom:d.bottom,topAbove:f-d.top,topBelow:f-d.bottom,bottomAbove:u-d.top,bottomBelow:u-d.bottom,entered:v},w=h.length,x=function(e){return[{cx:e.width,cy:e.height*e.offset,r:10,fill:"grey"},{cx:e.width,cy:e.height*e.offset,r:5,fill:"black"}]},_=function(e){return[{x1:0,x2:e.width,y1:e.height*e.offset,y2:e.height*e.offset}]},L=!1,j=!1,I=document.createElement("svg"),C=I.createElementNS("http://www.w3.org/2000/svg","text"),F=I.createElementNS("http://www.w3.org/2000/svg","text");document.addEventListener("scroll",function(){!L&&f<window.scrollY&&(console.log("enter"),L=!0),L&&f>window.scrollY&&(console.log("exit up"),L=!1),!j&&u<window.scrollY&&(console.log("exit down"),j=!0),j&&u>window.scrollY&&(console.log("re-enter up"),j=!1)});var H=["#9EEDFF","#8FB8DE","#FFB776","#FFCF9E","#E0CAFF","#FFABAB","#BFFFC1"];return{id:b,offsetMargin:y,stepInfo:h,viewportInfo:d,sceneInfo:m}},V=function(){if(v&&m.debug){var o=m.id?document.querySelector("[data-scrollama-id='".concat(m.id,"']")):document.querySelector(".".concat(n())),i=m.id?document.querySelectorAll("[data-scrollama-id='".concat(m.id,"']")):document.querySelectorAll(".".concat(r()));o&&o.parentNode.removeChild(o),Array.from(i).forEach(function(e){return e.parentNode.removeChild(e)})}},G=function(){if(O(),m.debug)if(v&&(V(),0))console.log("scrollama debug activated",h);else if(v){var e=R();console.log("scrollama debug activated",e);var s=document.createElement("div");s.className=a("scrollama__debug-offset","scrollama__debug-offset--"+m.id),s.innerHTML=Math.round(100*y)+"% ("+Math.round(y*t())+"px)",m.id&&s.setAttribute("data-scrollama-id",m.id),s.style.position="fixed",s.style.left="0",s.style.width="100%",s.style.height="0",s.style.borderTop="2px dashed black",s.style.zIndex=9999;var c=S?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0)",l=S?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0)",p=x?h[0].height:S?h[0].height:0,f=x?h.length:1,u=f*p,g=window.innerHeight-u-m.gutter,d=g/2;s.style.top=h[0].top+y*p+"px",document.body.appendChild(s);var b=m.offset,E=800,D=30,N=E/2,k=h.length,q=m.gutter,_=10,L=5*D,j=5*D,B='<svg xmlns="http://www.w3.org/2000/svg" width="'+E+'" height="'+u+'">\n        <defs>\n          <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">\n            <path d="M0,0 L0,6 L9,3 z" fill="#000"></path>\n          </marker>\n        </defs>';u<D*(k+1)&&(D=Math.floor(u/(k+1))),p<2*D&&(D=Math.floor(p/2));for(var M=d+D,I=d+u-D,C=p*b,F=function(e){var t=e*p+C,n=S?"M"+0+","+t+" L"+E+","+t:"",o=x?'<g class="scrollama__debug-step" transform="translate(0,'+(e*p+m.gutter)+')">\n            <rect x="0" width="'+E+'" height="'+p+'" fill="'+c+'"></rect>\n            '+n+"\n          </g>":"";return o},H=function(e){for(var t=Math.ceil(p*m.threshold),n="",o=function(o){var i=o/t,r=10,s=300,c=Math.floor(p*(b-i)),l=1-i;n+='<path transform="translate(0, '+c+")\n              d=\"M"+_+","+r+" L"+_+","+-r+" L"+(N-j)+","+-r+" L"+N+",0 L"+(N-j)+","+r+" L"+_+","+r+" Z\"\n              fill=\"black\" fill-opacity=\""+l+"\"></path>",n+='<path transform="translate(0, '+(c+s+r)+")\n              d=\"M"+_+","+(-1*r)+" L"+_+","+r+" L"+(N-j)+","+r+" L"+N+",0 L"+(N-j)+","+(-1*r)+" L"+_+","+(-1*r)+" Z\"\n              fill=\"black\" fill-opacity=\""+l+"\"></path>"},i=0;i<t;i+=1)o(i);return'<g class="scrollama__debug-group-above">'+n+"</g>"},P=function(){var e=S?50:100,t=p*b;return'<text transform="translate('+N+", "+(-1*L)+')" text-anchor="middle">\n          <tspan x="0" dy="-1em" font-size="'+e+'%" >'+Math.round(100*b)+"%</tspan>\n        </text>"},O=function(){var e=S?50:100,t=p*b;return'<text transform="translate('+N+", "+(p+L)+')" text-anchor="middle">\n          <tspan x="0" dy="-1em" font-size="'+e+'%" >'+Math.round(100*b)+"%</tspan>\n        </text>"},T='<g class="scrollama__debug-step--edge">\n        <circle cx="'+N+'" cy="'+(m.entered?window.innerHeight/2:p*b)+'" r="'+_+'" fill="grey"></circle>\n        <circle cx="'+N+'" cy="'+(m.entered?window.innerHeight/2:p*b)+'" r="'+(_.toFixed(1)/2)+'" fill="black"></circle>\n      </g>',R='<line class="scrollama__debug-step--offset-line" x1="'+0+'" y1="'+(m.entered?window.innerHeight/2:p*b)+'" x2="'+E+'" y2="'+(m.entered?window.innerHeight/2:p*b)+'" stroke-width="2" stroke-dasharray="8 8" stroke="black" transform="translate(0, '+m.gutter+')"></line>',V='<g class="scrollama__debug-step--above" transform="translate(0, '+(p*b-D-q/2)+')">\n        <line x1="'+0+'" y1="'+0+'" x2="'+E+'" y2="'+0+'" stroke-width="2" stroke-dasharray="8 8" stroke="black"></line>\n        <text transform="translate('+N+", "+0+')" text-anchor="middle">\n          <tspan x="0" dy="-1em" font-size="50%" >above</tspan>\n        </text>\n      </g>',G='<g class="scrollama__debug-step--below" transform="translate(0, '+(p*b+D+q/2)+')">\n        <line x1="'+0+'" y1="'+0+'" x2="'+E+'" y2="'+0+'" stroke-width="2" stroke-dasharray="8 8" stroke="black"></line>\n        <text transform="translate('+N+", "+0+')" text-anchor="middle">\n          <tspan x="0" dy="-1em" font-size="50%" >below</tspan>\n        </text>\n      </g>',J="",W=0;W<k;W++){var z=F(W);J+=z}B+=J,B+='<g class="scrollama__debug-step--above-text">'+P()+"</g>",B+='<g class="scrollama__debug-step--below-text">'+O()+"</g>",B+=H(0),B+=T,B+=R,B+=V,B+=G,B+="</svg>";var $=document.createElement("div");$.className=a(r(),i()),$.style.background="rgba(0, 0, 0, 0)",$.style.position="absolute",$.style.top="0",$.style.right="0",$.style.width=E+"px",$.style.height=u+2*m.gutter+"px",$.style.zIndex=9998,$.style.pointerEvents="none",m.id&&$.setAttribute("data-scrollama-id",m.id),$.innerHTML=B,0}},J=function(e,t){var n=document.scrollingElement.scrollTop;if(A){var o=s.scrollTop+s.offsetTop;e.forEach(function(e){e.top=f(e.el,o).top,e.bottom=f(e.el,o).bottom})}e.forEach(function(e){var o=e.el.id?e.el.id:null;void 0!==e.top&&void 0!==e.bottom&&(t?m.offset&&m.offset!==Math.round(m.offset)?0!==Math.round(m.offset)?e.bottom<=m.offset*t&&e.bottom>=(m.offset-m.threshold)*t&&!1===e.state&&(e.state=!0,e.direction="down",e.edge="enter",w=n):e.top<=m.offset*t&&e.top>=(m.offset-m.threshold)*t&&!1===e.state&&(e.state=!0,e.direction="down",e.edge="enter",w=n):e.top<=m.offset*t&&e.top>=(m.offset-m.threshold)*t&&!1===e.state&&(e.state=!0,e.