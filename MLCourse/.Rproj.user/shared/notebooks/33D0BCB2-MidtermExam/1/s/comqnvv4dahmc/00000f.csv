"0","cluster_result2 <- kproto(imputed_bag, k=2)"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","25.09285"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"0","cluster_result3 <- kproto(imputed_bag, k=3)"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","25.09285"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"0","cluster_result4 <- kproto(imputed_bag, k=4)"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","25.09285"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"0","imputed_bag$clus2 <- cluster_result2$cluster"
"0","imputed_bag$clus3 <- cluster_result3$cluster"
"0","imputed_bag$clus4 <- cluster_result4$cluster"
"0",""
"0","# preprocessing"
"0","rec_cluster2 <- recipe(clus2 ~., data=imputed_bag) %>%"
"0","  step_rm(clus3, clus4) %>%"
"0","  step_mutate(clus2 = factor(clus2)) %>%"
"0","  step_normalize(all_numeric_predictors())"
"0",""
"0","rec_cluster3 <- recipe(clus3 ~., data=imputed_bag) %>%"
"0","  step_rm(clus2, clus4) %>%"
"0","  step_mutate(clus3 = factor(clus3)) %>%"
"0","  step_normalize(all_numeric_predictors())"
"0",""
"0","rec_cluster4 <- recipe(clus4 ~., data=imputed_bag) %>%"
"0","  step_rm(clus2, clus3) %>%"
"0","  step_mutate(clus4 = factor(clus4)) %>%"
"0","  step_normalize(all_numeric_predictors())"
"0",""
"0","# defined model"
"0","rf_mod <- rand_forest(mtry=tune(),"
"0","                      trees = 500,"
"0","                      min_n = tune()) %>%"
"0","  set_engine(""ranger"", importance = ""permutation"") %>%"
"0","  set_mode(""classification"")"
"0",""
"0","# defined workflow"
"0","folds<-vfold_cv(data = imputed_bag, v=10)"
"0","library(doMC)"
"0","registerDoMC(cores=15)"
"0","cluster2_result <- workflow() %>%"
"0","  add_recipe(rec_cluster2) %>%"
"0","  add_model(rf_mod) %>%"
"0","  tune_grid(resamples = folds,"
"0","            grid=50)"
"2","[34mi[39m [30mCreating pre-processing data to finalize unknown parameter: mtry[39m
"
"0","cluster3_result <- workflow() %>%"
"0","  add_recipe(rec_cluster3) %>%"
"0","  add_model(rf_mod) %>%"
"0","  tune_grid(resamples = folds,"
"0","            grid=50)"
"2","[34mi[39m [30mCreating pre-processing data to finalize unknown parameter: mtry[39m
"
"0","cluster4_result <- workflow() %>%"
"0","  add_recipe(rec_cluster4) %>%"
"0","  add_model(rf_mod) %>%"
"0","  tune_grid(resamples = folds,"
"0","            grid=50)"
"2","[34mi[39m [30mCreating pre-processing data to finalize unknown parameter: mtry[39m
"
"0","best1<-show_best(cluster2_result, n=1, metric = ""roc_auc"")"
"0","best2<-show_best(cluster3_result , n=1, metric = ""roc_auc"")"
"0","best3<-show_best(cluster4_result , n=1, metric = ""roc_auc"")"
"0",""
"0","best1 %>% bind_rows(best2, best3)"
