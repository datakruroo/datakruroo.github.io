"0","library(FactoMineR)"
"0","library(factoextra)"
"0","library(ggrepel)"
"0","library(cluster)"
"0","#do cluster analysis with mixed variable"
"0","library(clustMixType)"
"0","k_range <- 2:10"
"0","tot_withinSS <- numeric(length(k_range))"
"0","sil_scores <- numeric(length(k_range))"
"0","imputed_bag_scaled<-recipe(Ach~.,data=imputed_bag) %>%"
"0","  step_normalize(all_numeric()) %>%"
"0","  prep(NULL) %>%"
"0","  juice()"
"0",""
"0","gower_dist <- daisy(imputed_bag_scaled, metric = ""gower"")"
"0","for(k in k_range){"
"0","  kproto_res <- kproto(imputed_bag_scaled, k)"
"0","  tot_withinSS[k-1]<-kproto_res$tot.withinss"
"0","  sil_scores[k-1]<-mean(silhouette(kproto_res$cluster,"
"0","                                   gower_dist)[,3])"
"0","}"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","# NAs in variables:
"
"1","      school "
"1","      gender "
"1","         age "
"1","    location "
"1","     famsize "
"1","  ParentStat "
"1","      MomEdu "
"1","      DadEdi "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      MomJob "
"1","      DadJob "
"1","   StuParent "
"1","  traveltime "
"1"," readingtime "
"1","        fail "
"1"," scholarship "
"1","    club_act "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","     nursery "
"1","      higher "
"1","    internet "
"1","      InLove "
"1","fam_relation "
"1","    freetime "
"1","       goout "
"1","   Drink_alc "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","      health "
"1","    absences "
"1","     PreTest "
"1","     subject "
"1","         Ach "
"1","
"
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","           0 "
"1","
"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"1","Estimated lambda:"
"1"," "
"1","1.970169"
"1"," "
"1","

"
"1","0"
"1"," "
"1","observation(s) with NAs.
"
"1","
"
"0","# Plot the total within-cluster sum of squares for each k"
"0","plot(k_range, tot_withinSS, type = ""b"", xlab = ""Number of clusters (k)"", ylab = ""Total within-cluster sum of squares"", main = ""Elbow Method"")"
