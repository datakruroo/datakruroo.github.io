"0","library(tidyr)"
"0","linear.fit <- lm(y~x, data = data)"
"0","poly2.fit <- lm(y~x + I(x^2), data = data)"
"0","poly3.fit <- lm(y~x+I(x^2)+I(x^3), data=data)"
"0","poly4.fit <- lm(y~x+I(x^2)+I(x^3)+I(x^4), data=data)"
"0","summary(poly2.fit)"
"1","
Call:
"
"1",""
"1","lm(formula = y ~ x + I(x^2), data = data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-2.39122 "
"1","-0.44623 "
"1"," 0.00919 "
"1"," 0.48724 "
"1"," 1.99155 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  1.403152"
"1","   0.065188"
"1","   21.52"
"1","   <2e-16"
"1"," ***"
"1","
x          "
"1"," -0.816456"
"1","   0.037673"
"1","  -21.67"
"1","   <2e-16"
"1"," ***"
"1","
I(x^2)     "
"1","  0.094354"
"1","   0.004569"
"1","   20.65"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.6866"
"1"," "
"1","on"
"1"," "
"1","997"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.321"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.3197"
"1"," "
"1","
F-statistic:"
"1"," "
"1","235.7"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","997"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","summary(poly3.fit)"
"1","
Call:
"
"1",""
"1","lm(formula = y ~ x + I(x^2) + I(x^3), data = data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.60503 "
"1","-0.37429 "
"1"," 0.01347 "
"1"," 0.38804 "
"1"," 1.65828 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  0.414729"
"1","   0.072795"
"1","   5.697"
"1","  1.6e-08"
"1"," ***"
"1","
x          "
"1","  0.665338"
"1","   0.078705"
"1","   8.454"
"1","  < 2e-16"
"1"," ***"
"1","
I(x^2)     "
"1"," -0.369551"
"1","   0.022892"
"1"," -16.143"
"1","  < 2e-16"
"1"," ***"
"1","
I(x^3)     "
"1","  0.038733"
"1","   0.001884"
"1","  20.555"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.5757"
"1"," "
"1","on"
"1"," "
"1","996"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.5233"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.5218"
"1"," "
"1","
F-statistic:"
"1"," "
"1","364.4"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","996"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","summary(poly4.fit)"
"1","
Call:
"
"1",""
"1","lm(formula = y ~ x + I(x^2) + I(x^3) + I(x^4), data = data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.58032 "
"1","-0.35378 "
"1"," 0.01344 "
"1"," 0.33812 "
"1"," 1.73464 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.3817872"
"1","  0.0816978"
"1","  -4.673"
"1"," 3.37e-06"
"1"," ***"
"1","
x          "
"1","  2.6435685"
"1","  0.1418019"
"1","  18.643"
"1","  < 2e-16"
"1"," ***"
"1","
I(x^2)     "
"1"," -1.4777624"
"1","  0.0719822"
"1"," -20.530"
"1","  < 2e-16"
"1"," ***"
"1","
I(x^3)     "
"1","  0.2536516"
"1","  0.0134917"
"1","  18.801"
"1","  < 2e-16"
"1"," ***"
"1","
I(x^4)     "
"1"," -0.0134086"
"1","  0.0008352"
"1"," -16.055"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.5133"
"1"," "
"1","on"
"1"," "
"1","995"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.6213"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.6198"
"1"," "
"1","
F-statistic:"
"1"," "
"1","408.2"
"1"," "
"1","on"
"1"," "
"1","4"
"1"," "
"1","and"
"1"," "
"1","995"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","data %>% bind_cols(linear = predict(linear.fit),"
"0","                   quadratic = predict(poly2.fit),"
"0","                   cubic = predict(poly3.fit),"
"0","                   quartic = predict(poly4.fit)) %>%"
"0","  gather(linear:quartic, key = ""model"", value = ""pred"") %>%"
"0","  mutate(model = factor(model, levels=c(""linear"","
"0","                                        ""quadratic"","
"0","                                        ""cubic"","
"0","                                        ""quartic""))) %>%"
"0","  ggplot(aes(x=x, y=y))+"
"0","  geom_point(col = ""steelblue"", alpha=0.7)+"
"0","  geom_line(aes(y=pred))+"
"0","  facet_wrap(vars(model))"
