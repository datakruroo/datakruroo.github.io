"0","# normalized data"
"0","X <- images/255"
"0",""
"0","# create label data (in one hot encoding format)"
"0","y <- data.frame(y = factor(labels)) %>%"
"0","  recipe(y~., data=.) %>%"
"0","  step_dummy(y, one_hot = TRUE) %>%"
"0","  prep(NULL) %>%"
"0","  juice()"
"0","y <- y %>% as.matrix()"
"0","colnames(y)<-as.character(0:9)"
"0","# data splitting"
"0","set.seed(123)"
"0","train_id <- sample(1:dim(X)[1], ceiling(0.8*dim(X)[1]))"
"0","train_x <- X[train_id,,]"
"0","train_y <- y[train_id,]"
"0","test_x <- X[-train_id,,]"
"0","test_y <- y[-train_id,]"
