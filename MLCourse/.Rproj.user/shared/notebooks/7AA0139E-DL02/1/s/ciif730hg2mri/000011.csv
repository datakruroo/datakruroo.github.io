"0","backend <- keras$backend"
"0","## calculate predicted class"
"0","pred_prob <- best_model$predict(test_x)"
"1"," 1/13 [=>............................] - ETA: 0s"
"1","11/13 [========================>.....] - ETA: 0s"
"1","13/13 [==============================] - 0s 5ms/step
"
"0","pred_class <- apply(pred_prob, 1, which.max)-1"
"0","pred_class <- as.matrix(pred_class) # convert R array to matrix"
"0","## frequency distribution of predicted class"
"0","table(pred_class)"
"1","pred_class
"
"1"," 0 "
"1"," 1 "
"1"," 2 "
"1"," 3 "
"1"," 4 "
"1"," 5 "
"1"," 6 "
"1"," 7 "
"1"," 8 "
"1"," 9 "
"1","
"
"1","38 "
"1","46 "
"1","46 "
"1","49 "
"1","25 "
"1","42 "
"1","43 "
"1","47 "
"1","32 "
"1","44 "
"1","
"
"0","# create confusion matrix"
"0","test_y_class <- apply(test_y, 1, which.max)-1"
"0","test_y_class <- as.matrix(test_y_class) # convert R array to matrix"
"0",""
"0","table(pred_class, test_y_class)"
"1","          test_y_class
"
"1","pred_class"
"1","  0"
"1","  1"
"1","  2"
"1","  3"
"1","  4"
"1","  5"
"1","  6"
"1","  7"
"1","  8"
"1","  9"
"1","
         0"
"1"," 32"
"1","  3"
"1","  0"
"1","  0"
"1","  2"
"1","  0"
"1","  1"
"1","  0"
"1","  0"
"1","  0"
"1","
         1"
"1","  2"
"1"," 30"
"1","  5"
"1","  0"
"1","  0"
"1","  1"
"1","  0"
"1","  3"
"1","  4"
"1","  1"
"1","
         2"
"1","  0"
"1","  2"
"1"," 30"
"1","  0"
"1","  1"
"1","  0"
"1","  5"
"1","  6"
"1","  1"
"1","  1"
"1","
         3"
"1","  0"
"1","  1"
"1","  2"
"1"," 38"
"1","  0"
"1","  3"
"1","  2"
"1","  0"
"1","  0"
"1","  3"
"1","
         4"
"1","  0"
"1","  0"
"1","  0"
"1","  0"
"1"," 21"
"1","  1"
"1","  1"
"1","  0"
"1","  1"
"1","  1"
"1","
         5"
"1","  0"
"1","  0"
"1","  0"
"1","  0"
"1","  3"
"1"," 39"
"1","  0"
"1","  0"
"1","  0"
"1","  0"
"1","
         6"
"1","  2"
"1","  0"
"1","  1"
"1","  0"
"1","  7"
"1","  0"
"1"," 31"
"1","  2"
"1","  0"
"1","  0"
"1","
         7"
"1","  1"
"1","  0"
"1","  4"
"1","  1"
"1","  3"
"1","  0"
"1","  2"
"1"," 32"
"1","  3"
"1","  1"
"1","
         8"
"1","  0"
"1","  1"
"1","  1"
"1","  0"
"1","  2"
"1","  0"
"1","  1"
"1","  1"
"1"," 24"
"1","  2"
"1","
         9"
"1","  1"
"1","  0"
"1","  0"
"1","  1"
"1","  2"
"1","  2"
"1","  1"
"1","  0"
"1","  2"
"1"," 35"
"1","
"
"0","true_val <- factor(test_y_class)"
"0","pred_class <- factor(pred_class, levels=0:9)"
"0","eval_dat <- data.frame(true = true_val,"
"0","                       predict = pred_class)"
"0","p1_tune<-eval_dat %>%"
"0","  conf_mat(truth = true,"
"0","           estimate = predict) %>%"
"0","  autoplot()"
"0","p2_tune<-eval_dat %>%"
"0","  conf_mat(truth = true,"
"0","           estimate = predict) %>%"
"0","  autoplot(""heatmap"")"
"0","gridExtra::grid.arrange(p1_notune, p2_notune,p1_tune,p2_tune,ncol=2)"
