labels=c("none","primary","highsch1","highsch2","grad"),
DadEdi = factor(DadEdi), levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad"),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
dat_na <- dat_preproc%>%bind_shadow() %>%
select(school:subject,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu), levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad"))
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:subject,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu), levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad"),
DadEdi = factor(DadEdi), levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad"),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:subject,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:subject,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
glimpse(dat_na)
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:subject,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_normalize(all_numeric_predictors()) %>%
step_select(-contains("NA")) %>%
prep(NULL) %>%
juice()
glimpse(rec1, width=50)
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_normalize(all_numeric_predictors()) %>%
#step_select(-contains("NA")) %>%
prep(NULL) %>%
juice()
glimpse(rec1, width=50)
glimpse(dat_preproc)
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:ACH,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
dat_na <- dat_preproc%>%bind_shadow() %>%
dplyr::select(school:Ach,
PreTest_NA, traveltime_NA, fam_relation_NA) %>%
mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),
labels=c("none","primary","highsch1","highsch2","grad")),
traveltime = factor(traveltime, levels=c(1,2,3,4),
labels=c("<15mins",
"15-30mins",
"30-60mins",
">60mins")),
readingtime = factor(readingtime, levels=c(1,2,3,4),
labels=c("<2hours",
"2-5hours",
"5-10hours",
">10hours")),
fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good")),
freetime = factor(freetime, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
goout = factor(goout, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),
labels=c("very little",
"litter",
"moderate",
"high",
"highest")),
health = factor(health, levels=c(1,2,3,4,5),
labels=c("worst",
"bad",
"fair",
"good",
"very good"))
)
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_normalize(all_numeric_predictors()) %>%
step_select(-contains("NA")) %>%
prep(NULL) %>%
juice()
glimpse(rec1, width=50)
rec1 <- recipe(PreTest_NA ~.-traveltime_NA - fam_relation_NA, data=dat_na) %>%
step_normalize(all_numeric_predictors())
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA) %>%
step_normalize(all_numeric_predictors())
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA) %>%
step_normalize(all_numeric_predictors())
rec1
library(doMC)
# defined preprocess
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA) %>%
step_normalize(all_numeric_predictors())
# defined model
logistic_mod <- logistic_reg(penalty = tune(),
mixture = tune()) %>%
set_engine("glmnet") %>%
set_mode("classification")
# defined workflowset
na_workflowset <- workflow_set(
preproc = list(pretest = rec1,
travel = rec2,
family = rec3),
models = list(logistic = logistic_mod),
cross = TRUE
)
folds<-vfold_cv(data = dat_na, v=10)
library(doMC)
registerDoMC(cores=15)
result_na <- na_workflowset %>%
workflow_map(resample = folds,
grid=50)
# defined preprocess
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA) %>%
step_normalize(all_numeric_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA) %>%
step_normalize(all_numeric_predictors())
# defined model
logistic_mod <- logistic_reg(penalty = tune(),
mixture = tune()) %>%
set_engine("glmnet") %>%
set_mode("classification")
# defined workflowset
na_workflowset <- workflow_set(
preproc = list(pretest = rec1,
travel = rec2,
family = rec3),
models = list(logistic = logistic_mod),
cross = TRUE
)
folds<-vfold_cv(data = dat_na, v=10)
library(doMC)
registerDoMC(cores=15)
result_na <- na_workflowset %>%
workflow_map(resamples = folds,
grid=50)
show_notes(.Last.tune.result)
# defined preprocess
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors()) %>%
step_dummy(all_nominal_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA) %>%
step_normalize(all_numeric_predictors())%>%
step_dummy(all_nominal_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA) %>%
step_normalize(all_numeric_predictors())%>%
step_dummy(all_nominal_predictors())
# defined model
logistic_mod <- logistic_reg(penalty = tune(),
mixture = tune()) %>%
set_engine("glmnet") %>%
set_mode("classification")
# defined workflowset
na_workflowset <- workflow_set(
preproc = list(pretest = rec1,
travel = rec2,
family = rec3),
models = list(logistic = logistic_mod),
cross = TRUE
)
folds<-vfold_cv(data = dat_na, v=10)
library(doMC)
registerDoMC(cores=15)
result_na <- na_workflowset %>%
workflow_map(resamples = folds,
grid=50)
show_notes(.Last.tune.result)
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA) %>%
step_normalize(all_numeric_predictors()) %>%
step_dummy(all_nominal_predictors()) %>% prep(NULL) %>% juice()
rec1
glimpse(rec1)
# defined preprocess
rec1 <- recipe(PreTest_NA ~., data=dat_na) %>%
step_rm(traveltime_NA,fam_relation_NA, PreTest) %>%
step_normalize(all_numeric_predictors()) %>%
step_dummy(all_nominal_predictors())
rec2 <- recipe(traveltime_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, fam_relation_NA, traveltime) %>%
step_normalize(all_numeric_predictors())%>%
step_dummy(all_nominal_predictors())
rec3<- recipe(fam_relation_NA ~., data=dat_na) %>%
step_rm(PreTest_NA, traveltime_NA, fam_relation) %>%
step_normalize(all_numeric_predictors())%>%
step_dummy(all_nominal_predictors())
# defined model
logistic_mod <- logistic_reg(penalty = tune(),
mixture = tune()) %>%
set_engine("glmnet") %>%
set_mode("classification")
# defined workflowset
na_workflowset <- workflow_set(
preproc = list(pretest = rec1,
travel = rec2,
family = rec3),
models = list(logistic = logistic_mod),
cross = TRUE
)
folds<-vfold_cv(data = dat_na, v=10)
library(doMC)
registerDoMC(cores=15)
result_na <- na_workflowset %>%
workflow_map(resamples = folds,
grid=50)
show_notes(.Last.tune.result)
result_na
result_na %>% autoplot()
