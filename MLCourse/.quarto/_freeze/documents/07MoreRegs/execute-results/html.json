{
  "hash": "c7351bd0bff5e8fca769417d799b1382",
  "result": {
    "markdown": "---\ntitle: \"More about Regression\"\nauthor: \"ผศ.ดร.สิวะโชติ ศรีสุทธิยากร\"\ntoc: true\ntoc-depth: 3\ntoc-title: สารบัญ\ntheme: default\n---\n\n\nบทเรียนนี้จะกล่าวถึง regression models ที่เป็นตัวขยายจาก linear regression\n\n# Principal Component Analysis (PCA)\n\nทดลองวิเคราะห์ PCA เพื่อหาจำนวนองค์ประกอบที่เหมาะสมก่อน\n\nPCA เป็นเทคนิคที่ใช้สำหรับลดจำนวนมิติหรือตัวแปรในชุดข้อมูล หลักการคร่าว ๆ คือ PCA จะสร้างตัวแปรใหม่ที่อยู่ในรูปผลรวมเชิงเส้นของตัวแปรเดิม ทั้งนี้น้ำหนักในการรวมผลรวมเชิงเส้นดังกล่าวจะพิจารณาจากความสัมพันธ์เชิงเส้นระหว่างตัวแปรเดิม PCA จะสร้างตัวแปรใหม่ที่มีจำนวนเท่ากับตัวแปรเดิม อย่างไรก็ตามตัวแปรใหม่ที่สร้างขึ้นจะมีความแปรปรวนของตัวแปรเดิมที่ลดหล่นกันลงไป การนำตัวแปรใหม่มาใช้จึงไม่จำเป็นต้องนำมาหลายตัว นำมาเฉพาะตัวแปร ๆ ที่มีความแปรปรวนรวมกันคิดเป็นร้อยละส่วนใหญ่ของตัวแปรเดิมก็เพียงพอจะนำไปใช้เป็นตัวแปรของตัวแปรเดิมได้แล้ว\n\nรูปด้านล่างแสดงตัวอย่างให้เห็นว่าจากเดิมที่มีตัวแปร 2 ตัวได้แก่ x กับ y เนื่องจากตัวแปรทั้งสองมีความสัมพันธ์เชิงเส้นกันค่อยข้างสูง เมื่อนำมาสร้างตัวแปรใหม่ (ที่เรียกว่า องค์ประกอบหลัก) จะได้องค์ประกอบหลักสองตัว โดยที่องค์ประกอบแรกสกัดความแปรปรวนของตัวแปรเดิม x, y ออกมาได้เกือบทั้งหมด ทำให้องค์ประกอบที่สองเหลือความแปรปรวนเพียงนิดเดียว และไม่จำเป็นต้องนำไปใช้ต่อ\n\n![](images/image-452062936.png){width=\"460\"}\n\nในเชิงเทคนิคเราเรียกความแปรปรวนที่องค์ประกอบสกัดได้จากตัวแปรเดิมนี้ว่า eigenvalue\n\nประโยชน์ของ PCA สามารถนำไปประยุกต์ใช้ได้หลากหลาย\n\n1.  Descriptive Technique\n2.  Dimensionality reduction\n3.  Anomaly detection\n4.  Noise reduction\n5.  Decorrelation\n\nPCA สามารถใช้ได้กับข้อมูลเชิงปริมาณเท่านั้น นอกจากนี้ PCA ยังมีความไวต่อหน่วยข้อมูล กล่าวคือข้อมูลที่มีหน่วยแตกต่างกันมีความเป็นไปได้ที่จะทำให้ผลการสกัดองค์ประกอบมีความคลาดเคลื่อน ก่อนการวิเคราะห์จึงควร standardized ข้อมูลเสมอ\n\nเอกสารประกอบเรื่อง PCA [กดเลย](slides/PCA.pdf)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n:::\n:::\n\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\ndat <- read.csv(\"basket.csv\")\nhead(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  X X7up lasagna pepsi yop red.wine cheese bbq bulmers mayonnaise horlics\n1 1    0       0     0   0        0      0   0       0          0       0\n2 2    0       0     0   0        0      0   0       0          0       0\n3 3    0       0     0   0        0      0   0       0          0       0\n4 4    0       0     0   2        1      0   0       0          0       0\n5 5    0       0     0   0        0      0   0       2          0       0\n6 6    0       0     0   0        0      0   0       0          0       0\n  chicken.tikka milk mars coke lottery bread pizza sunny.delight ham lettuce\n1             0    0    2    0       0     1     0             0   1       0\n2             0    1    0    0       0     0     0             0   0       0\n3             0    3    0    0       0     0     0             0   0       0\n4             0    0    1    0       0     0     0             0   0       0\n5             0    0    0    0       0     0     0             0   0       0\n6             0    0    0    1       0     0     0             0   0       0\n  kronenbourg leeks fanta tea whiskey peas newspaper muesli white.wine carrots\n1           0     0     0   0       0    0         2      0          0       0\n2           0     1     0   2       0    0         0      0          0       0\n3           0     0     0   0       0    0         0      0          0       0\n4           0     0     0   0       0    0         0      0          0       0\n5           1     0     0   0       0    0         0      0          0       0\n6           0     0     2   0       0    0         0      0          0       0\n  spinach pate instant.coffee twix potatoes fosters soup toad.in.hole coco.pops\n1       0    0              0    0        0       0    0            0         0\n2       0    0              0    0        0       0    0            0         0\n3       0    0              1    0        0       0    0            0         1\n4       0    0              0    2        0       1    0            0         0\n5       0    0              0    0        0       0    0            0         0\n6       0    0              0    0        0       0    0            0         0\n  kitkat broccoli cigarettes\n1      1        0          0\n2      0        2          0\n3      0        0          0\n4      1        0          1\n5      0        0          0\n6      0        0          0\n```\n:::\n\n```{.r .cell-code}\ndat<-dat[,-c(1,2)]\nhead(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  lasagna pepsi yop red.wine cheese bbq bulmers mayonnaise horlics\n1       0     0   0        0      0   0       0          0       0\n2       0     0   0        0      0   0       0          0       0\n3       0     0   0        0      0   0       0          0       0\n4       0     0   2        1      0   0       0          0       0\n5       0     0   0        0      0   0       2          0       0\n6       0     0   0        0      0   0       0          0       0\n  chicken.tikka milk mars coke lottery bread pizza sunny.delight ham lettuce\n1             0    0    2    0       0     1     0             0   1       0\n2             0    1    0    0       0     0     0             0   0       0\n3             0    3    0    0       0     0     0             0   0       0\n4             0    0    1    0       0     0     0             0   0       0\n5             0    0    0    0       0     0     0             0   0       0\n6             0    0    0    1       0     0     0             0   0       0\n  kronenbourg leeks fanta tea whiskey peas newspaper muesli white.wine carrots\n1           0     0     0   0       0    0         2      0          0       0\n2           0     1     0   2       0    0         0      0          0       0\n3           0     0     0   0       0    0         0      0          0       0\n4           0     0     0   0       0    0         0      0          0       0\n5           1     0     0   0       0    0         0      0          0       0\n6           0     0     2   0       0    0         0      0          0       0\n  spinach pate instant.coffee twix potatoes fosters soup toad.in.hole coco.pops\n1       0    0              0    0        0       0    0            0         0\n2       0    0              0    0        0       0    0            0         0\n3       0    0              1    0        0       0    0            0         1\n4       0    0              0    2        0       1    0            0         0\n5       0    0              0    0        0       0    0            0         0\n6       0    0              0    0        0       0    0            0         0\n  kitkat broccoli cigarettes\n1      1        0          0\n2      0        2          0\n3      0        0          0\n4      1        0          1\n5      0        0          0\n6      0        0          0\n```\n:::\n\n```{.r .cell-code}\nglimpse(dat, width=60)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,000\nColumns: 41\n$ lasagna        <int> 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 2, 0,…\n$ pepsi          <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ yop            <int> 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ red.wine       <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,…\n$ cheese         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ bbq            <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…\n$ bulmers        <int> 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1, 1,…\n$ mayonnaise     <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ horlics        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1,…\n$ chicken.tikka  <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,…\n$ milk           <int> 0, 1, 3, 0, 0, 0, 0, 1, 0, 2, 0, 0,…\n$ mars           <int> 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ coke           <int> 0, 0, 0, 0, 0, 1, 3, 0, 0, 0, 1, 0,…\n$ lottery        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…\n$ bread          <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…\n$ pizza          <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…\n$ sunny.delight  <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ ham            <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ lettuce        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…\n$ kronenbourg    <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…\n$ leeks          <int> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ fanta          <int> 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0,…\n$ tea            <int> 0, 2, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0,…\n$ whiskey        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…\n$ peas           <int> 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0,…\n$ newspaper      <int> 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0,…\n$ muesli         <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0,…\n$ white.wine     <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,…\n$ carrots        <int> 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0,…\n$ spinach        <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…\n$ pate           <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…\n$ instant.coffee <int> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ twix           <int> 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ potatoes       <int> 0, 0, 0, 0, 0, 0, 2, 1, 1, 0, 1, 1,…\n$ fosters        <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ soup           <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…\n$ toad.in.hole   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ coco.pops      <int> 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…\n$ kitkat         <int> 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ broccoli       <int> 0, 2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1,…\n$ cigarettes     <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…\n```\n:::\n:::\n\n\n## Standardization\n\nข้อตกลงเบื้องต้นของ PCA คือข้อมูลที่จะนำมาสกัดองค์ประกอบควรจะต้องเป็นข้อมูลที่อยู่ในหน่วยเดียวกัน\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca_dat <- scale(dat, center =T, scale =T)\nsummary(pca_dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    lasagna            pepsi              yop             red.wine      \n Min.   :-0.4667   Min.   :-0.4155   Min.   :-0.2424   Min.   :-0.3439  \n 1st Qu.:-0.4667   1st Qu.:-0.4155   1st Qu.:-0.2424   1st Qu.:-0.3439  \n Median :-0.4667   Median :-0.4155   Median :-0.2424   Median :-0.3439  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.4667   3rd Qu.:-0.4155   3rd Qu.:-0.2424   3rd Qu.:-0.3439  \n Max.   : 5.8187   Max.   : 6.8580   Max.   :10.3743   Max.   : 8.2794  \n     cheese             bbq             bulmers         mayonnaise     \n Min.   :-0.3911   Min.   :-0.2618   Min.   :-0.362   Min.   :-0.3407  \n 1st Qu.:-0.3911   1st Qu.:-0.2618   1st Qu.:-0.362   1st Qu.:-0.3407  \n Median :-0.3911   Median :-0.2618   Median :-0.362   Median :-0.3407  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.000   Mean   : 0.0000  \n 3rd Qu.:-0.3911   3rd Qu.:-0.2618   3rd Qu.:-0.362   3rd Qu.:-0.3407  \n Max.   : 6.2230   Max.   :10.0728   Max.   :10.827   Max.   : 8.5959  \n    horlics        chicken.tikka         milk              mars        \n Min.   :-0.2182   Min.   :-0.396   Min.   :-0.4217   Min.   :-0.5052  \n 1st Qu.:-0.2182   1st Qu.:-0.396   1st Qu.:-0.4217   1st Qu.:-0.5052  \n Median :-0.2182   Median :-0.396   Median :-0.4217   Median :-0.5052  \n Mean   : 0.0000   Mean   : 0.000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.2182   3rd Qu.:-0.396   3rd Qu.:-0.4217   3rd Qu.:-0.5052  \n Max.   : 7.5729   Max.   : 7.238   Max.   : 6.3115   Max.   : 7.3030  \n      coke            lottery            bread             pizza        \n Min.   :-0.4916   Min.   :-0.2459   Min.   :-0.3819   Min.   :-0.4958  \n 1st Qu.:-0.4916   1st Qu.:-0.2459   1st Qu.:-0.3819   1st Qu.:-0.4958  \n Median :-0.4916   Median :-0.2459   Median :-0.3819   Median :-0.4958  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.4916   3rd Qu.:-0.2459   3rd Qu.:-0.3819   3rd Qu.:-0.4958  \n Max.   : 8.5043   Max.   : 7.1506   Max.   : 8.3974   Max.   : 9.2119  \n sunny.delight          ham             lettuce         kronenbourg     \n Min.   :-0.2516   Min.   :-0.2499   Min.   :-0.2515   Min.   :-0.2988  \n 1st Qu.:-0.2516   1st Qu.:-0.2499   1st Qu.:-0.2515   1st Qu.:-0.2988  \n Median :-0.2516   Median :-0.2499   Median :-0.2515   Median :-0.2988  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.2516   3rd Qu.:-0.2499   3rd Qu.:-0.2515   3rd Qu.:-0.2988  \n Max.   : 7.2030   Max.   :10.3853   Max.   : 6.8837   Max.   : 7.7040  \n     leeks             fanta              tea             whiskey       \n Min.   :-0.2357   Min.   :-0.3486   Min.   :-0.3848   Min.   :-0.2206  \n 1st Qu.:-0.2357   1st Qu.:-0.3486   1st Qu.:-0.3848   1st Qu.:-0.2206  \n Median :-0.2357   Median :-0.3486   Median :-0.3848   Median :-0.2206  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.2357   3rd Qu.:-0.3486   3rd Qu.:-0.3848   3rd Qu.:-0.2206  \n Max.   : 7.5568   Max.   : 6.8629   Max.   : 8.7343   Max.   :10.9945  \n      peas           newspaper           muesli          white.wine     \n Min.   :-0.3216   Min.   :-0.4026   Min.   :-0.3591   Min.   :-0.2157  \n 1st Qu.:-0.3216   1st Qu.:-0.4026   1st Qu.:-0.3591   1st Qu.:-0.2157  \n Median :-0.3216   Median :-0.4026   Median :-0.3591   Median :-0.2157  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.3216   3rd Qu.:-0.4026   3rd Qu.:-0.3591   3rd Qu.:-0.2157  \n Max.   : 8.2532   Max.   : 7.3592   Max.   : 6.5460   Max.   :11.5506  \n    carrots           spinach             pate         instant.coffee   \n Min.   :-0.2918   Min.   :-0.2387   Min.   :-0.1836   Min.   :-0.3455  \n 1st Qu.:-0.2918   1st Qu.:-0.2387   1st Qu.:-0.1836   1st Qu.:-0.3455  \n Median :-0.2918   Median :-0.2387   Median :-0.1836   Median :-0.3455  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.2918   3rd Qu.:-0.2387   3rd Qu.:-0.1836   3rd Qu.:-0.3455  \n Max.   : 7.5934   Max.   :10.3690   Max.   :10.4572   Max.   : 8.4011  \n      twix            potatoes          fosters             soup        \n Min.   :-0.4693   Min.   :-0.3971   Min.   :-0.2916   Min.   :-0.2623  \n 1st Qu.:-0.4693   1st Qu.:-0.3971   1st Qu.:-0.2916   1st Qu.:-0.2623  \n Median :-0.4693   Median :-0.3971   Median :-0.2916   Median :-0.2623  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.4693   3rd Qu.:-0.3971   3rd Qu.:-0.2916   3rd Qu.:-0.2623  \n Max.   : 6.2833   Max.   : 7.1087   Max.   : 7.8849   Max.   : 6.8281  \n  toad.in.hole       coco.pops           kitkat           broccoli      \n Min.   :-0.2449   Min.   :-0.2828   Min.   :-0.4571   Min.   :-0.3015  \n 1st Qu.:-0.2449   1st Qu.:-0.2828   1st Qu.:-0.4571   1st Qu.:-0.3015  \n Median :-0.2449   Median :-0.2828   Median :-0.4571   Median :-0.3015  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.:-0.2449   3rd Qu.:-0.2828   3rd Qu.:-0.4571   3rd Qu.:-0.3015  \n Max.   :10.6386   Max.   : 8.4635   Max.   : 6.0261   Max.   : 8.2723  \n   cigarettes     \n Min.   :-0.3475  \n 1st Qu.:-0.3475  \n Median :-0.3475  \n Mean   : 0.0000  \n 3rd Qu.:-0.3475  \n Max.   : 6.8431  \n```\n:::\n:::\n\n\n## สำรวจข้อมูล\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrr)\nlibrary(ggcorrplot)\ncorr_matrix <- cor(pca_dat)\nggcorrplot(corr_matrix)+\n  theme(text=element_text(family=\"ChulaCharasNew\", size=6))\n```\n\n::: {.cell-output-display}\n![](07MoreRegs_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nการวิเคราะห์ PCA ใน R สามารถทำได้หลายวิธีมาก ๆ ในบทเรียนนี้จะใช้ฟังก์ชัน `PCA()` จาก package FactoMineR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\nlibrary(factoextra)\noutput.pca <- princomp(pca_dat)\nsummary(output.pca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                           Comp.1     Comp.2     Comp.3    Comp.4     Comp.5\nStandard deviation     1.51352719 1.47307891 1.44866234 1.4366279 1.41492940\nProportion of Variance 0.05590026 0.05295237 0.05121152 0.0503642 0.04885431\nCumulative Proportion  0.05590026 0.10885262 0.16006414 0.2104283 0.25928265\n                          Comp.6     Comp.7     Comp.8     Comp.9    Comp.10\nStandard deviation     1.3879457 1.23860337 1.02589516 1.00707860 1.00419196\nProportion of Variance 0.0470087 0.03743673 0.02568262 0.02474914 0.02460746\nCumulative Proportion  0.3062914 0.34372808 0.36941070 0.39415984 0.41876730\n                          Comp.11    Comp.12    Comp.13    Comp.14   Comp.15\nStandard deviation     0.98805228 0.98026081 0.96916859 0.96283571 0.9506317\nProportion of Variance 0.02382282 0.02344858 0.02292092 0.02262235 0.0220525\nCumulative Proportion  0.44259012 0.46603871 0.48895963 0.51158198 0.5336345\n                          Comp.16    Comp.17    Comp.18    Comp.19    Comp.20\nStandard deviation     0.94760311 0.94454521 0.93173452 0.92962096 0.92390356\nProportion of Variance 0.02191222 0.02177102 0.02118448 0.02108847 0.02082987\nCumulative Proportion  0.55554670 0.57731772 0.59850220 0.61959067 0.64042054\n                          Comp.21    Comp.22    Comp.23    Comp.24    Comp.25\nStandard deviation     0.91300571 0.90403128 0.89967854 0.89505220 0.88245506\nProportion of Variance 0.02034138 0.01994345 0.01975186 0.01954925 0.01900284\nCumulative Proportion  0.66076192 0.68070537 0.70045723 0.72000648 0.73900932\n                          Comp.26    Comp.27    Comp.28    Comp.29    Comp.30\nStandard deviation     0.87594831 0.86655338 0.85902095 0.84904551 0.84360299\nProportion of Variance 0.01872364 0.01832416 0.01800698 0.01759119 0.01736639\nCumulative Proportion  0.75773296 0.77605712 0.79406410 0.81165529 0.82902168\n                          Comp.31   Comp.32    Comp.33    Comp.34    Comp.35\nStandard deviation     0.83860274 0.8262257 0.81977073 0.81591969 0.80542322\nProportion of Variance 0.01716113 0.0166583 0.01639903 0.01624532 0.01583003\nCumulative Proportion  0.84618281 0.8628411 0.87924015 0.89548546 0.91131549\n                          Comp.36   Comp.37    Comp.38    Comp.39    Comp.40\nStandard deviation     0.79751364 0.7946118 0.78125588 0.77883263 0.76542093\nProportion of Variance 0.01552064 0.0154079 0.01489429 0.01480204 0.01429664\nCumulative Proportion  0.92683613 0.9422440 0.95713832 0.97194036 0.98623700\n                         Comp.41\nStandard deviation     0.7509999\nProportion of Variance 0.0137630\nCumulative Proportion  1.0000000\n```\n:::\n\n```{.r .cell-code}\noutput.pca %>%objects()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"call\"     \"center\"   \"loadings\" \"n.obs\"    \"scale\"    \"scores\"   \"sdev\"    \n```\n:::\n\n```{.r .cell-code}\noutput.pca$loadings  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nLoadings:\n               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9\nlasagna         0.116  0.267                       0.291  0.213              \npepsi                                      -0.143 -0.363  0.283  0.104       \nyop                                               -0.228  0.256  0.379  0.415\nred.wine       -0.272  0.123 -0.142 -0.302                                   \ncheese                 0.157 -0.407  0.163                                   \nbbq                    0.189                       0.178  0.179 -0.284  0.389\nbulmers        -0.274  0.121        -0.345                                   \nmayonnaise             0.111 -0.372  0.154                                   \nhorlics               -0.145               -0.177         0.103 -0.108       \nchicken.tikka          0.262                       0.228  0.219 -0.237  0.211\nmilk            0.136 -0.260        -0.110 -0.291  0.172                     \nmars           -0.211 -0.250                0.262         0.163              \ncoke                                              -0.382  0.329              \nlottery        -0.152 -0.120                0.112         0.249        -0.304\nbread                  0.117 -0.427  0.132                       0.108       \npizza           0.132  0.251                       0.290  0.243              \nsunny.delight                                     -0.232  0.205 -0.178 -0.122\nham                          -0.326  0.117                                   \nlettuce                0.106 -0.311  0.132                      -0.325 -0.117\nkronenbourg    -0.229  0.130 -0.139 -0.261                      -0.108  0.172\nleeks           0.210        -0.106 -0.176  0.218                            \nfanta                                             -0.288  0.338 -0.244 -0.261\ntea             0.121 -0.245               -0.279  0.149         0.174       \nwhiskey        -0.191        -0.108 -0.238                             -0.196\npeas            0.250        -0.108 -0.217  0.181                            \nnewspaper      -0.159 -0.189 -0.120         0.174         0.178         0.124\nmuesli                -0.215               -0.295  0.178                     \nwhite.wine     -0.128  0.152        -0.247                             -0.261\ncarrots         0.268        -0.103 -0.232  0.195               -0.127       \nspinach         0.229               -0.226  0.179                            \npate                         -0.265                              0.409       \ninstant.coffee  0.105 -0.236               -0.276  0.166  0.112              \ntwix           -0.196 -0.244                0.248         0.228              \npotatoes        0.255               -0.257  0.208                            \nfosters        -0.261        -0.123 -0.309                      -0.117       \nsoup                   0.160                       0.203  0.277  0.198 -0.263\ntoad.in.hole           0.150                       0.189  0.130  0.362 -0.319\ncoco.pops             -0.161               -0.232  0.117  0.103         0.158\nkitkat         -0.182 -0.204                0.228         0.187 -0.113       \nbroccoli        0.227               -0.254  0.247                            \ncigarettes     -0.147 -0.186                0.148  0.112  0.174  0.174  0.133\n               Comp.10 Comp.11 Comp.12 Comp.13 Comp.14 Comp.15 Comp.16 Comp.17\nlasagna         0.164           0.124                                         \npepsi                          -0.156                          -0.151         \nyop            -0.164           0.230  -0.215  -0.124                         \nred.wine                0.103   0.108           0.139                         \ncheese                                          0.126  -0.152                 \nbbq            -0.102          -0.337                  -0.223          -0.266 \nbulmers                                                                       \nmayonnaise                                      0.162  -0.322           0.132 \nhorlics                 0.374          -0.612  -0.216   0.110           0.367 \nchicken.tikka                  -0.108  -0.135  -0.115                         \nmilk                                                                          \nmars           -0.141                                   0.101                 \ncoke                                    0.137                                 \nlottery                        -0.419  -0.136   0.161          -0.164         \nbread                                                   0.149                 \npizza                                   0.181           0.110           0.271 \nsunny.delight   0.378   0.262           0.155   0.347  -0.118   0.314   0.285 \nham             0.148  -0.205   0.175          -0.276          -0.135         \nlettuce        -0.226           0.185   0.116           0.195   0.123         \nkronenbourg     0.224                                   0.267                 \nleeks           0.150           0.128           0.296  -0.163  -0.465         \nfanta                          -0.172                                  -0.154 \ntea                            -0.119           0.136          -0.238         \nwhiskey         0.284  -0.189   0.132          -0.311  -0.409          -0.114 \npeas                   -0.176          -0.308           0.124   0.209  -0.324 \nnewspaper       0.107   0.277   0.143   0.331  -0.192          -0.234         \nmuesli                                  0.124          -0.153   0.213         \nwhite.wine     -0.323          -0.172                  -0.201  -0.257         \ncarrots                                         0.132                  -0.183 \nspinach        -0.148          -0.201   0.280  -0.355           0.109   0.304 \npate            0.341          -0.445                   0.255   0.233  -0.141 \ninstant.coffee  0.221                   0.166           0.148                 \ntwix                                           -0.157  -0.159                 \npotatoes                                        0.130                         \nfosters        -0.120   0.127                           0.115   0.110         \nsoup                   -0.149   0.236  -0.139           0.297  -0.226         \ntoad.in.hole   -0.154   0.362                          -0.199   0.257  -0.312 \ncoco.pops      -0.394           0.117   0.172   0.208           0.161         \nkitkat                  0.287                           0.130          -0.187 \nbroccoli                0.116           0.115  -0.282                   0.244 \ncigarettes             -0.456  -0.128           0.212  -0.178   0.251   0.231 \n               Comp.18 Comp.19 Comp.20 Comp.21 Comp.22 Comp.23 Comp.24 Comp.25\nlasagna         0.107   0.136                   0.181   0.103   0.159   0.167 \npepsi                                   0.270           0.366   0.105         \nyop                    -0.159          -0.305   0.193  -0.162           0.120 \nred.wine                                0.102                                 \ncheese         -0.136                   0.137  -0.150  -0.196                 \nbbq                             0.100  -0.229           0.216  -0.351         \nbulmers         0.125                                   0.125   0.212   0.128 \nmayonnaise     -0.285   0.212   0.207          -0.235                         \nhorlics                 0.149           0.169           0.110  -0.195         \nchicken.tikka          -0.135           0.127          -0.338   0.317  -0.164 \nmilk                                   -0.125                   0.166  -0.225 \nmars                            0.206                           0.131         \ncoke                    0.114                  -0.150   0.160                 \nlottery        -0.324  -0.355  -0.215  -0.194   0.126   0.103   0.147   0.286 \nbread                  -0.109                   0.168                  -0.216 \npizza                   0.135                                   0.180         \nsunny.delight   0.110  -0.173          -0.302          -0.154  -0.142         \nham             0.355  -0.152  -0.270  -0.115  -0.309           0.136   0.258 \nlettuce         0.236  -0.155                   0.350   0.233  -0.115         \nkronenbourg                     0.187   0.112                  -0.121   0.249 \nleeks           0.203  -0.123           0.170   0.246   0.176          -0.179 \nfanta                                   0.232   0.198  -0.249          -0.198 \ntea             0.147  -0.320   0.129          -0.168  -0.184                 \nwhiskey        -0.235  -0.102  -0.142           0.153          -0.242         \npeas           -0.193           0.191  -0.137                   0.168   0.169 \nnewspaper      -0.278   0.158                   0.252                         \nmuesli         -0.111   0.195          -0.206           0.326   0.184         \nwhite.wine      0.319   0.380          -0.294   0.186  -0.295                 \ncarrots                 0.191  -0.164          -0.141          -0.119   0.384 \nspinach                         0.115   0.163  -0.175  -0.101  -0.251         \npate                    0.141  -0.252                                  -0.146 \ninstant.coffee                  0.389                  -0.160           0.158 \ntwix            0.163                   0.136  -0.110                         \npotatoes       -0.154   0.102  -0.112                           0.108  -0.304 \nfosters                -0.172          -0.115  -0.179   0.118          -0.282 \nsoup           -0.134                  -0.175  -0.243          -0.394  -0.185 \ntoad.in.hole    0.142  -0.240   0.142   0.295                           0.151 \ncoco.pops                      -0.522   0.266          -0.154  -0.158   0.122 \nkitkat          0.136   0.113          -0.103  -0.293          -0.141  -0.147 \nbroccoli               -0.229                           0.125   0.155         \ncigarettes      0.213   0.157   0.166                   0.135  -0.133         \n               Comp.26 Comp.27 Comp.28 Comp.29 Comp.30 Comp.31 Comp.32 Comp.33\nlasagna         0.210           0.175   0.304   0.117   0.136   0.240   0.111 \npepsi                                   0.158   0.106   0.110  -0.160  -0.349 \nyop                     0.148                                   0.195         \nred.wine                0.260                  -0.417   0.143  -0.118         \ncheese          0.121                   0.123                  -0.243         \nbbq            -0.175  -0.101           0.230          -0.115                 \nbulmers                -0.177   0.119           0.334           0.103         \nmayonnaise                                              0.144   0.303   0.150 \nhorlics        -0.125                                  -0.138                 \nchicken.tikka   0.133                  -0.338           0.132  -0.322  -0.214 \nmilk                           -0.343  -0.207                           0.451 \nmars                   -0.152           0.351           0.402  -0.181         \ncoke                    0.106   0.247  -0.244   0.153                   0.286 \nlottery                 0.185          -0.112                                 \nbread                                           0.121  -0.202   0.139  -0.370 \npizza          -0.144   0.173  -0.133                  -0.165   0.170         \nsunny.delight          -0.163                                  -0.108         \nham            -0.155                   0.232  -0.175  -0.220  -0.135         \nlettuce                         0.169  -0.262           0.223                 \nkronenbourg    -0.407   0.159  -0.336  -0.123   0.130                         \nleeks           0.125   0.164                  -0.168                         \nfanta                          -0.192   0.181  -0.307           0.301         \ntea            -0.150           0.106                   0.132   0.164         \nwhiskey         0.207                   0.158   0.213                  -0.118 \npeas            0.193                   0.133                  -0.159   0.197 \nnewspaper              -0.401                  -0.140  -0.170  -0.137         \nmuesli         -0.137   0.169                  -0.296   0.157          -0.308 \nwhite.wine                                                     -0.142         \ncarrots                -0.135          -0.284  -0.188   0.107   0.220  -0.258 \nspinach                         0.260          -0.122   0.143           0.165 \npate                                                    0.223           0.105 \ninstant.coffee  0.287   0.103   0.265                  -0.249          -0.115 \ntwix           -0.211           0.193  -0.167   0.123   0.105   0.338         \npotatoes       -0.430           0.278           0.253  -0.263  -0.101  -0.126 \nfosters         0.270  -0.233                  -0.221  -0.295   0.192         \nsoup                   -0.274          -0.144           0.137                 \ntoad.in.hole   -0.162                                  -0.155           0.114 \ncoco.pops                      -0.102   0.224   0.123                         \nkitkat          0.207   0.515  -0.201           0.189                         \nbroccoli        0.103          -0.396           0.164                         \ncigarettes      0.118          -0.151  -0.111  -0.105  -0.284  -0.193         \n               Comp.34 Comp.35 Comp.36 Comp.37 Comp.38 Comp.39 Comp.40 Comp.41\nlasagna                 0.144   0.237   0.257           0.388                 \npepsi                   0.135  -0.256   0.199                   0.290  -0.114 \nyop            -0.186   0.234          -0.116                                 \nred.wine        0.125  -0.249           0.484          -0.116           0.228 \ncheese                  0.293  -0.196   0.113  -0.172   0.137  -0.542  -0.146 \nbbq                    -0.157                                                 \nbulmers        -0.266                  -0.119   0.168  -0.230  -0.285   0.451 \nmayonnaise                      0.247  -0.105          -0.217   0.375         \nhorlics         0.149                                                         \nchicken.tikka                   0.174  -0.111                   0.127         \nmilk           -0.112          -0.272   0.133  -0.163   0.256   0.185   0.170 \nmars                   -0.119          -0.381  -0.326   0.136           0.105 \ncoke            0.335  -0.289   0.180  -0.160  -0.137   0.160  -0.212         \nlottery                                                                       \nbread                  -0.393                   0.168   0.381           0.261 \npizza           0.275          -0.497  -0.200          -0.260                 \nsunny.delight                  -0.144           0.114                         \nham                                                             0.191   0.103 \nlettuce         0.151   0.225           0.118          -0.236                 \nkronenbourg                     0.140  -0.155           0.184          -0.275 \nleeks          -0.203                  -0.248   0.197                         \nfanta                           0.169                          -0.174   0.121 \ntea             0.489   0.194                   0.275                         \nwhiskey         0.231          -0.102  -0.139                                 \npeas            0.109  -0.170  -0.170           0.380                  -0.172 \nnewspaper       0.132   0.117                   0.174                   0.106 \nmuesli         -0.151           0.135  -0.152   0.206   0.102  -0.266         \nwhite.wine                                                             -0.205 \ncarrots         0.186                          -0.284   0.147           0.188 \nspinach        -0.150   0.134                   0.211   0.181   0.131   0.127 \npate                                                   -0.223          -0.120 \ninstant.coffee -0.215  -0.166                  -0.337  -0.206                 \ntwix           -0.227  -0.170  -0.241   0.275                          -0.349 \npotatoes                0.261   0.123   0.120  -0.237           0.110         \nfosters                 0.182          -0.126           0.202          -0.372 \nsoup           -0.147           0.108                          -0.117         \ntoad.in.hole                           -0.108                                 \ncoco.pops              -0.151   0.109                  -0.103                 \nkitkat                  0.202                   0.163                   0.131 \nbroccoli               -0.197   0.304   0.233  -0.162  -0.206  -0.220  -0.112 \ncigarettes              0.134   0.165                                         \n\n               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9\nSS loadings     1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000\nProportion Var  0.024  0.024  0.024  0.024  0.024  0.024  0.024  0.024  0.024\nCumulative Var  0.024  0.049  0.073  0.098  0.122  0.146  0.171  0.195  0.220\n               Comp.10 Comp.11 Comp.12 Comp.13 Comp.14 Comp.15 Comp.16 Comp.17\nSS loadings      1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000\nProportion Var   0.024   0.024   0.024   0.024   0.024   0.024   0.024   0.024\nCumulative Var   0.244   0.268   0.293   0.317   0.341   0.366   0.390   0.415\n               Comp.18 Comp.19 Comp.20 Comp.21 Comp.22 Comp.23 Comp.24 Comp.25\nSS loadings      1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000\nProportion Var   0.024   0.024   0.024   0.024   0.024   0.024   0.024   0.024\nCumulative Var   0.439   0.463   0.488   0.512   0.537   0.561   0.585   0.610\n               Comp.26 Comp.27 Comp.28 Comp.29 Comp.30 Comp.31 Comp.32 Comp.33\nSS loadings      1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000\nProportion Var   0.024   0.024   0.024   0.024   0.024   0.024   0.024   0.024\nCumulative Var   0.634   0.659   0.683   0.707   0.732   0.756   0.780   0.805\n               Comp.34 Comp.35 Comp.36 Comp.37 Comp.38 Comp.39 Comp.40 Comp.41\nSS loadings      1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000\nProportion Var   0.024   0.024   0.024   0.024   0.024   0.024   0.024   0.024\nCumulative Var   0.829   0.854   0.878   0.902   0.927   0.951   0.976   1.000\n```\n:::\n\n```{.r .cell-code}\nfviz_eig(output.pca, addlabels = TRUE)\n```\n\n::: {.cell-output-display}\n![](07MoreRegs_files/figure-html/unnamed-chunk-5-1.png){width=576}\n:::\n\n```{.r .cell-code}\nfviz_pca_var(output.pca)\n```\n\n::: {.cell-output-display}\n![](07MoreRegs_files/figure-html/unnamed-chunk-5-2.png){width=576}\n:::\n:::\n\n\n## Visualizing the Results\n\n-   `get_eigenvalue(res.pca)`: Extract the eigenvalues/variances of principal components\n\n-   `fviz_eig(res.pca)`: Visualize the eigenvalues\n\n-   `get_pca_ind(res.pca)`, `get_pca_var(res.pca)`: Extract the results for individuals and variables, respectively.\n\n-   `fviz_pca_ind(res.pca)`, `fviz_pca_var(res.pca)`: Visualize the results individuals and variables, respectively.\n\n-   `fviz_pca_biplot(res.pca)`: Make a biplot of individuals and variables.\n\n# PCA Regression\n\nPCR (Massy, 1965) เป็นการผสมกันระหว่างเทคนิค PCA กับ OLS regression หลักการนี้ยังสามารถนำไปใช้ร่วมกับ machine learning ตัวอื่น ๆ ได้อีกด้วย\n\n![Boehmke, and Greenwell (2020)](images/image-1396714705.png){width=\"451\"}\n\nวิธีการนี้จะมี hyperparameter 1 ตัวได้แก่ จำนวนองค์ประกอบหลัก ชุดข้อมูลที่ใช้เป็นตัวอย่างจะใช้ชุดข้อมูล [`PCR_PLS.csv`](PCR_PLS.csv)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- read.csv(\"PCR_PLS.csv\")\ndat <- dat[,-1]\nhead(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           y         X1          X2         X3         X4        X5        X6\n1   9.984933  1.0158064 -0.04971771  0.3662059  0.2681972 0.1738431 0.4510301\n2   6.660018 -1.9134587 -0.05274375  0.8283358  2.6422684 0.3161111 1.8965145\n3  -6.639163  2.2498462 -2.11062234 -1.5848133  0.7169829 0.4462934 0.7966766\n4  -4.270990  1.7924403  0.90155637  0.1131497  0.9090441 0.4725291 0.6269838\n5 -49.138411  0.2764585  0.24109380  0.4009921 -1.2967605 2.1909398 0.3600757\n6  37.485506 -0.8304207  1.42706634  0.7714889  0.1564899 1.8013796 0.6596009\n           X7         X8         X9        X10         X11        X12\n1 -0.47414621  0.4946957 -1.6472264  0.9722813 -0.04698793  0.6174569\n2 -0.04989816 -0.2083310 -2.5363495 -0.4285371 -0.55916953  0.7536792\n3  0.91563749  0.5862050 -1.1864016  0.2743799 -0.66972236  0.7275327\n4  0.02891661 -1.0420777 -1.2463272  0.3722624  1.01335403 -1.3666861\n5 -1.41464421 -1.5630284 -0.9449623  0.2744185 -0.96786327 -0.9874861\n6 -1.79546273  0.9071250  0.2903273 -0.7749220  0.23469795 -0.1349186\n         X13        X14         X15         X16        X17        X18\n1 -0.6961410  0.8874926  0.02206650  0.10258642  0.9726369 -0.1134140\n2 -0.2734640  1.1503095 -0.01618744  0.67952972 -0.2402119 -1.4277475\n3 -2.9416534  1.1654695  0.29448823 -1.77338480 -1.6003006 -1.7453208\n4  0.4680035 -0.2166036 -0.19594887 -0.62299126  0.4734951  0.3183905\n5 -1.0658297 -1.0796678  0.54733562 -0.08688303  0.1655608  0.8996053\n6  1.0358171 -1.0892422  1.78308745  0.21536483 -1.5312827  3.5180495\n         X19        X20         X21         X22        X23         X24\n1  0.6469702 -0.1968259 -0.76955986 -0.87841993 -1.6348308 -0.18056730\n2  1.3178002  1.4588030 -0.39514112  1.87703892  0.7298470  0.45293764\n3 -1.4993318 -1.0675324  0.60950260  1.23362005  0.3663909 -0.50082659\n4  1.1037027  0.2212775 -0.76351463 -0.03916482 -1.6749968 -0.05163278\n5  2.1652030 -0.2719989 -0.05227846  1.81782835 -0.6700007  0.72398500\n6  0.4395773 -1.3626896  0.21600762 -0.51692511 -0.0973949 -0.05543589\n          X25         X26        X27        X28        X29         X30\n1 -0.01614269  0.60933462  2.4310370  0.3444247  0.4702251 -0.08499832\n2 -0.58219566  1.67349038 -0.7462495  0.2223211  0.5994884 -1.25152492\n3 -0.10769347 -1.47595772 -1.0165865 -0.1310064 -0.8255134 -1.10505047\n4  0.23936135 -0.56764532  1.5019490  0.9889429 -1.9337245 -1.42075824\n5  0.40486720 -0.17027144  0.6959773 -0.4128240  0.7132876 -0.76500911\n6 -0.41032351  0.04273196  0.7282050  0.2037987  1.1977008  0.77184175\n         X31         X32        X33         X34        X35          X36\n1  1.4275029 -0.19463677 -0.2461545  1.13874445  0.4777541  1.881091603\n2  1.3382337  0.69087005 -1.0328578 -0.21620882  0.5115946 -0.007789507\n3  0.5233381 -0.56706506 -0.8494355 -0.07650938 -0.5093376  1.183648402\n4  0.1826708 -0.30544502  0.6143933  0.49485499 -1.1181145  1.152770589\n5  0.2222903 -0.02058663  0.1679687 -0.35756629  1.6246395 -0.259526455\n6 -0.1545735 -0.91302769  0.2745130 -1.14677267 -0.7227922 -0.587323104\n         X37          X38        X39        X40         X41        X42\n1  0.9962203  0.347539784 -0.4768833 -1.3970278 -1.75557985 -0.6333098\n2  0.8595711 -0.366180946 -0.1193068  0.9825513 -0.08136742 -1.5313715\n3 -0.5038345  0.009917471  0.8492360  0.4431217 -0.06717785  2.0712287\n4  0.1719652 -0.048040105  0.6308746  0.2372974 -2.17503332  0.1558082\n5 -0.4401464  0.071733195  0.2358582 -1.4238420 -1.71915979 -1.6685998\n6  0.8052824  1.009852210 -0.2144632  1.1923449  0.76884381  0.2115855\n         X43        X44        X45        X46        X47        X48         X49\n1 -0.1530267 -0.3413094 -0.2204692 -0.7320133  1.8430386  0.2092832  0.52340684\n2 -0.3683216  1.5167539  0.9376758  0.3645108  1.6697614  0.9672353  0.90256241\n3  1.1205120  0.0691507  1.7412553 -0.8243335 -1.1158026 -0.4607803  0.07419745\n4 -0.3663769  0.2196471 -1.2795093  1.1551746  1.1590250 -0.8837257 -0.02210936\n5 -0.9953294  1.0446561 -2.2125356  0.8907055  2.1817578 -1.6381257 -1.33656455\n6  0.5029376 -1.2322598  1.4516929  0.8331052  0.5778162 -0.2544249 -0.12139932\n         X50         X51           X52        X53        X54        X55\n1 -0.3267436  0.31863144  1.2714896603  0.4758973  1.3153841 -0.8081106\n2  0.9613450 -1.96788149  0.4078023060 -0.1041874 -0.2237258  1.4502842\n3  0.7062751  0.30626836 -0.5829288293  0.9384944 -0.8598999  1.1152861\n4  1.8923034 -1.22272112 -1.1728591923 -0.4218157  0.9041996 -1.6215223\n5 -0.3155100  0.07964538 -0.9067171529  0.0232780 -0.3766764 -1.1133358\n6  1.3102711 -0.31396770  0.0004392628 -0.4109987 -0.3356297  0.6068084\n          X56        X57        X58         X59        X60        X61\n1  0.60476377 -2.5301290 -0.5120166  0.32267074 -0.7744064 -0.5146931\n2  1.85217183  0.1049847  1.6715865  0.95979036 -0.2877077 -1.2094675\n3 -0.03316145  0.0906289  0.5283310  1.62888999 -1.1908081 -1.3256631\n4 -1.51633682  0.6971519 -0.7342494  1.04751235  0.6014694 -0.6069932\n5  0.07259122  0.7185070 -1.1586603  0.09002276  0.1152027  1.9223356\n6 -0.95504076  0.3606236  1.2151824 -0.95222455 -1.3253275  1.6035962\n         X62        X63         X64        X65        X66        X67        X68\n1 -0.8375388  1.7887799 -2.72610661  2.5255087  0.5281371  0.7255767  1.4292883\n2  1.2640499  0.9172451  0.20356182  1.1857272 -0.8456149 -0.2847767  0.3181986\n3  0.9512414 -1.4391610 -1.35085293 -0.8308972 -1.4155759  0.4714007 -0.8629507\n4 -0.3296197  1.7192155  0.29303645  0.2552803  1.0537897  0.9551602  0.2586436\n5  0.4630208 -1.2381623  0.33811493  0.4306388 -1.6592832 -0.7281128  0.2153493\n6 -1.7297821  0.1328906  0.04072015  2.4153784  1.0903064 -0.4874916 -0.4054149\n           X69        X70        X71       X72         X73        X74\n1  0.004730102 -0.6421162 -1.5844588 1.2111238 -0.12863656 -0.6907068\n2  0.666360716  1.2909281 -2.1621588 0.8885472  1.98210702  2.8006319\n3  0.398217467  0.6635806 -0.6506964 0.8218845  1.78211746  0.2665211\n4  2.182634029 -0.5067821  0.2039035 2.1215657 -0.49049046 -1.5585094\n5 -0.899365503  0.3438816  0.2273961 0.7130052  0.07166236  0.8114147\n6 -0.247212784  0.3256931  2.0846188 1.3888550  1.37836245 -0.5335693\n         X75        X76        X77         X78        X79        X80        X81\n1 -0.5948425 -0.7366308  0.5550039  1.03857782  0.2594135  1.4277520 -1.1890043\n2 -1.2575729  0.1518504 -1.5854465 -0.06241577 -1.0790088 -0.1131690  0.3286476\n3  0.2630147  1.0173122  1.8665209 -0.20464413 -1.6721555 -0.6747528 -0.3398909\n4  0.1806577 -0.5802978 -1.5846768 -1.05314116 -0.8634438  0.9507969  1.1138294\n5 -2.0455374  0.8570018  1.1441762  0.37201010 -1.0832944 -1.2444961 -0.2447511\n6  0.1884701 -0.1758213 -0.4098884 -1.78586124  0.5851547  0.7816994  2.0347818\n           X82         X83        X84        X85        X86        X87\n1 -0.003287119  0.92428364  2.2066481  2.4130476 -0.8572698 -1.2855504\n2 -0.947611403 -0.06225657 -0.2799550  1.4429596  0.2214158  1.1056386\n3 -0.171875617 -2.39219833 -0.9383744  0.4635711  0.7572464 -0.6741229\n4 -0.156082514  2.71062883 -0.9225463 -0.4338260  1.0015199  0.4538512\n5  0.848026525  0.86322417 -0.5951968 -0.2215762  0.2353993  0.5390610\n6 -0.155509314 -0.40228540 -0.3707382  0.4496341 -0.7544180 -0.7876213\n         X88        X89        X90        X91        X92        X93         X94\n1  0.7300418  0.5611934 -1.0662955  0.5967005 -1.9518652 -1.7346211  1.51071782\n2  1.8871142 -0.2419785 -0.2761891 -1.3022803  0.8079626 -0.9983296 -1.28062591\n3 -0.2220925  0.2673056 -2.0030774  1.6815756 -0.8527272  0.8998896  0.01753198\n4 -0.1370183 -2.1070013  0.3809179  0.7803927 -0.3481677 -0.6297268 -0.66803260\n5 -0.4228019  1.8724135  0.1990432 -1.0533399  1.3363547  1.7248199  0.13101122\n6  1.0030816 -0.8680784 -0.1896470 -0.4053278 -0.5527105  0.6317236 -0.95943092\n          X95        X96         X97        X98        X99       X100\n1 -0.04679963  0.7068412  0.96273664 -1.0657281 -0.4724751  0.1861980\n2 -0.42019930  1.5522504  0.05648553 -1.3443127 -0.9174435 -0.5408612\n3 -0.56209548 -0.4173118 -0.54748714  1.1860220 -0.7875755 -0.2703747\n4  2.57356211 -0.3166853 -1.04715873  0.9753496  1.0806676 -2.0998606\n5 -0.36405637  0.3214919  1.05501153  0.1532471  1.3176601  0.9218010\n6 -0.21943901 -1.5121437 -1.40290130 -0.1520159  0.6056943  0.4562645\n         X101       X102       X103       X104        X105       X106\n1 -0.09904497  1.5341758 -0.1060290  0.6968215  0.58610746  0.6117728\n2 -0.54116382  0.9685152 -0.4620293  0.3077151 -0.95433484  0.7320302\n3 -1.71255329 -0.3166902  0.2693975  0.5282049  0.62093281 -0.7160309\n4  0.91078658  1.8235211  0.5218482  0.9037337  0.61980037 -0.4548570\n5  0.21650635  0.7915406 -1.3657635  2.0468741 -1.19524098 -1.4483365\n6  0.74942702  0.5150715  0.3684643 -1.6932453 -0.07448452 -0.2256831\n        X107       X108       X109       X110       X111       X112\n1 -0.8628429 -0.2991616  0.0982903  0.1214901  1.2119756  0.2020085\n2 -0.3845184  0.7896434  1.2514292  1.9497899 -1.7773806 -0.2334608\n3  0.3207092 -0.2028970  1.0170538  0.2883308 -0.4708947  1.2954678\n4 -0.2759286  0.4876005  0.6612380  1.2827374  1.8253239  1.5932416\n5  1.0813915 -0.6680046 -1.0827145 -2.1965374 -0.2204932 -0.8995447\n6  0.6285820  0.1254090 -0.3630554  1.5526590 -0.9434639 -1.5246790\n          X113        X114       X115        X116       X117       X118\n1 -1.748636589  1.16876439  0.8688968 -0.87968369 -0.1041024  0.7172490\n2 -0.272312023  0.85296582 -0.6004657  0.01123108 -1.1729643 -0.4558445\n3  0.996576680 -0.38075800 -1.3583393 -0.65066727 -0.8040903  1.2452305\n4 -0.085217511 -0.02201487 -0.8137944 -1.89904747  0.7188462 -1.7227002\n5  0.001448094  0.94205908  1.4744847 -0.16797090  1.1065751  0.2101963\n6  1.775614816 -1.56274708  0.7466738  0.65789930  1.4871568 -1.3326138\n         X119       X120       X121       X122        X123       X124\n1  1.82318078 -1.2638012  1.1470177 -1.5615206 -0.47239762 -0.6416049\n2 -0.98037127 -0.7304809  1.0810458 -1.3749972 -0.79152829  0.3142434\n3 -0.39856462  0.2329750 -1.3160656  0.2931542 -0.84130158 -0.2309234\n4 -0.89982228  0.3966732  0.4570818 -0.7017853  0.10268822  0.0565119\n5 -0.02911529 -0.7182303  0.9444901 -1.6378424 -0.89714171 -1.4996347\n6 -1.16259844  0.7875546 -0.1062244  0.1744033 -0.06845887  1.0483231\n        X125       X126        X127       X128       X129        X130\n1  1.1656393  1.7043932  0.04943314 -0.9695184  0.1436982  0.49416729\n2  1.4058614  0.2531298  1.78325024 -0.3462771 -1.2293387  0.07744692\n3 -1.9109681  0.2805386 -0.83023711  0.1203953  1.0084022 -1.03200837\n4 -0.9734639 -0.5511719  1.13318064  1.0927980  0.9775016  0.94439355\n5 -0.9907749  1.5534107 -1.03850539  0.7353927 -1.3100656 -0.56946423\n6 -0.1401047 -1.8852103  2.26308154 -0.4102717  1.1698479  0.41696475\n        X131         X132       X133        X134       X135       X136\n1  1.5802173  1.208774652  0.9017212  0.01415215 -0.8872627  0.2111655\n2 -0.4860119  2.157496173 -1.2670733 -1.12346697  0.9918790  0.2854221\n3 -0.3831034 -1.022361155  1.4312497  0.85780095  0.2028995  0.2846924\n4 -1.8827827 -0.152833759  0.2905118  1.61672901  0.3134155 -0.6505356\n5  1.5020882  1.710407771  0.6881106 -1.50095548 -1.1403520  0.9276520\n6  0.6167308 -0.002593116  1.1361461 -0.25443099 -0.5927708 -0.9141714\n        X137         X138       X139       X140       X141        X142\n1  1.3651908 -1.728294646  0.1665075 -1.3650419  1.6469130 -0.06723552\n2  1.4351888  1.790632237 -0.5763937  0.4024048 -0.4205429 -0.50021163\n3  0.3196628 -0.002193974  1.0346126  1.1227287  2.6504893  0.68032643\n4 -0.8372669  0.411786723 -0.3686731  0.1785403  1.5215428 -1.99348122\n5  0.6438767 -0.380027918  1.0701209  0.0959481 -1.0147268 -1.20792528\n6  0.8807142 -0.422318388  0.9444184 -1.3564209 -1.3570171 -2.08912167\n        X143       X144        X145        X146       X147       X148\n1  1.5619294 -0.5075506 -0.91417687 -2.35203512  1.8799606 -0.2074807\n2  1.2769267  0.4307448  0.09983473 -0.05402790  0.8909651  0.9319296\n3  1.3760529  0.5151495  0.72575115  1.14108327 -0.3041799  1.3496457\n4  0.7874981 -0.4200093  0.91291566 -0.08933368 -1.8107823  0.4432645\n5  0.1067357  0.6321132 -0.72659765 -2.70696709 -1.5506178 -0.1631249\n6 -0.4477684  0.7884801  0.68548848 -1.71711116  0.3168905  1.7306969\n        X149       X150        X151        X152       X153        X154\n1 -0.4230541 -1.7386982  1.73542240 -1.44754400 -2.4515744  0.55399481\n2  0.4268775 -0.8424679 -0.33905100 -0.04644179 -1.7000035  0.36216907\n3  0.2950248  0.7535713 -0.81124359  0.81321017 -0.5551755  0.23720759\n4 -1.4637242  0.1466287  0.08369212  0.82140806  0.7753099 -0.21177722\n5  0.4259449 -0.1210130 -0.50459878 -1.50695564 -0.3838886 -0.11004731\n6  0.5294776  1.7702357  0.62113412  0.11215705 -0.8351358 -0.06013129\n        X155       X156       X157       X158        X159        X160\n1 -0.7235141  0.1645231  0.3917103  1.1999708  0.73148515  2.18576471\n2  0.9598021  0.5440890  0.2939718  1.1721450 -1.04045828  0.56472652\n3  0.4622537 -1.2077839  0.6283511  1.7824232  1.67962968  0.70020013\n4 -1.0259356 -1.7804557  0.2004020  0.2896693  0.12553670  0.86319140\n5 -0.2684707  0.8542051 -0.2462087 -1.0369816 -0.05306438 -0.01607454\n6 -0.6278206  1.1547227  1.3042949 -0.9536458 -1.87387917 -0.55022924\n         X161       X162       X163        X164        X165        X166\n1 -0.53644798 -0.9799511 -0.4026602 -1.11215785 -0.10738561 -1.37101933\n2  0.02915232  0.9712818  0.8954821  0.07862621  0.22051865  0.16389130\n3  0.21499606  1.4051525 -0.4419964  1.27842557  0.05122494 -0.32791205\n4  0.51654450  0.4360289  0.4644811  1.20801717 -0.43703981  0.03394616\n5 -0.75147208 -0.4572605  1.1892386  0.21912845 -0.19810185  0.72297710\n6  2.48333499 -1.1276646 -0.4349666 -0.30022082 -0.58915656 -0.31469292\n        X167       X168       X169        X170       X171       X172       X173\n1 -0.2559577  1.6774502 -0.4868639  0.70208461  1.0969669  0.6750752 -0.5759962\n2 -0.1030723 -0.7820152 -1.5542581  0.39193869  1.5572974  1.6721280  0.1150358\n3 -1.1437471 -0.1461219 -0.3884240  0.02060054  0.4155356 -0.3399094  0.5142012\n4 -0.5433186  0.4296221 -0.1278870 -1.05890630  0.6515273 -1.0648774  2.5287213\n5  0.6607351  1.0572762 -1.0885912 -1.00967691 -1.2075742 -0.3918997  2.2506141\n6 -0.6278857  1.7451583 -0.5919509  0.92333175  0.9063976  0.1889044 -0.7538478\n         X174       X175       X176       X177        X178       X179\n1  0.02088238  2.0259097 -0.8228568 -0.1883093 -0.42809051 -0.2358186\n2  0.29379977 -0.1901409 -0.7644024  0.5199067 -0.05611862 -0.2528559\n3  1.14825931 -0.5171856 -3.6560949 -0.8175560  0.40870837  1.6021985\n4 -0.62145734  1.8328053 -1.3361862 -1.1630148  0.42781139 -1.8419185\n5  0.39862291 -1.6982887 -0.1381203 -0.7729189 -1.54062296 -0.4218943\n6  0.15665512 -1.6202572 -0.7193856  1.1718337 -2.13443088  1.7273461\n         X180       X181       X182        X183       X184       X185\n1  1.63409289  0.1768484  1.2079054  0.63724053  1.4748222  0.3764500\n2 -0.12284233 -0.4025536 -0.6776504  0.02897972 -1.4492424  0.7027955\n3  1.14444357  1.4002287  0.8685555  1.51715257  0.2228262 -1.0518834\n4  0.35245835 -1.0983379 -1.0836159  0.36364623  0.1234638  0.8135177\n5 -0.05465058 -0.1165547  1.1512945 -1.14164579  1.0965378 -0.4059121\n6 -1.09673647  1.5239053 -0.6664925 -0.68133589  0.9650564  0.8137198\n         X186        X187       X188        X189       X190        X191\n1 -0.01996921 -1.21739556  2.0980087 -1.03848905  0.6271570  0.37386479\n2 -0.26637562  1.31087095  2.4095952 -0.53942481  0.2927700  0.06189282\n3 -0.02360176  0.99379829  1.1909829 -0.24262130 -0.5548322  0.53925628\n4 -0.42782378  0.17138389  0.2801402 -0.40982200  0.1601131  0.96223243\n5 -1.07424294 -0.67249844  1.3573253 -0.03927914 -0.5996688 -0.37755918\n6 -0.23676592 -0.04278698 -0.9880773 -1.42870169 -0.9912114  2.00990953\n        X192         X193       X194       X195       X196       X197\n1  0.4672219 -0.784014099  0.3468662 -0.6147963  1.1229923 -0.5091586\n2  0.9008217 -0.457408162 -1.8099195 -0.4135890 -1.2960972 -0.3238782\n3 -1.2963015  1.391004444  0.1031997 -1.0955844 -2.0578127  0.3156570\n4 -0.3246418 -0.008741952 -0.3096424  1.0493695 -0.1175805  1.1563378\n5 -0.5485287  0.170874960  0.4420329 -2.9923104 -1.3690428  0.7956396\n6 -1.6611121 -1.288357003 -1.2032210 -0.6234684 -1.0318926 -1.8180349\n         X198        X199       X200       X201        X202       X203\n1  0.01834432  0.46558399  2.1621219  0.2993273 -0.53509980  0.9750997\n2 -0.51071500 -0.35480376 -0.5976041 -0.8051751 -1.53394550  0.9092546\n3 -0.23778842 -0.22831845 -1.9884113  2.7893753  0.05450347 -0.1957647\n4  0.58087165  0.05398363 -1.3602799  0.6620351 -0.82829055 -0.7194291\n5  0.74766531 -0.43927583  0.4918967 -0.6949625  0.66665471 -1.7098228\n6 -1.53643776  0.21091443 -0.9527977 -1.8615164 -0.12319251 -0.8760145\n         X204       X205        X206       X207        X208        X209\n1  0.38086415 -1.1963355 -1.57545915  0.1168503 -1.95332770  0.56806531\n2  1.11148547 -1.5921525  0.35680191 -0.6654059  0.04223303  0.02611101\n3  0.64700211 -0.1477776  1.16068784 -0.3732160 -0.84367182 -0.39347602\n4 -0.01617322 -0.5064716  0.08223839  0.9638512 -0.78937705  1.87814277\n5  0.17852909  0.9223298 -0.87889646  0.6536058  0.17852425 -0.50775910\n6  0.06232370 -0.5097953 -2.14729373  1.3352899  0.26897036  0.70532153\n        X210       X211       X212       X213       X214       X215       X216\n1  0.6031787  0.1479719 -1.3667938 -0.4264195  1.1710088  1.0947177 -0.7749229\n2  0.8493141 -0.4546756 -0.2750453  0.7937465 -2.0644877  0.4336323  0.9095720\n3  1.9202092  0.0566818  2.4112346  0.3860596 -2.4504298 -1.0553430  0.3744328\n4  0.1331444 -0.6492988  0.2814963  0.8854570  1.5951385  0.4716861 -0.7027431\n5 -3.0190165 -0.3708787 -0.4415243 -0.9525236 -0.2176284 -0.1562597  0.2167438\n6  0.0474760  1.8567807  0.2839615 -0.9735406 -1.3895609 -1.3811799 -0.1321597\n         X217       X218       X219        X220       X221       X222      X223\n1  1.36858259 -0.1131006 -3.3297309 -0.03013956  0.4224142 -1.7909614 0.6778922\n2 -0.41306826  0.3397433 -0.0280979 -1.14706689 -0.3893694  2.4791123 0.1707893\n3 -1.46273205 -0.1882670  0.1890153 -1.21042460  1.1689827  0.5007207 0.4371470\n4  0.93418962 -1.3544971  0.3104155 -0.56796146  1.8555088 -1.1733529 0.4278935\n5  0.05185741  0.2386766 -0.2944904  0.36098534 -0.7207080 -2.6725782 0.1023965\n6 -1.57139533  0.5501283 -2.3112929 -0.48724263 -0.3175654 -1.5749998 0.9404864\n         X224       X225       X226       X227        X228      X229\n1 -0.58961140 -0.6540053 -1.8366638  1.1920899 -0.03284564 0.1681543\n2  0.29495795 -0.5648962 -0.6048803 -0.0331090  0.16644000 0.1736978\n3  0.81374266  1.3579731  1.5143016  0.3905942 -1.59647367 0.8735504\n4  1.84300771  0.1305926 -1.1567472  0.7074478 -0.09838112 0.6412730\n5 -0.90326108  2.6976590 -0.6948589 -1.4881205  1.25914975 1.0557051\n6  0.04612531  1.9572287  0.7751529  2.7653532  0.12284011 0.6182122\n         X230       X231       X232        X233       X234       X235\n1 -0.02529204  0.4596653 -1.0683214  2.23919123 -0.4441101  0.7016374\n2 -0.27227422 -1.7266613 -1.0868711 -2.18582610  0.0615851  0.7126264\n3  0.57313648 -0.4852928 -0.5626054  1.41504293  1.2524729  1.0502603\n4  0.64006388  0.4811146  0.3786004  0.02277383  0.1554111 -1.4338166\n5 -0.22889298 -1.2021733 -1.4751680 -0.45531819  1.2397392 -2.1553509\n6  0.23312069  0.1972217 -1.4883125  1.28171473  0.7442596 -1.2214176\n        X236        X237        X238       X239       X240       X241\n1  1.4389150 -0.52649411 -1.10253015 -1.0073082 -0.1942125  0.1954392\n2 -0.1101996  1.13834611 -0.05791419  0.1549064  0.3343358  0.1512210\n3  0.7300683 -0.09983534 -0.24034417 -0.5903741 -0.6720537  0.7755788\n4  0.8862943 -0.46724166  0.68450941 -2.1223553  0.4043830  1.8950745\n5  1.1957228  1.37617981  0.85014029 -0.7023533 -1.5063481  0.3925280\n6  1.5154021  1.88916583 -0.06596160  0.4310794  1.4410752 -0.6434462\n        X242      X243       X244       X245       X246       X247        X248\n1  0.1355459 0.1008068  0.6499596 -0.2955661  0.1821827  0.2660890  0.49839119\n2  0.5570920 2.0128714  0.8909409 -1.1964638  0.0294789 -0.1857792 -0.75620441\n3  0.3792589 0.5261908 -0.0943861  2.7304706  1.1623358  0.3604784 -0.83222525\n4  0.5642875 0.1492209 -0.0185439  0.1982063 -2.8399355 -0.2463885  2.18047889\n5 -0.9864843 1.6071288 -0.9383021  0.2531356  1.5374238 -0.5739313  0.27477548\n6 -1.7040678 0.6779709  0.8925079 -1.8685967 -0.1041368 -1.8980158  0.05895246\n        X249        X250        X251        X252       X253       X254\n1 -0.5806796  2.31978322 -0.14922327 -1.42045912 -1.0043878  0.1968094\n2  1.7116714 -0.03338001  0.05644909 -1.45410747 -1.4715751 -0.5804814\n3 -1.3613046  1.25482434 -0.27130427  1.18144344  0.6894378  0.2834301\n4 -0.2914067  0.82078430  1.11628913  0.48345065 -0.9172271 -0.3702088\n5 -0.3027776  2.96512704 -0.09735883 -0.02374787  0.8350489  0.7463075\n6  1.1976721 -2.25891543 -1.22436127  0.14548034 -1.6022411 -0.0123675\n        X255        X256       X257        X258        X259       X260\n1 -0.3884183  0.03232421 0.35207616 -0.04400681 -1.18712445 -1.8390265\n2 -0.3772051  1.99927023 0.70126918 -1.89743677  0.06252053  0.1182983\n3  1.7633865 -0.71912695 0.07515911  1.14337694 -0.96517366 -0.4684030\n4 -1.4273628  1.59325446 0.68683374  1.74143031 -2.10487302 -0.5181409\n5 -0.3643365  0.83531723 1.96219926 -1.05415302  0.82509236  0.3022651\n6  0.3340487 -0.74222743 1.28095641 -0.38939392  0.79971442  2.0489232\n         X261        X262       X263        X264       X265       X266\n1 -0.29855503 -0.49317277  0.1532953 -0.71547075 -1.7825641  0.3448612\n2  0.20737628 -0.09067657  1.2877913  0.04055317 -0.1904119 -1.1760041\n3  0.07243598 -0.20338430 -1.2293227 -0.41496238  0.9412451  1.1333890\n4  1.15686485 -0.56767947 -1.0121966  0.49213246 -0.6094456  0.4291921\n5 -0.34462631  3.05605134 -0.4795875 -1.73894108 -1.3861464 -0.6760233\n6  0.46734656 -0.93553000 -0.2413587 -0.63422867 -0.8877323 -1.3108275\n        X267       X268       X269       X270       X271        X272\n1  0.3002671  0.9529553 -0.9549540 -2.6896591  1.5761857 -1.60782532\n2 -2.3513637  0.3860579  1.8466423  0.8927559  1.3378476 -0.89301501\n3  1.1651877 -0.6886168  0.4596633 -2.5106802  0.1527908 -0.07883397\n4 -1.3164799 -2.5588721  0.8692256 -0.7637673  2.8620401 -0.95183065\n5  0.3570584 -0.7264769 -1.0675228  1.8076947  2.3780350 -0.73980684\n6  0.2514387  0.3669032  0.5896695  0.1173993 -0.8698569 -0.29873453\n         X273       X274       X275       X276       X277        X278\n1 -0.82912119 -0.2788423  1.9886314 -0.7897751 -1.0886407  0.21567893\n2 -1.86999472  0.1282637 -1.6507592 -0.4693892  0.6949936 -0.75245141\n3 -0.50635765 -0.4125815 -1.1908126  0.2815493 -2.0100222 -1.35509578\n4  0.42520887  0.7986075 -0.2392986 -1.0992297 -0.2559848  1.25957290\n5 -0.29069669 -0.4272220  1.0304307  0.6904235 -0.5424494  0.66446049\n6 -0.09034229 -0.8522972  0.3135422  1.2343334  0.9499956  0.01297754\n         X279       X280       X281        X282       X283        X284\n1  0.06143870 -0.4452680  0.1459985  0.15929476  0.7834547 -1.10511217\n2  0.05722633 -0.3758965 -0.9989339  0.08325403 -1.4838215  0.04573868\n3 -0.56673337 -0.7699575 -1.4152275 -0.96847008  0.1190804 -0.67328744\n4 -1.58961157  0.6818083 -0.5220779  0.29437847 -0.5453283  1.05325354\n5  0.96109111  0.2934912  0.5385040  0.54210151 -0.3339491 -0.92201529\n6  0.20690936  1.3743773 -0.1976623 -0.45230927 -0.6557762  0.43196079\n        X285       X286       X287       X288       X289       X290        X291\n1  0.1964148  0.4350053 -0.7070256 -0.1711506 -0.2047055  0.2783630  1.15595996\n2 -0.5830575  0.3284514  1.7535257 -0.2282166 -0.6675952 -0.1784251 -1.06559431\n3 -0.3532410  1.1059005  1.8188035 -0.4691559 -0.2228943 -0.3819429  0.05845361\n4  0.4594954 -1.3107903 -1.7258134 -1.0857047  0.4994790  0.2045490  1.02364825\n5  0.6499447  0.3779212 -0.4260765  1.0861172 -0.9313245 -2.3357451  0.81375804\n6  1.6469135 -0.4590674  0.1762695  0.5177583 -1.2510054  0.2346580  0.46262574\n        X292       X293       X294       X295         X296       X297\n1 -0.5739101  0.1255761  1.0483503 -1.3369151 -0.715517590  0.0552446\n2  0.4621002  0.5011942 -0.7543958 -1.6061316 -0.003210432 -1.0109811\n3 -0.1973017 -0.4118315 -1.7969548  1.7320546  0.643429809  1.9911934\n4 -0.6575259 -0.7278773  0.1293647  0.4804897  1.515350218 -1.0129887\n5  0.3073296 -1.8846905  0.7024512 -0.8352643 -1.069846700 -3.1418844\n6 -0.3118336  1.1666311  0.2466670  1.6160791  0.474095154  0.1284313\n        X298       X299        X300       X301       X302       X303       X304\n1  0.8567081 -0.7204728  0.73681705 -1.1486323 -0.0926038  0.6598460 -0.3918187\n2 -0.6011829  0.3163693  0.30231133  1.5241103 -0.8079640  0.9539548 -0.5212388\n3 -0.3941025 -0.2936379 -0.17926807 -0.1769278  0.6439428 -1.1001651  0.1682036\n4 -0.3709984  0.1364741  0.04063419 -0.6118146 -2.2230276  1.9489289  0.4701042\n5  0.1724387  0.5210318  1.91708944 -0.3438726  0.1899778 -1.5816793 -0.3266654\n6  0.6702434 -1.6458526  0.28384615 -0.5567242 -0.2135486 -0.4900040 -2.6168084\n        X305       X306       X307       X308        X309       X310\n1  0.3891532 -0.6881646 -0.2109627 -0.2123190 -0.36789646 -1.1735676\n2  1.0130316  0.4282536 -0.3205626  0.1481830  0.39234853  2.4265083\n3 -0.2358409 -1.4615444 -0.7550611 -0.7690680  1.15279167  1.0616024\n4 -1.4456875 -1.0004788 -0.2688467  0.7359533  1.24120744 -2.6749041\n5  0.4730201  0.1763194  1.6975655  0.2490358 -0.70036278  0.5746923\n6 -0.1922999 -0.5081443 -0.5356051  0.8008406  0.07832957  0.3012952\n         X311       X312       X313        X314       X315        X316\n1  0.38667174 -1.9012551  1.3992421 -0.43825471 -0.8014358 -1.44507081\n2  1.61682573 -0.2916921  0.6925392  0.28900454  0.7484672 -0.98602085\n3 -0.87127475  1.8214741  1.0206039  0.41507055  1.2723775 -1.28853709\n4 -1.53120705 -0.3797427 -1.1801238 -0.28302644  0.6617388  1.31353022\n5  1.97596297  0.7716391  1.2249688  0.82140315  0.1841715 -0.08023448\n6 -0.09827521  0.8175257  1.0131101  0.04621601 -1.0176074 -0.86595899\n        X317       X318       X319        X320       X321       X322       X323\n1 -0.5117190  0.8074605 -2.5337049  0.60693533 -1.0127552 -1.4604540 -1.4214091\n2 -2.0598528 -0.4614387  0.7714415 -2.67134750  0.4063509 -0.4111046  1.0267112\n3 -0.1297642 -0.8058454  0.3352507  0.70428118 -0.5991241  0.3864209 -0.3114233\n4  0.4913806 -2.2560850 -0.5320275 -0.09283726 -1.0876009  0.2335224  1.5866590\n5 -0.2005187  0.8581896  0.6523079 -0.90715364  0.3944411 -0.1811247 -0.9849677\n6 -0.1988583  0.7497357 -0.1618963 -1.34817781 -1.1622077 -1.0080889 -0.4359867\n         X324        X325       X326       X327       X328       X329\n1 -0.69130051 -0.92378313  0.5692246  0.2715121 -2.8096381 -2.3387643\n2 -1.38576890  0.73276661 -0.7645520 -0.4104942  1.2313491 -1.9289464\n3 -1.53437174 -0.90328396 -0.2375008  0.5473052  1.2230322  0.6000501\n4 -0.79484455  0.31381523  1.3064877  0.9134134 -1.8399635  1.5599360\n5 -1.87207174  1.19958913  0.2910482 -1.2659679  0.3870012 -1.0754980\n6  0.01723827  0.04135371 -2.2879570  0.1608901 -0.4602456  1.8143905\n        X330       X331       X332       X333       X334       X335       X336\n1 -0.6023063 -0.6982877  1.1559257  0.7947909 -1.6704973  0.1133526  0.1405692\n2 -0.6423972  0.3424238  0.2479638  0.7394200  1.8713436 -1.0163869  0.2410947\n3  0.3126714  1.0154527 -1.0140428  0.3766730  0.8378519  0.5018446 -1.2510225\n4 -0.1130892  1.2944930  0.2074468  1.0877474  0.9034331 -1.5867632 -1.2514120\n5  0.9600399  0.3391936 -0.4400891  0.2108988  0.1147497  0.6394918 -1.2550211\n6  1.1274428  0.5034794 -1.8470157 -0.5083538  0.4229115  0.9348689 -1.1231467\n        X337        X338        X339       X340       X341        X342\n1 -0.8195717 -0.04203524 -0.69944768 -2.8694276 -0.3217032 -1.90929794\n2 -0.4011784 -1.14591480 -0.08773168  1.7634030  1.0952532  0.94698992\n3  0.8984100 -0.44731649 -0.24251535  0.8301808 -0.3118069 -0.52242809\n4 -1.3197889 -0.53934553  0.24419582  0.5960042  0.4853488  0.63621791\n5 -2.5557265  0.11302224 -0.17666788  0.3451386 -0.4621898 -0.33048907\n6  0.5866353 -1.42598597  0.75133610 -1.1732630 -0.7944952 -0.09917627\n         X343       X344      X345        X346       X347        X348\n1 -0.06787610  1.1620392 0.4082233 -0.16197572 -0.7391265 -1.29237904\n2  0.66852545  2.5461322 0.1828122 -0.32568169 -0.8148349  1.99811806\n3 -2.44543332 -0.9172067 0.5921140 -0.47451535 -0.9480037 -1.59120649\n4  0.15326199  0.7554057 0.7089444  1.38618311  1.5981738  0.27546183\n5 -0.09486539  0.4713256 0.3235746 -0.44404431  0.5192555 -0.91284677\n6  0.93536888 -0.8417399 1.0999109  0.04909415 -0.7980189  0.00483129\n          X349        X350        X351        X352       X353       X354\n1 -0.789690160  0.22449980 -0.05306994 -1.37856677 -1.5116813 -2.3978523\n2  0.009677854  0.07013776  1.23900557 -0.27349656  0.7805182  0.5413048\n3 -0.349534915  1.47608535  2.82471370 -0.06317013 -1.0864602  0.2697214\n4 -0.550853385  1.69947349 -0.34199642 -0.02602672  0.2942369 -0.5299064\n5 -0.440403442 -0.86911400  2.12756041 -0.69859513  0.7931632  0.5461628\n6 -1.415103454 -0.61103364 -0.78539009  0.91952766  0.6534806 -0.4719150\n         X355       X356        X357       X358        X359      X360\n1 -0.06146781 -0.1929280 -0.77521463  0.1106587 -0.83409242 0.1647688\n2  0.67442950  1.4004004 -0.01428738 -0.7446504 -1.44325869 0.3610314\n3  0.23444615  0.1068258 -1.00835512 -0.2459381 -0.10706420 0.3381612\n4  1.75680697 -0.2745776 -0.04399963 -1.8518674 -0.90280393 0.2322931\n5 -0.43592969 -0.3759552  1.09547758  1.1192356  0.06832585 0.4748015\n6  0.57935713  0.6416725 -0.35238624 -0.3926985  1.37088346 0.1896078\n        X361       X362        X363       X364       X365        X366\n1  0.9293423 -0.3551066 -0.43797860  0.7339142 -1.0945410  0.19703736\n2  0.5083818  1.7793254  1.47825107 -0.3656675 -2.0068913  0.10894427\n3  0.2871989  0.3961821  1.32205974 -0.3337945 -0.2753554 -2.04141761\n4  1.5546522  0.3560753  0.09673984  1.0304470 -0.6366520 -0.06428726\n5 -3.5884428 -0.6355996 -1.19228165 -1.2093365 -0.5790424 -0.05080142\n6 -0.8648830  0.9407687 -1.25870302 -0.6259779 -1.9706786  2.08306135\n        X367        X368       X369       X370       X371       X372\n1  0.5275395  1.58904182 -1.1708071  0.7108255 -1.1313225  1.3179218\n2 -0.2732278  0.98394728 -0.8638506  0.7577224 -0.2094506  0.1564295\n3 -0.9596174 -0.07725697  0.5312020  0.4715427  0.3385468  0.2165464\n4 -0.4001009 -1.82476959 -0.9142677  1.3247840  1.7796261 -1.1470211\n5  1.4215547  0.93657894  0.7233736  0.1204191 -1.1552033  0.4340445\n6  0.9957606  1.19063636  0.6653623 -1.5761578  0.3922055  0.3042884\n         X373        X374       X375       X376       X377        X378\n1 -0.59811213 -0.26147772 -0.2848316 -0.9472546  0.1485980  1.45525937\n2 -0.27185658 -0.31464575  1.2429706  0.5830011 -0.2273404  0.99767651\n3 -0.05624168  0.03923672  0.8708804 -0.9658681 -1.7377551  0.65173214\n4  0.23070522 -0.31930624  0.8001582 -1.1744382 -0.9067196 -0.68455849\n5 -0.40075650 -1.34015992  0.5851860  0.6822356  0.3179236 -2.08996699\n6 -0.58202184 -1.04646460  1.8268936  1.8369720  2.0238874 -0.05131491\n         X379       X380       X381        X382       X383        X384\n1  0.90748854  0.7214361  0.3560079  0.09887806  0.3054747 -1.39816161\n2 -0.08233691  0.2783218  1.3190058 -0.94984285  0.4397089 -0.69252899\n3 -1.69769808  1.6141775  0.6184974 -1.02268862  0.0953093 -0.06928322\n4  1.06805304 -0.5341093  0.1746638 -1.77586542 -2.1379248  0.86414608\n5 -0.06669646 -1.0398229  1.2400793  0.07227688 -2.0854416 -0.81970416\n6  0.36276374 -1.0122635 -0.4218777  0.33821350  0.9380649  0.22731570\n        X385        X386       X387        X388       X389       X390\n1 -0.9891447  0.02613467  1.3088038 -1.63015069 -0.5801054  1.3842493\n2  1.2545774 -0.55440958  0.4308057 -1.67923611  0.3467161 -2.4295906\n3 -0.6913800 -0.49127497  0.8463817 -1.15232674 -1.0791412  1.0065542\n4  0.3933418 -0.87752922 -0.8299205 -1.60523443  1.0115342  0.3540624\n5 -0.8653449  0.31042283  0.1119893 -0.07955136 -0.4732417  0.1160046\n6 -0.4042960 -0.31834693 -1.1358171 -0.27840266  0.7886909 -1.2692774\n        X391       X392       X393       X394         X395       X396\n1 -0.5904879  1.2855773 -0.3847555 -1.1499143  0.003016564 -1.1350404\n2 -2.9727453  0.6215418  0.7449948  1.5379457 -0.900063305  0.1928299\n3  0.7825660  0.7878304 -1.3533362 -0.2263349 -0.282974816 -0.1084235\n4  0.6831007 -0.9330360  0.8506922 -0.5887596 -1.494351424 -0.7148859\n5 -0.1624798  0.2844903 -0.6946526  0.6178445  0.310258349 -1.3994447\n6 -1.4227698  0.1848386 -0.5270679  0.6516401 -0.918483252  0.4967284\n        X397         X398       X399        X400       X401        X402\n1 -1.0508209 -1.077705284  0.5535236 -0.97882715 -0.3904207  0.40327462\n2 -1.2301839  0.595847212 -0.7382957 -0.08100153 -0.4099687 -0.06121769\n3 -2.8141621  0.149592908 -0.0920775  0.51942640  0.9781701  1.50325626\n4  2.4310880 -0.129005961 -0.9286881  0.08977699  0.4333592  0.56629288\n5 -0.5654257  1.004611249  0.7260836  0.11271475  2.5779517 -0.59096422\n6 -0.5158537 -0.003956727 -0.3555881 -2.23264217 -0.5584226 -0.18432012\n        X403       X404       X405        X406       X407       X408\n1  0.1822789  0.4275595 -0.8101809 -0.07419162  1.8197680  1.0802068\n2 -1.0793000 -0.3506762  1.0211109  0.34010422 -0.7134603  0.1858348\n3 -0.1975725  1.3743719  0.4488946  1.07680918 -1.3644607  1.6057563\n4  0.7014207 -0.8629884  0.5371975 -0.29306267  0.5620011 -1.4965578\n5 -0.7192624 -0.9938918  1.7142937  1.77200670 -0.6937253  0.6305667\n6  0.9148789  0.8537410 -0.7290845  1.20956834  1.1647738 -0.1576804\n         X409       X410       X411        X412       X413        X414\n1  0.37372397 -1.0710278  1.4426151 -0.35724703  1.0214831 -1.74651431\n2  0.04438637 -1.0931046 -1.6531835  0.16061410 -0.8189961  0.97086902\n3  0.90278491 -1.6652432 -1.6210978  0.47403842 -1.3160896  0.09601604\n4 -1.43913020  0.5649023  0.1327513  0.08795883 -0.1807437  0.28630464\n5  1.22247841 -0.5909550 -0.9408635  0.24301336 -1.1006888  0.43423877\n6 -0.23405970  0.6319489  0.4099318  0.95167782  0.0260558 -0.36828486\n         X415        X416       X417       X418        X419      X420\n1 -0.31464116 -0.03408874 -0.4261391  0.1864975  0.03314677 0.9978521\n2  1.65901744  0.13254915 -1.5709843 -1.2349606 -0.23292367 0.8529964\n3  0.11454130  1.11030496 -0.9308138  1.1554112 -0.02010525 0.8532853\n4  0.97166849  0.62109213 -0.1591022  0.9791681 -0.51009004 1.5514834\n5  0.23782526  0.01415706  0.6352398  2.0099060  0.74669169 0.3149182\n6 -0.08817906 -1.88134326 -0.9600350 -0.8698395  1.88831183 0.4376121\n        X421       X422        X423        X424         X425       X426\n1  0.8867390 -1.9870597  0.88364255  1.28494621  0.036887367  1.0295426\n2 -0.6174300 -0.8449081  0.07181275  0.24125572 -0.165563417  1.4320928\n3 -0.9261755 -1.1044328 -0.34359740  2.05712438 -0.603007232 -1.6736166\n4 -0.2106208  0.1881720 -0.64568671  2.14075180 -0.002477638 -0.1189702\n5  0.1799286  1.0677618 -0.31208340 -0.75639272  0.348079981  0.3526233\n6  0.5746505 -1.4550378  1.36516379  0.05282368 -0.845183737  0.1307351\n        X427        X428       X429       X430        X431        X432\n1 -1.0897798  0.06218087 -1.3045502  0.2354085  0.01307210  0.32819593\n2 -0.2690354  0.36254613 -0.6286463 -1.0109436 -0.11320648  0.37611166\n3  1.4108417 -0.62130470 -0.8074471 -0.8413482 -1.14986181  1.04134544\n4 -0.1115349  0.66956311 -0.3799914 -0.2295317  0.66975843 -0.19013741\n5 -1.5671430  0.19004677  0.7541052 -0.1159036 -0.59898119 -0.09768456\n6 -0.1297694 -1.91718093 -0.6552661  0.7519689  0.07903449  0.84303915\n        X433       X434        X435       X436        X437        X438\n1  0.1261329 -0.1491568  1.09782817  0.4575669  0.03041141  0.05502952\n2 -0.2874669  1.0270765  1.57622602  0.5311822  0.93285314  0.28301687\n3 -0.6464526  0.2927421 -1.12461468  0.9309748 -0.14273951 -1.22728443\n4 -1.0657729  0.4587809 -0.08253081  0.1986685  0.14117240  0.92838937\n5  1.2256171  1.0913627 -0.70795247 -0.9732437 -1.40409535 -1.32044381\n6 -0.3358796 -1.0457828  0.12073357 -1.2700859  1.80596954 -1.06054369\n        X439       X440       X441       X442       X443       X444        X445\n1  0.5279505 -0.8844823  0.7036843 -0.9642098 -0.1855936 -0.6651548  1.05935376\n2  0.7806915  0.2568084 -0.4188411  0.3049241 -2.1397701  0.2297199 -0.37803085\n3  0.7277319  0.3208567  0.4378928 -0.1177297 -2.2287970  0.2662460 -0.07267747\n4 -0.7546459 -0.8091618 -0.4161442  0.1618181  0.7178123 -0.2711085  1.17133022\n5  0.7309864 -0.5735758  1.8639095  1.4505845  0.3451761  1.1517770  1.60337136\n6  0.9222819  0.4281205  0.5937853  1.1789051 -1.2061846  0.3806865  0.16410710\n         X446        X447       X448        X449       X450        X451\n1 -1.92327541  0.89247653 -0.8041796 -0.15919615 -0.8677556  0.57621669\n2 -0.08956945  0.06352228 -1.6049237  1.20175782 -0.1289268  1.59053113\n3 -1.07624675  1.64649930 -0.2425932  0.89693830  2.3759394 -0.34370524\n4  0.63894498  0.33229067  0.4197404 -0.56074029  0.1518852  0.06388693\n5 -1.23302981  1.62737712 -1.2056262 -1.09534743  0.6579691  0.13918880\n6  1.28905228 -0.40472943 -0.7629711 -0.03096749 -1.0433998  0.39649843\n          X452        X453        X454       X455       X456       X457\n1 -0.255372888  0.34431578  0.23038334  0.5195345  0.1972767  0.2955356\n2 -0.776462833  0.94796127  0.32481990 -0.5744037 -0.3766548  0.2644131\n3 -0.696333527  1.71384151 -1.21874620  1.6474487  0.4243452 -0.5464677\n4  0.006511168  0.06962589  0.34938730 -0.4115410 -0.6437741  0.5301697\n5  0.102410513 -0.69419290  0.03283215 -1.1338954 -1.3278535 -1.2042258\n6  0.958376344 -0.58785267 -0.32853916  1.2635216  1.1852992  1.1970984\n        X458       X459        X460       X461        X462         X463\n1 -0.1296074 -0.5173710 -1.37555900  1.5273047 -0.96582776  0.009622728\n2 -0.4502453 -0.5797969  1.53439995 -0.1762632  0.52164895 -0.086411289\n3 -0.6965367  0.6503352  0.29939281  0.2696162 -1.61029200  0.304898175\n4 -1.0466382 -0.8268885  0.87270164  1.3035887  1.54883252  0.629537767\n5 -0.9887430 -0.4274469  0.05403545  1.6130680  0.16495006  0.163637368\n6  1.4448522 -0.7818676 -0.53946354  0.5604135 -0.01268991  0.931688012\n        X464        X465       X466       X467        X468        X469\n1 -0.2671983  0.72596714 -1.8302643  1.2129492 -0.08097577 -0.09596902\n2  0.5959434  1.07746698 -0.5138139 -0.1679805  0.40693382 -0.28772923\n3  0.2638938  0.25384483  0.7672369 -1.4447008  0.44725190  0.93159125\n4 -0.7312211 -1.17046693 -0.7416912 -0.7667810 -0.12904931 -0.36201117\n5 -0.3987838  1.65301875 -0.7519411  0.9664978 -0.08604786 -0.17337150\n6 -0.4439675  0.07635799 -1.2956442 -0.2935853 -0.48671368  1.28101240\n        X470       X471        X472        X473       X474       X475\n1 -0.2596357  0.4005841  0.71714097 -1.49562230  0.1302817  1.5907335\n2  0.7109839  0.2583213  0.93294555  1.17093748 -0.8471864 -0.6619296\n3 -0.5064631 -0.9871341  0.53771119 -0.59948198 -0.1807843 -0.6652476\n4  0.8357236  0.7704763  0.68875956  0.49979319  1.4063207 -0.4441386\n5  0.7601489 -1.0477324 -0.03601021 -0.86038904 -0.8734961  0.9002325\n6 -1.4500009  1.2954132  0.42899264  0.00142834  0.8420792 -0.1485269\n        X476       X477       X478       X479       X480       X481       X482\n1  0.6225590  0.9388824  0.7614525  0.0448124 -0.3402981 -0.9855322  1.7523332\n2 -1.5167382 -0.4165655  2.0174326  0.8698309 -0.8992835  1.4526678 -0.6107770\n3  1.3281324  0.5647511 -1.9356871  0.0563960 -0.5898666  0.9603519  1.6191317\n4  0.4261930  0.3534310 -0.5874974 -0.3010351  1.2040407 -0.5643144  0.2277815\n5 -0.7925608 -0.7603383  0.1264851 -0.4889564  0.1674580 -1.0230177  0.7125603\n6 -0.6716173 -0.6083855 -1.1356278  0.5451951  0.3638537  0.2732675  0.3175679\n         X483        X484         X485       X486       X487       X488\n1 -0.71587103 -0.73244722  2.022740072  0.1740320  1.6427108  1.4843975\n2  0.02952983 -1.97144306  0.272920398 -0.7828876 -0.7665893 -0.6255450\n3  1.01696617 -0.72739727 -1.668998541  0.0666090 -0.7522234 -0.4951015\n4  0.18417091 -0.01833761 -1.714468463 -1.1078275  0.6102856 -1.2149053\n5  0.31089057  0.56753995  0.001356493  0.7527031 -0.2683066 -0.8849191\n6  0.98703545 -0.31057535 -0.276178232 -0.4662946  0.2271003 -0.4001802\n        X489       X490       X491       X492       X493       X494       X495\n1 -0.5070745 -1.1373917  1.2603510  1.1857326  0.1369634 -0.2727214 -2.0022729\n2 -0.9089089 -1.4364722  1.0281360 -0.2614403  1.2916145  1.8212424 -0.5779624\n3  1.5106809 -1.5393613 -0.7163903 -1.5396656  1.7794279  0.4325634  0.9125371\n4 -0.4913765 -1.3577591 -0.2880291  0.5899558  1.9757064  0.4223359 -1.1263400\n5 -1.6032686  0.9013469  0.3408199  0.4163312  1.9069163 -0.9239680  1.0834585\n6 -1.1390284 -0.4469514 -1.0843430  1.9525105 -2.0144259 -3.2903583  1.3522072\n         X496       X497        X498        X499        X500       X501\n1  0.59975839 -0.8567457 -0.75492916  0.70930056 -0.64057167 -0.8375768\n2 -0.74432625 -0.3997480  0.59820971 -0.74940927 -0.24039177 -0.2525353\n3  1.56808414 -0.5368456  0.52999822  0.15320619  0.06024457 -2.8456625\n4  0.49386227 -0.3847970  0.31684526  0.29590767 -0.42647522  0.4755854\n5  0.03232988  0.7127551  1.65293584 -0.78506492 -0.83616489 -1.3914541\n6 -0.26981545 -0.4792887 -0.03242111  0.06161832 -0.81678306  1.2699872\n        X502        X503\n1  0.9464548 -0.08433403\n2  1.1867247 -0.06471673\n3  1.3622842  0.23369964\n4 -0.1571266 -0.64863230\n5 -1.0219628  0.38729272\n6 -1.0477824  2.14758741\n```\n:::\n\n```{.r .cell-code}\ndim(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800 504\n```\n:::\n:::\n\n\n## Spliting data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidymodels)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ────────────────────────────────────── tidymodels 1.0.0 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ broom        1.0.3     ✔ rsample      1.1.1\n✔ dials        1.1.0     ✔ tibble       3.1.8\n✔ infer        1.0.4     ✔ tune         1.0.1\n✔ modeldata    1.1.0     ✔ workflows    1.1.3\n✔ parsnip      1.0.4     ✔ workflowsets 1.0.0\n✔ purrr        1.0.1     ✔ yardstick    1.1.0\n✔ recipes      1.0.5     \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ purrr::discard() masks scales::discard()\n✖ dplyr::filter()  masks stats::filter()\n✖ dplyr::lag()     masks stats::lag()\n✖ recipes::step()  masks stats::step()\n• Use tidymodels_prefer() to resolve common conflicts.\n```\n:::\n\n```{.r .cell-code}\nsplit<-initial_split(dat, prop = 0.7)\nsplit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<Training/Testing/Total>\n<560/240/800>\n```\n:::\n\n```{.r .cell-code}\ntrain <- training(split)\ntest <- testing(split)\n```\n:::\n\n\n## Preprocessing\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreproc <- recipe(y ~. , data=train) %>%\n  step_normalize(all_numeric_predictors()) %>%\n  step_pca(all_numeric_predictors(), num_comp = tune())\n```\n:::\n\n\n## Model specification & Tune Grid\n\nให้เป็นแบบฝึกหัดกับนิสิต\n\nนิสิตคิดว่า PCR มีข้อจำกัดหรือไม่ อย่างไร\n\n# PLS Regression\n\nPLS regression มี concept ที่เกือบจะเหมือน PCR regression แต่มีความแตกต่างกันดังรูปง\n\n![](images/image-377921756.png){width=\"460\"}\n\nการ fit pls regression สามารถทำได้ดังรูปด้านล่าง\n\n![](images/image-301907320.png){width=\"465\"}\n\n![](images/image-731878720.png){width=\"447\"}\n\n## กิจกรรม\n\nสร้างโมเดลทำนาย PLS regression โดยใช้ชุดข้อมูล PCR_PLS.csv เหมือนเดิม\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreproc <- recipe(y ~. , data= train) %>%\n  step_normalize(all_numeric_predictors())\n\npls_mod <- parsnip::pls(predictor_prop = tune(),\n               num_comp = tune()) %>%\n  set_engine(\"mixOmics\") %>%\n  set_mode(\"regression\")\n```\n:::\n",
    "supporting": [
      "07MoreRegs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}