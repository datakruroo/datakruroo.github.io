{"title":"การบ้าน 2","markdown":{"headingText":"การบ้าน 2","containsRefs":false,"markdown":"\n## การพัฒนา regression model ด้วย tidymodel framework\n\n1.  นำเข้าข้อมูลจากไฟล์ [`TeacherSalaryData.csv`](https://github.com/ssiwacho/2758688_ML/blob/main/week%201/TeacherSalaryData.csv)\n2.  สำรวจข้อมูลจากชุดข้อมูลดังกล่าว แล้วตอบคำถาม\n    -   ชุดข้อมูลนี้มีตัวแปรทั้งหมดกี่ตัว\n\n    -   มีหน่วยข้อมูลทั้งหมดกี่หน่วย\n\n    -   หาค่าสถิติพื้นฐานของตัวแปรเชิงปริมาณในชุดข้อมูล\n\n    -   อาจารย์มหาวิทยาลัยส่วนใหญ่มีตำแหน่งวิชาการอะไร\n3.  แบ่งส่วนข้อมูลที่นำเข้าออกเป็นสองส่วน ได้แก่ training และ test dataset โดยกำหนดให้สัดส่วนระหว่างชุดข้อมูลทั้งหมดเป็น 80 : 20\n4.  กำหนดให้ตัวแปรตามคือ `salary` (เงินเดือนของอาจารย์มหาวิทยาลัย) ลองพัฒนา supervised learning model 2 โมเดล โดยตัวแรกให้ใช้ linear regression model ที่ใช้ lm เป็น engine และตัวที่สองให้ใช้ decision tree ที่ใช้ rpart เป็น engine ทั้งนี้ให้ใช้ตัวแปรอิสระทุกตัวในชุดข้อมูลเป็นตัวแปรทำนาย\n5.  เปรียบเทียบประสิทธิภาพในการทำนายของโมเดลทั้งสอง ผลที่ได้เป็นอย่างไร\n\n```{r fig.height=9, echo=F, eval=F}\ndat<-read.csv(\"https://raw.githubusercontent.com/ssiwacho/2758688_ML/main/week%201/TeacherSalaryData.csv\")\ndat<-dat[,-1]\nstr(dat)\nhist(dat$salary)\nlibrary(tidymodels)\n## data partition\npar<-initial_split(data= dat, prop=0.8, strata = salary, breaks=10)\ntrain<-par%>%training()\ntest<-par%>%testing()\n\n## model specification\n### regression model\nreg <- linear_reg()%>%\n                set_engine(\"lm\")%>%\n                  set_mode(\"regression\")\n\ntree<-decision_tree()%>%\n        set_engine(\"rpart\")%>%\n                  set_mode(\"regression\")\n\nrf<-rand_forest()%>%\n        set_engine(\"ranger\")%>%\n                  set_mode(\"regression\")\n\n## processing\nfit_reg <- reg %>% fit(log(salary) ~. ,data = train)\nfit_tree<-tree %>% fit(log(salary) ~. ,data = train)\nfit_rf<-tree %>% fit(log(salary) ~. ,data = train)\n\n## prediction\npred_reg<-predict(fit_reg, new_data = test)\npred_tree<-predict(fit_tree, new_data=test)\npred_rf<-predict(fit_rf, new_data=test)\ntest<-test%>%bind_cols(pred_reg, pred_tree, pred_rf)\nnames(test)[7:9]<-c(\"pred_reg\",\"pred_tree\",\"pred_rf\")\nhead(test)\n\n## evaluation\n\ntest %>% rmse(truth=salary, estimate=exp(pred_reg))\ntest %>% rmse(truth=salary,  estimate=exp(pred_tree))\ntest %>% rmse(truth=salary,  estimate=exp(pred_rf))\n\ntest %>% rsq(truth=salary, estimate=exp(pred_reg))\ntest %>% rsq(truth=salary, estimate=exp(pred_tree))\ntest %>% rsq(truth=salary,  estimate=exp(pred_rf))\n\np1<-test %>% ggplot()+\n  geom_point(aes(x=salary, y=exp(pred_reg)))+\n  geom_abline(intercept=0, slope=1)\n\np2<-test %>% ggplot()+\n  geom_point(aes(x=salary, y=exp(pred_tree)))+\n    geom_abline(intercept=0, slope=1)\n\np3<-test %>% ggplot()+\n  geom_point(aes(x=salary, y=exp(pred_rf)))+\n    geom_abline(intercept=0, slope=1)\n\ngrid.arrange(p1,p2,p3, nrow=3)\n\n```\n\n## \n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"hw02.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","urlcolor":"steelblue","linkcolor":"steelblue","theme":{"light":["pandoc","../theme.scss"]},"mainfont":"Krub","code-copy":true},"extensions":{"book":{"multiFile":true}}}}}