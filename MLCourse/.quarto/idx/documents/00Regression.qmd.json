{"title":"Simple Regression Analysis","markdown":{"yaml":{"title":"Simple Regression Analysis","author":"ผศ.ดร.สิวะโชติ ศรีสุทธิยากร","toc":true,"toc-depth":3,"toc-title":"สารบัญ","theme":"default"},"containsRefs":false,"markdown":"\n\n```{r}\nlibrary(dplyr)\nlibrary(tidymodels)\ndat <- read.csv(\"Math.csv\")\nglimpse(dat, width=50)\n\nrec <- recipe(Ach~., data=dat) %>%\n  step_string2factor(all_nominal_predictors()) %>%\n  step_mutate(MomEdu = factor(MomEdu, levels=c(0,1,2,3,4),\n         labels=c(\"none\",\"primary\",\"highsch1\",\"highsch2\",\"grad\")),\n         DadEdi = factor(DadEdi, levels=c(0,1,2,3,4),\n         labels=c(\"none\",\"primary\",\"highsch1\",\"highsch2\",\"grad\")),\n         traveltime = factor(traveltime, levels=c(1,2,3,4),\n                             labels=c(\"<15mins\",\n                                      \"15-30mins\",\n                                      \"30-60mins\",\n                                      \">60mins\")),\n         readingtime = factor(readingtime, levels=c(1,2,3,4),\n                              labels=c(\"<2hours\",\n                                       \"2-5hours\",\n                                       \"5-10hours\",\n                                       \">10hours\")),\n         fam_relation = factor(fam_relation, levels=c(1,2,3,4,5),\n                               labels=c(\"worst\",\n                                        \"bad\",\n                                        \"fair\",\n                                        \"good\",\n                                        \"very good\")),\n         freetime = factor(freetime, levels=c(1,2,3,4,5),\n                           labels=c(\"very little\",\n                                    \"litter\",\n                                    \"moderate\",\n                                    \"high\",\n                                    \"highest\")),\n         goout = factor(goout, levels=c(1,2,3,4,5),\n                           labels=c(\"very little\",\n                                    \"litter\",\n                                    \"moderate\",\n                                    \"high\",\n                                    \"highest\")),\n         Drink_alc = factor(Drink_alc, levels=c(1,2,3,4,5),\n                            labels=c(\"very little\",\n                                    \"litter\",\n                                    \"moderate\",\n                                    \"high\",\n                                    \"highest\")),\n         health = factor(health, levels=c(1,2,3,4,5),\n                         labels=c(\"worst\",\n                                        \"bad\",\n                                        \"fair\",\n                                        \"good\",\n                                        \"very good\"))\n  )\n\n\ntemp1 <- rec %>%\n  prep(NULL) %>%\n  juice()\n\nglimpse(rec, width=50 )\n\ntemp2<- rec %>%\n  step_normalize(all_numeric()) %>%\n  prep(NULL) %>%\n  juice()\n\nfit <- lm(Ach~., data=temp1)\nsummary(fit)$coefficients %>% data.frame() %>%\n  arrange(desc(abs(t.value)))\n\n\ntemp1 %>%\n  filter(Ach>0)->temp1\n\nfit <- lm(Ach~., data=temp1)\nsummary(fit)$coefficients %>% data.frame() %>%\n  arrange(desc(abs(t.value)))\n\nplot(fit)\nlibrary(car)\n\n```\n\n```{r}\nfit2<-lm(Ach~., data=temp2)\nsummary(fit2)$coefficients %>% data.frame() %>%\n  arrange(desc(abs(t.value))) %>% round(2)\n\nplot(fit2)\n```\n\n```{r}\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"output-file":"00Regression.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","editor":"visual","urlcolor":"steelblue","linkcolor":"steelblue","theme":{"light":["pandoc","../theme.scss"]},"mainfont":"Krub","code-copy":true,"title":"Simple Regression Analysis","author":"ผศ.ดร.สิวะโชติ ศรีสุทธิยากร","toc-title":"สารบัญ"},"extensions":{"book":{"multiFile":true}}}}}