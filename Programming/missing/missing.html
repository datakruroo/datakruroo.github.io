<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Missing value analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="missing_files/libs/clipboard/clipboard.min.js"></script>
<script src="missing_files/libs/quarto-html/quarto.js"></script>
<script src="missing_files/libs/quarto-html/popper.min.js"></script>
<script src="missing_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="missing_files/libs/quarto-html/anchor.min.js"></script>
<link href="missing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="missing_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="missing_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="missing_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="missing_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#สาเหตของการสญหายของขอมล" id="toc-สาเหตของการสญหายของขอมล" class="nav-link active" data-scroll-target="#สาเหตของการสญหายของขอมล"><span class="header-section-number">1</span> สาเหตุของการสูญหายของข้อมูล</a></li>
  <li><a href="#ประเภทของคาสญหาย" id="toc-ประเภทของคาสญหาย" class="nav-link" data-scroll-target="#ประเภทของคาสญหาย"><span class="header-section-number">2</span> ประเภทของค่าสูญหาย</a>
  <ul>
  <li><a href="#ขอมลสญหายจากการเกบขอมลหรอการจดกระทำขอมลไมเหมาะสม" id="toc-ขอมลสญหายจากการเกบขอมลหรอการจดกระทำขอมลไมเหมาะสม" class="nav-link" data-scroll-target="#ขอมลสญหายจากการเกบขอมลหรอการจดกระทำขอมลไมเหมาะสม"><span class="header-section-number">2.1</span> ข้อมูลสูญหายจากการเก็บข้อมูลหรือการจัดกระทำข้อมูลไม่เหมาะสม</a></li>
  <li><a href="#ขอมลสญหายจากปรากฏการณสม" id="toc-ขอมลสญหายจากปรากฏการณสม" class="nav-link" data-scroll-target="#ขอมลสญหายจากปรากฏการณสม"><span class="header-section-number">2.2</span> ข้อมูลสูญหายจากปรากฏการณ์สุ่ม</a>
  <ul>
  <li><a href="#การสญหายแบบสมสมบรณ-missing-completely-at-random-mcar" id="toc-การสญหายแบบสมสมบรณ-missing-completely-at-random-mcar" class="nav-link" data-scroll-target="#การสญหายแบบสมสมบรณ-missing-completely-at-random-mcar"><span class="header-section-number">2.2.1</span> การสูญหายแบบสุ่มสมบูรณ์ (missing completely at random: MCAR)</a></li>
  <li><a href="#การสญหายแบบสม-missing-at-random-mar" id="toc-การสญหายแบบสม-missing-at-random-mar" class="nav-link" data-scroll-target="#การสญหายแบบสม-missing-at-random-mar"><span class="header-section-number">2.2.2</span> การสูญหายแบบสุ่ม (missing at random: MAR)</a></li>
  </ul></li>
  <li><a href="#ขอมลสญหายจากสาเหตเฉพาะ" id="toc-ขอมลสญหายจากสาเหตเฉพาะ" class="nav-link" data-scroll-target="#ขอมลสญหายจากสาเหตเฉพาะ"><span class="header-section-number">2.3</span> ข้อมูลสูญหายจากสาเหตุเฉพาะ</a></li>
  </ul></li>
  <li><a href="#การวเคราะหขอมลทมคาสญหาย" id="toc-การวเคราะหขอมลทมคาสญหาย" class="nav-link" data-scroll-target="#การวเคราะหขอมลทมคาสญหาย"><span class="header-section-number">3</span> การวิเคราะห์ข้อมูลที่มีค่าสูญหาย</a>
  <ul>
  <li><a href="#การระบ-สำรวจและวเคราะหกลไกการสญหาย" id="toc-การระบ-สำรวจและวเคราะหกลไกการสญหาย" class="nav-link" data-scroll-target="#การระบ-สำรวจและวเคราะหกลไกการสญหาย"><span class="header-section-number">3.1</span> การระบุ สำรวจและวิเคราะห์กลไกการสูญหาย</a>
  <ul>
  <li><a href="#tabulating-missing-data" id="toc-tabulating-missing-data" class="nav-link" data-scroll-target="#tabulating-missing-data"><span class="header-section-number">3.1.1</span> Tabulating Missing data</a></li>
  <li><a href="#visualization-for-missing-data" id="toc-visualization-for-missing-data" class="nav-link" data-scroll-target="#visualization-for-missing-data"><span class="header-section-number">3.1.2</span> Visualization for Missing data</a>
  <ul class="collapse">
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap"><span class="header-section-number">3.1.2.1</span> Heatmap</a></li>
  <li><a href="#co-occurence-plot" id="toc-co-occurence-plot" class="nav-link" data-scroll-target="#co-occurence-plot"><span class="header-section-number">3.1.2.2</span> co-occurence plot</a></li>
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot"><span class="header-section-number">3.1.2.3</span> Scatter plot</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#การสำรวจคาสญหายสำหรบขอมลขนาดใหญ" id="toc-การสำรวจคาสญหายสำหรบขอมลขนาดใหญ" class="nav-link" data-scroll-target="#การสำรวจคาสญหายสำหรบขอมลขนาดใหญ"><span class="header-section-number">3.2</span> การสำรวจค่าสูญหายสำหรับข้อมูลขนาดใหญ่</a>
  <ul>
  <li><a href="#การวเคราะหองคประกอบหลกของคาสญหาย" id="toc-การวเคราะหองคประกอบหลกของคาสญหาย" class="nav-link" data-scroll-target="#การวเคราะหองคประกอบหลกของคาสญหาย"><span class="header-section-number">3.2.1</span> การวิเคราะห์องค์ประกอบหลักของค่าสูญหาย</a></li>
  <li><a href="#correlation-of-missing-value" id="toc-correlation-of-missing-value" class="nav-link" data-scroll-target="#correlation-of-missing-value"><span class="header-section-number">3.2.2</span> Correlation of Missing Value</a></li>
  <li><a href="#regression-of-missing-values" id="toc-regression-of-missing-values" class="nav-link" data-scroll-target="#regression-of-missing-values"><span class="header-section-number">3.2.3</span> Regression of Missing Values</a>
  <ul class="collapse">
  <li><a href="#using-linear-regression" id="toc-using-linear-regression" class="nav-link" data-scroll-target="#using-linear-regression"><span class="header-section-number">3.2.3.1</span> Using Linear Regression</a></li>
  <li><a href="#using-logistic-regression" id="toc-using-logistic-regression" class="nav-link" data-scroll-target="#using-logistic-regression"><span class="header-section-number">3.2.3.2</span> Using Logistic Regression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#การแกปญหาคาสญหาย" id="toc-การแกปญหาคาสญหาย" class="nav-link" data-scroll-target="#การแกปญหาคาสญหาย"><span class="header-section-number">3.3</span> การแก้ปัญหาค่าสูญหาย</a>
  <ul>
  <li><a href="#simple-imputation" id="toc-simple-imputation" class="nav-link" data-scroll-target="#simple-imputation"><span class="header-section-number">3.3.1</span> Simple imputation</a></li>
  <li><a href="#donor-based-imputation" id="toc-donor-based-imputation" class="nav-link" data-scroll-target="#donor-based-imputation"><span class="header-section-number">3.3.2</span> Donor-based imputation</a>
  <ul class="collapse">
  <li><a href="#random-hot-deck-imputation" id="toc-random-hot-deck-imputation" class="nav-link" data-scroll-target="#random-hot-deck-imputation"><span class="header-section-number">3.3.2.1</span> Random Hot-Deck imputation</a></li>
  <li><a href="#conditional-hot-deck-imputation" id="toc-conditional-hot-deck-imputation" class="nav-link" data-scroll-target="#conditional-hot-deck-imputation"><span class="header-section-number">3.3.2.2</span> Conditional Hot-Deck imputation</a></li>
  <li><a href="#กจกรรม" id="toc-กจกรรม" class="nav-link" data-scroll-target="#กจกรรม"><span class="header-section-number">3.3.2.3</span> กิจกรรม</a></li>
  <li><a href="#knn-imputation" id="toc-knn-imputation" class="nav-link" data-scroll-target="#knn-imputation"><span class="header-section-number">3.3.2.4</span> KNN imputation</a></li>
  </ul></li>
  <li><a href="#model-based-imputation" id="toc-model-based-imputation" class="nav-link" data-scroll-target="#model-based-imputation"><span class="header-section-number">3.3.3</span> Model-Based Imputation</a>
  <ul class="collapse">
  <li><a href="#chain-imputation-algorithm" id="toc-chain-imputation-algorithm" class="nav-link" data-scroll-target="#chain-imputation-algorithm"><span class="header-section-number">3.3.3.1</span> Chain-Imputation Algorithm</a></li>
  <li><a href="#em-algorithm" id="toc-em-algorithm" class="nav-link" data-scroll-target="#em-algorithm"><span class="header-section-number">3.3.3.2</span> EM-algorithm</a></li>
  </ul></li>
  <li><a href="#multiple-imputation" id="toc-multiple-imputation" class="nav-link" data-scroll-target="#multiple-imputation"><span class="header-section-number">3.3.4</span> Multiple Imputation</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Missing value analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>ข้อมูลสูญหาย (missing values) เป็นปัญหาที่พบได้ทั่วไปทั้งในการวิจัย หลายกรณีที่ค่าสูญหายส่งผลกระทบเชิงลบต่อผลการวิเคราะห์ ทำให้ผลการวิเคราะห์ที่ได้เช่น ผลการประมาณค่าพารามิเตอร์ การทดสอบสมมุติฐาน ช่วงความเชื่อมั่น หรือค่าทำนายมีแนวโน้มคลาดเคลื่อนไปจากความเป็นจริง ดังนั้นการจัดการกับข้อมูลสูญหายอย่างเหมาะสมจึงเป็นสิ่งจำเป็นในการวิเคราะห์ข้อมูล ทั้งนี้เพื่อรับประกันว่าผลการวิเคราะห์ที่ได้จะปราศจากหรือมีความลำเอียงน้อยที่สุด</p>
<p>สาเหตุการสูญหายของข้อมูลเป็นไปได้อย่างหลากหลาย ทั้งการจงใจหรือลืมที่จะให้ข้อมูลของกลุ่มเป้าหมาย ความผิดพลาดในการบันทึกข้อมูล อุปสรรคอื่น ๆ ในการให้ข้อมูล ไปจนถึงการออกแบบการเก็บรวบรวมและจัดกระทำข้อมูล อย่างไรก็ตามไม่ว่าสาเหตุจะเป็นอะไรอาจจัดกลุ่มสาเหตุดังกล่าวได้เป็น 3 ด้านคือ สาเหตุด้านผู้ให้ข้อมูล ด้านเครื่องมือที่ใช้วัดค่าสังเกตหรือเก็บรวบรวมข้อมูล และด้านการเก็บรวบรวมและการจัดกระทำข้อมูลของผู้วิจัย/ผู้วิเคราะห์</p>
<section id="สาเหตของการสญหายของขอมล" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="สาเหตของการสญหายของขอมล"><span class="header-section-number">1</span> สาเหตุของการสูญหายของข้อมูล</h2>
<p>การสูญหายของข้อมูลเป็นไปได้จากสาเหตุที่หลากหลาย ขึ้นอยู่กับบริบทและวิธีการเก็บรวบรวมข้อมูลที่ผู้วิจัยใช้ด้วย โดยรวมอาจจำแนกสาเหตุการสูญหายของข้อมูลได้เป็นดังนี้</p>
<p><strong>1. สาเหตุจากผู้ให้ข้อมูลหรือวิธีการวัดค่าสังเกต</strong> ซึ่งเป็นไปได้หลากหลายลักษณะ เช่น ในการวิจัยเชิงสำรวจที่มีการเก็บรวบรวมข้อมูลด้วยแบบสอบถามหรือแบบวัด มีความเป็นไปได้ที่ผู้ตอบอาจลืมตอบคำถามในบางข้อ หรือเลือกที่จะไม่ตอบเพราะไม่มีความรู้ หรือไม่สนใจที่จะให้ข้อมูล หรืออาจมีความสะดวกในการตอบคำถาม ปัจจัยดังกล่าวล้วนเป็นสาเหตุที่ทำให้เกิดค่าสูญหายทั้งสิ้น</p>
<p>อีกลักษณะหนึ่งคือการขาดหายไปจากการที่หน่วยข้อมูลบางหน่วยไม่ได้เข้าร่วมกิจกรรมที่กำหนดไว้สำหรับการเก็บรวบรวมข้อมูล เช่น การออกแบบการเก็บรวบรวมข้อมูลในชั้นเรียน หรือเป็นการบ้านให้กับนักเรียน แต่อาจมีนักเรียนบางคนที่ไม่ได้เข้าเรียนในวันดังกล่าว หรือไม่ส่งการบ้าน สถานการณ์ดังกล่าวทำให้เกิดค่าสูญหายได้เช่นเดียวกัน</p>
<p>ความผิดพลาดของอุปกรณ์วัดก็เป็นปัจจัยในด้านนี้ด้วย เช่น ผู้วิจัยอาจเลือกใช้ smart watch เป็นเครื่องมือในการวัดชีพจร และตัวชี้วัดทางกายภาพของผู้เรียนระหว่างการจัดการเรียนรู้ อาจมีความเป็นไปได้ที่ผู้เรียนบางคนไม่ได้ใส่อุปกรณ์อย่างถูกต้อง หรืออุปกรณ์ทำงานผิดพลาดจากสาเหตุอื่น ๆ ทำให้ไม่สามารถเก็บรวบรวมข้อมูลได้อย่างครบถ้วน</p>
<p>การสูญหายที่เกี่ยวข้องในประเด็นนี้อาจเกิดจากอุปสรรคในการเข้าถึงสื่อหรือเครื่องมือที่การเก็บรวบรวมข้อมูลด้วย เช่น ผู้วิเคราะห์อาจออกแบบการเก็บรวบรวมข้อมูลโดยใช้การตอบแบบสอบถามบน google form หรือ application อื่นที่ต้องใช้อุปกรณ์คอมพิวเตอร์หรือ smart device ในการเข้าถึง แต่หากช่วงเวลาที่ดำเนินการเก็บรวบรวมข้อมูล หน่วยข้อมูลไม่มีอุปกรณ์หรือ internet หรือมีอุปสรรคที่ไม่สามารถเข้าถึงแบบสอบถามดังกล่าวได้ ก็อาจเป็นสาเหตุที่ทำให้เกิดค่าสูญหายได้เช่นเดียวกัน</p>
<p><strong>2. สาเหตุจากการยุบรวมข้อมูลจากแหล่งข้อมูลที่หลากหลาย</strong> การวิเคราะห์ข้อมูลโดยเฉพาะในโครงการที่ใช้ฐานข้อมูลทุติยภูมิในปัจจุบัน มักจะต้องมีการเชื่อมโยงหรือรวมข้อมูลระหว่างฐาน ทั้งการเชื่อมโยงตามแนวคอลัมน์เพื่อให้ได้ข้อมูลคุณลักษณะหรือตัวแปรของหน่วยข้อมูลที่มีความสมบูรณ์ หรือการเชื่อมโยงตามแนวแถวเพื่อให้ได้หน่วยข้อมูลที่ครอบคลุมหรือเป็นตัวแทนของกลุ่มเป้าหมาย อย่างไรก็ตามการเชื่อมโยงข้อมูลจากหลายฐานข้อมูลมีโอกาสที่จะเกิดค่าสูญหายอันเนื่องมาจากรูปแบบหรือระบบบันทึกเก็บข้อมูลระหว่างฐานที่แตกต่างกัน เช่น</p>
<p>ความแตกต่างในรูปแบบของรหัสที่จะใช้เชื่อมโยง กล่าวคือในฐานข้อมูลหนึ่งอาจะใช้รูปแบบรหัสบ่งชี้หน่วยข้อมูลเป็นรูปแบบหนึ่ง แต่อีกฐานข้อมูลหนึ่งใช้อีกรูปแบบหนึ่ง ลักษณะนี้ทำให้การเชื่อมโยงข้อมูลจากฐานข้อมูลทั้งสองไม่สามารถทำได้จากรหัสบ่งชี้หน่วยข้อมูล แต่จะต้องเลี่ยงไปใช้ข้อมูลของตัวแปรอื่น ๆ เข้ามาช่วย ซึ่งอาจทำให้ไม่สามารถเชื่อมโยงข้อมูลทั้งสองฐานได้อย่างสมบูรณ์</p>
<p>รูปแบบการจัดเก็บข้อมูลที่แตกต่างกัน เช่น ฐานข้อมูลหนึ่งบันทึกวันที่ในรูปแบบ DD/MM/YYYY แต่อีกฐานหนึ่งอาจบันทึกในรูปแบบ MM/DD/YYYY หากมีการใช้ข้อมูลวันที่เป็นตัวแปรหนึ่งที่เชื่อมโยงฐานข้อมูลเข้ากัน จะทำให้ผลลัพธ์ที่ได้เป็นค่าสูญหาย เพราะไม่สามารถเชื่อมโยงฐานทั้งสองเข้าด้วยกันได้</p>
<p>ความไม่สอดคล้องของข้อมูลในตัวแปรเดียวกัน เช่น ฐานข้อมูลด้านการศึกษาหนึ่งอาจบันทึกสถานะของนักเรียนเป็น “จบการศึกษา” หรือ “ยังศึกษาอยู่” ขณะที่อีกฐานข้อมูลอาจใช้คำว่า “สำเร็จการศึกษา” หรือ “ลงทะเบียนเรียน” ความแตกต่างในคำอธิบายเหล่านี้อาจทำให้เกิดความสับสนหรือข้อมูลสูญหายเมื่อต้องเชื่อมโยงกัน ซึ่งอาจทำให้ผลลัพธ์ที่ได้มีการตัดค่าที่เป็นปัญหานี้ออกไปเกิดเป็นค่าสูญหาย</p>
<p>การขาดข้อมูลในฐานข้อมูลบางส่วน อาจเกิดขึ้นโดยเฉพาะในการรวมข้อมูลตามแถว กล่าวคือ ฐานข้อมูลหนึ่งอาจมีข้อมูลของโรงเรียนที่สังกัดเขตพื้นที่หนึ่งในด้านต่าง ๆ อย่างครบถ้วน แต่เมื่อเชื่อมโยงฐานข้อมูลนี้กับเขตพื้นที่อื่นที่อาจมีข้อมูลไม่สมบูรณ์ในบางตัวแปร ผลลัพธ์ที่ได้จะได้ชุดข้อมูลที่มีค่าสูญหายในตัวแปรดังกล่าว</p>
<p><strong>3. การเก็บรวบรวมข้อมูลระยะยาว</strong> การเก็บรวบรวมข้อมูลระยะยาวที่ต้องเก็บข้อมูลจากหน่วยข้อมูลเดียวกันหลาย ๆ ครั้ง หากระหว่างทางมีหน่วยข้อมูลออกจากระบบ เช่น ผู้ตอบแบบสอบถามหรือผู้เข้าร่วมการศึกษาไม่สามารถเข้าร่วมการเก็บข้อมูลในช่วงใดช่วงหนึ่งได้ อาจเป็นเพราะย้ายถิ่นฐาน, เปลี่ยนสถานะ, หรือเลิกเข้าร่วมการศึกษา สิ่งนี้จะทำให้เกิดการสูญหายของข้อมูลในช่วงเวลานั้นได้ ข้อมูลขาดหายตามเวลา (attrition) เป็นปัญหาสำคัญในงานวิจัยระยะยาว เพราะอาจทำให้ความต่อเนื่องของข้อมูลไม่สมบูรณ์ และทำให้ผลลัพธ์ที่ได้จากการวิเคราะห์ไม่สะท้อนความเป็นจริงทั้งหมดของหน่วยข้อมูลที่ตั้งใจศึกษา</p>
<p>นอกจากนี้หากการออกกลางคันของผู้ให้ข้อมูลนี้เกิดขึ้นอย่างเป็นระบบ เช่น ผู้เข้าร่วมจากกลุ่มใดกลุ่มหนึ่งออกจากระบบมากกว่ากลุ่มอื่น อาจทำให้เกิดอคติในผลการวิเคราะห์ (attrition bias) ซึ่งจำเป็นที่จะต้องได้รับการจัดการก่อนเพื่อปรับปรุงผลการวิเคราะห์ให้มีความแม่นยำ และน่าเชื่อถือมากขึ้น</p>
</section>
<section id="ประเภทของคาสญหาย" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="ประเภทของคาสญหาย"><span class="header-section-number">2</span> ประเภทของค่าสูญหาย</h2>
<p>การจำแนกประเภทของค่าสูญหายสามารถจำแนกได้หลายลักษณะ ขึ้นกับบริบทที่ทำการวิเคราะห์ค่าสูญหาย หรือเกณฑ์ที่ใช้ในการพิจารณา โดยทั่วไปอาจจำแนกค่าสูญหายออกเป็น 3 ประเภท ได้แก่ (1) ข้อมูลสูญหายจากการเก็บข้อมูลหรือการจัดกระทำข้อมูลไม่เหมาะสม (2) ข้อมูลสูญหายจากปรากฏการณ์สุ่ม และ (3) ข้อมูลสูญหายจากสาเหตุเฉพาะ รายละเอียดมีดังนี้</p>
<section id="ขอมลสญหายจากการเกบขอมลหรอการจดกระทำขอมลไมเหมาะสม" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="ขอมลสญหายจากการเกบขอมลหรอการจดกระทำขอมลไมเหมาะสม"><span class="header-section-number">2.1</span> ข้อมูลสูญหายจากการเก็บข้อมูลหรือการจัดกระทำข้อมูลไม่เหมาะสม</h3>
<p>การวิเคราะห์การเรียนรู้ของนักเรียน ผู้วิเคราะห์อาจมีการออกแบบการเก็บรวบรวมข้อมูล<strong>การมาเรียนของนักเรียน</strong> โดยมีการบันทึกข้อมูลไว้ 2 ลักษณะ ได้แก่ มาเรียนตรงเวลา (<code>ontime</code>) และมาเรียนสาย (<code>late</code>) แต่เมื่อเก็บรวบรวมข้อมูลเสร็จพบว่ามีนักเรียนบางคนไม่มีข้อมูลในตัวแปรนี้ซึ่งทำให้กลายเป็นค่าสูญหาย อย่างไรก็ตามเมื่อพิจารณาเพิ่มเติมพบว่า นักเรียนกลุ่มที่ไม่มีข้อมูลนี้เป็นนักเรียนที่ไม่ได้มาเรียนในวันที่เก็บรวบรวมข้อมูล ทำให้ไม่สามารถระบุได้ว่ามาตรงเวลาหรือมาสาย สภาพดังกล่าวสะท้อนว่าตัวแปรการมาเรียนของนักเรียนที่มีค่าสังเกตเพียง 2 ค่าดังกล่าวไม่เพียงพอ การแก้ปัญหาดังกล่าวสามารถทำได้ด้วยการจัดการข้อมูลใหม่ โดยปรับโครงการของตัวแปรใหม่ ให้มีค่าที่เป็นไปได้ 3 ค่า อีกค่าหนึ่งที่เพิ่มขึ้นมาคือ นักเรียนที่ไม่ได้มาเรียน (<code>absent</code>) จะทำให้ตัวแปรนี้มีข้อมูลที่สมบูรณ์</p>
<p>การวิเคราะห์ข้อมูลโดยเฉพาะในโครงการที่ใช้ฐานข้อมูลทุติยภูมิในปัจจุบัน มักจะต้องมีการเชื่อมโยงหรือรวมข้อมูลระหว่างฐาน ทั้งการเชื่อมโยงตามแนวคอลัมน์เพื่อให้ได้ข้อมูลคุณลักษณะหรือตัวแปรของหน่วยข้อมูลที่มีความสมบูรณ์ หรือการเชื่อมโยงตามแนวแถวเพื่อให้ได้หน่วยข้อมูลที่ครอบคลุมหรือเป็นตัวแทนของกลุ่มเป้าหมาย อย่างไรก็ตามการเชื่อมโยงข้อมูลจากหลายฐานข้อมูลมีโอกาสที่จะเกิดค่าสูญหายอันเนื่องมาจากรูปแบบหรือระบบบันทึกเก็บข้อมูลระหว่างฐานที่แตกต่างกัน เช่น</p>
<ul>
<li><p>ความแตกต่างในรูปแบบของรหัสที่จะใช้เชื่อมโยง กล่าวคือในฐานข้อมูลหนึ่งอาจะใช้รูปแบบรหัสบ่งชี้หน่วยข้อมูลเป็นรูปแบบหนึ่ง แต่อีกฐานข้อมูลหนึ่งใช้อีกรูปแบบหนึ่ง ลักษณะนี้ทำให้การเชื่อมโยงข้อมูลจากฐานข้อมูลทั้งสองไม่สามารถทำได้จากรหัสบ่งชี้หน่วยข้อมูล แต่จะต้องเลี่ยงไปใช้ข้อมูลของตัวแปรอื่น ๆ เข้ามาช่วย ซึ่งอาจทำให้ไม่สามารถเชื่อมโยงข้อมูลทั้งสองฐานได้อย่างสมบูรณ์</p></li>
<li><p>รูปแบบการจัดเก็บข้อมูลที่แตกต่างกัน เช่น ฐานข้อมูลหนึ่งบันทึกวันที่ในรูปแบบ DD/MM/YYYY แต่อีกฐานหนึ่งอาจบันทึกในรูปแบบ MM/DD/YYYY หากมีการใช้ข้อมูลวันที่เป็นตัวแปรหนึ่งที่เชื่อมโยงฐานข้อมูลเข้ากัน จะทำให้ผลลัพธ์ที่ได้เป็นค่าสูญหาย เพราะไม่สามารถเชื่อมโยงฐานทั้งสองเข้าด้วยกันได้</p></li>
<li><p>ความไม่สอดคล้องของข้อมูลในตัวแปรเดียวกัน เช่น ฐานข้อมูลด้านการศึกษาหนึ่งอาจบันทึกสถานะของนักเรียนเป็น “จบการศึกษา” หรือ “ยังศึกษาอยู่” ขณะที่อีกฐานข้อมูลอาจใช้คำว่า “สำเร็จการศึกษา” หรือ “ลงทะเบียนเรียน” ความแตกต่างในคำอธิบายเหล่านี้อาจทำให้เกิดความสับสนหรือข้อมูลสูญหายเมื่อต้องเชื่อมโยงกัน ซึ่งอาจทำให้ผลลัพธ์ที่ได้มีการตัดค่าที่เป็นปัญหานี้ออกไปเกิดเป็นค่าสูญหาย</p></li>
<li><p>การขาดข้อมูลในฐานข้อมูลบางส่วน อาจเกิดขึ้นโดยเฉพาะในการรวมข้อมูลตามแถว กล่าวคือ ฐานข้อมูลหนึ่งอาจมีข้อมูลของโรงเรียนที่สังกัดเขตพื้นที่หนึ่งในด้านต่าง ๆ อย่างครบถ้วน แต่เมื่อเชื่อมโยงฐานข้อมูลนี้กับเขตพื้นที่อื่นที่อาจมีข้อมูลไม่สมบูรณ์ในบางตัวแปร ผลลัพธ์ที่ได้จะได้ชุดข้อมูลที่มีค่าสูญหายในตัวแปรดังกล่าว</p></li>
</ul>
</section>
<section id="ขอมลสญหายจากปรากฏการณสม" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="ขอมลสญหายจากปรากฏการณสม"><span class="header-section-number">2.2</span> ข้อมูลสูญหายจากปรากฏการณ์สุ่ม</h3>
<p>การสูญหายในลักษณะที่สองคือการสูญหายจากปรากฏการณ์สุ่ม เรียกได้ว่าเป็นการสูญหายในเชิงสถิติ <span class="citation" data-cites="little2014statistical">(<a href="#ref-little2014statistical" role="doc-biblioref">Little and Rubin 2014</a>)</span> โดยสามารถจำแนกได้เป็น 2 ประเภทได้แก่ การสูญหายแบบสุ่มสมบูรณ์ และการสูญหายแบบสุ่ม รายละเอียดมีดังนี้</p>
<section id="การสญหายแบบสมสมบรณ-missing-completely-at-random-mcar" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="การสญหายแบบสมสมบรณ-missing-completely-at-random-mcar"><span class="header-section-number">2.2.1</span> การสูญหายแบบสุ่มสมบูรณ์ (missing completely at random: MCAR)</h4>
<p>ข้อมูลสูญหายในตัวแปร <span class="math inline">\(y\)</span> จะเป็นการสูญหายแบบสุ่มสมบูรณ์เมื่อการสูญหายดังกล่าวไม่เกี่ยวข้องหรือไม่สัมพันธ์กับตัวแปรใด ๆ ทั้งที่สังเกตค่าได้และไม่สามารถสังเกตค่าได้ เราสามารถเขียนสมการทางคณิตศาสตร์เพื่ออธิบายการสูญหายแบบ MCAR ได้ดังนี้</p>
<p>กำหนดให้ <span class="math inline">\(m_{ij}\)</span> เป็นตัวแปร dummy แสดงการสูญหายของหน่วยข้อมูลที่ i ในตัวแปรที่ j ถ้ามีค่าเท่ากับ 1 คือเป็นค่าสูญหาย และ <span class="math inline">\(x_{obs}\)</span> คือข้อมูลที่ผู้วิเคราะห์สามารถสังเกตได้ในชุดข้อมูล ส่วน <span class="math inline">\(x_{mis}\)</span> คือข้อมูลที่สูญหาย กลไกลการสูญหายแบบ MCAR คือความน่าจะเป็นในการสูญหายของหน่วยข้อมูลที่ <span class="math inline">\(i\)</span> ในตัวแปรที่ <span class="math inline">\(j\)</span> เป็นค่าคงที่ ที่ไม่สัมพันธ์หรือขึ้นกับข้อมูลที่สังเกตได้และข้อมูลสูญหาย ดังนี้</p>
<p><span class="math display">\[
p(m_{ij} = 1 | x_{obs}, x_{mis}) = p
\]</span></p>
<p>ข้อมูลที่ได้จากการ simulation ด้านล่างแสดงกลไกการเกิดค่าสูญหายแบบ MCAR ได้อย่างชัดเจน</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ชุดข้อมูลสมบูรณ์</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/choat/Downloads/exam.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 387
Columns: 5
$ ach                  &lt;dbl&gt; 52.159780, 30.784999, 39.607737, 55.985351, 31.80…
$ learning_performance &lt;dbl&gt; 32.666667, 10.666667, 28.000000, 52.666667, 15.55…
$ ontime_class         &lt;chr&gt; "used to late", "used to late", "never late", "us…
$ engage               &lt;chr&gt; "no engage", "much engage", "much engage", "much …
$ practice             &lt;chr&gt; "do practice", "do not praction", "do not practio…</code></pre>
</div>
</div>
<p>สมมุติว่ามีการสูญหายแบบ MCAR ขึ้นบนตัวแปร <code>learning_performance</code> ร้อยละ 20 สถานการณ์นี้เทียบเท่ากับการสุ่มตัวอย่างแบบ SRS ออกจาก vector ของ <code>ach</code> ในสัดส่วน 0.2 ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## สร้างค่าสูญหายแบบ MCAR</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mcar =</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.2</span>,<span class="cn">NA</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        learning_performance)) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">## นับจำนวนค่าสูญหายในแต่ละตัวแปร</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">is.na</span>() <span class="sc">|&gt;</span> <span class="fu">colSums</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      ach      learning_performance              ontime_class 
                        0                         0                         0 
                   engage                  practice learning_performance_mcar 
                        0                         0                        69 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">""</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y=</span>name))<span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance))<span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(learning_performance_mcar)<span class="sc">==</span>T), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y=</span>ach), <span class="at">col=</span><span class="st">"maroon"</span>, <span class="at">shape =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>จากรูปข้างต้นจะเห็นว่าชุดข้อมูลที่มีข้อมูลสมบูรณ์และข้อมูลสูญหายแบบ MCAR มีลักษณะการแจกแจงที่คล้ายคลึงกัน ทั้งนี้เป็นเพราะการสูญหายแบบ MCAR ไม่ได้มีความสัมพันธ์กับตัวแปรใด ดังนั้นการสูญหายแบบ MCAR ไม่ได้ทำให้เกิด bias ในการวิเคราะห์ แต่อาจมีผลกับ precision ของการวิเคราะห์ ลองพิจารณาการเปรียบเทียบผลการวิเคราะห์สถิติบรรยาย และสหสัมพันธ์ระหว่างตัวแปรในชุดข้อมูล ระหว่างสถานการณ์ที่มีข้อมูลสมบูรณ์และมีข้อมูลสูญหาย</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(learning_performance, ach, learning_performance_mcar) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(learning_performance, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                        learning_performance_mcar)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">cor =</span> <span class="fu">cor</span>(ach, value, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">r2 =</span> cor<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 8
  name                          n  mean    sd    se median   cor    r2
  &lt;chr&gt;                     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 learning_performance        387  45.8  26.0  1.32   47.6 0.846 0.715
2 learning_performance_mcar   318  45.4  26.0  1.46   47.4 0.842 0.708</code></pre>
</div>
</div>
<p>ผลการวิเคราะห์ข้างต้นจะเห็นว่าข้อมูลทั้งสองชุดให้ผลการวิเคราะห์ที่สอดคล้องกันสะท้อนว่าไม่ได้มีปัญหาความลำเอียงในการประมาณค่าพารามิเตอร์ อย่างไรก็ตามหากพิจารณาที่ค่าคลาดเคลื่อนมาตรฐานจะพบว่าข้อมูลที่มีการสูญหายแบบ MCAR มีแนวโน้มจะมีค่าคลาดเคลื่อนมาตรฐานของค่าเฉลี่ยสูงกว่าข้อมูลสมบูรณ์ ซึ่งบ่งชี้ผลกระทบของการขาดหายไปของข้อมูลที่มีต่อความน่าเชื่อถือ</p>
<p>เพื่อยืนยันข้อสรุปข้างต้นเราสามารถทำซ้ำกระบวนการข้างต้นเพื่อวิเคราะห์แนวโน้มความแม่นยำและความน่าเชื่อถือของการประมาณค่าพารามิเตอร์สถิติบรรยายและสหสัมพันธ์ระหว่างตัวแปรในสถานการณ์ที่มีการสูญหายแบบ MCAR ได้ดังนี้</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>ผลการวิเคราะห์ข้างต้นจะเห็นว่า การประมาณค่าพารามิเตอร์ที่ทั้งส่วนที่เป็นการบรรยายสภาพของตัวแปร และความสัมพันธ์ระหว่างตัวแปรสามารถประมาณได้โดยไม่ลำเอียง แต่เมื่อพิจารณาค่าคลาดเคลื่อนมาตรฐาน เช่น ค่าคลาดเคลื่อนมาตรฐานของค่าเฉลี่ย (se) มีแนวโน้มที่จะประมาณค่าได้สูงขึ้น เนื่องจากขนาดตัวอย่างที่ลดลง</p>
</section>
<section id="การสญหายแบบสม-missing-at-random-mar" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="การสญหายแบบสม-missing-at-random-mar"><span class="header-section-number">2.2.2</span> การสูญหายแบบสุ่ม (missing at random: MAR)</h4>
<p>ข้อมูลสูญหายในตัวแปร <span class="math inline">\(y\)</span> จะเป็นการสูญหายแบบสุ่มเมื่อการสูญหายดังกล่าวมีความสัมพันธ์กับตัวแปรที่สังเกตค่าได้ เราสามารถเขียนสมการทางคณิตศาสตร์เพื่ออธิบายการสูญหายแบบ MAR ได้ดังนี้</p>
<p><span class="math display">\[
p(m_{ij} = 1 | x_{obs}, x_{mis}) = f(x_{obs})
\]</span></p>
<p>กล่าวคือ ถ้าการมีอยู่ของข้อมูลที่ขาดหายไปในตัวแปรหนึ่ง ๆ มีความสัมพันธ์กับตัวแปรอื่น ๆ ที่ผู้วิเคราะห์มีข้อมูลสามารถสังเกตค่าได้ โดยไม่เกี่ยวข้องกับข้อมูลที่สูญหายไปของตัวแปรนั้น ข้อมูลนั้นจะถือว่าขาดหายไปแบบ MAR กลไกการสูญหายแบบ MAR สามารถอธิบายในเชิงคณิตศาสตร์ได้ดังนี้</p>
<p>ข้อมูลที่ได้จากการ simulation ด้านล่างแสดงลักษณะการสูญหายแบบ MAR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## สร้างตัวแปรใหม่ที่สูญหายแบบ MAR โดยมีความสัมพันธ์กับ ach และ engage</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>     ach <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">|</span> engage <span class="sc">==</span> <span class="st">"moderate engage"</span>  <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, learning_performance) ,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> learning_performance</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y=</span>name))<span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ach), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(learning_performance_mar) <span class="sc">==</span> T), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> ach), <span class="at">col =</span> <span class="st">"maroon"</span>, <span class="at">shape =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar, <span class="at">y =</span> ach, <span class="at">color =</span> <span class="st">"MCAR"</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach, <span class="at">color =</span> <span class="st">"MAR"</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"MCAR"</span> <span class="ot">=</span> <span class="st">"grey"</span>, <span class="st">"MAR"</span> <span class="ot">=</span> <span class="st">"maroon"</span>)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Missing Data Type"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(learning_performance,learning_performance_mcar, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         learning_performance_mar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(learning_performance,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                        learning_performance_mcar, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                        learning_performance_mar)) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">cor =</span> <span class="fu">cor</span>(ach, value, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">r2 =</span> cor<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  name                       mean    sd median   cor    r2
  &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 learning_performance       45.8  26.0   47.6 0.846 0.715
2 learning_performance_mar   56.2  24.3   59.8 0.826 0.683
3 learning_performance_mcar  45.4  26.0   47.4 0.842 0.708</code></pre>
</div>
</div>
<p>ในทำนองเดียวกัน เราลอง simulate ข้อมูลสูญหายแบบ MAR จำนวน 1000 ชุด จากนั้นประมาณค่าพารามิเตอร์ต่าง ๆ โดยเปรียบเทียบกับ MCAR ที่ได้ทำไว้ก่อนหน้า ผลการวิเคราะห์จะเห็นว่าเมื่อเกิดค่าสูญหายแบบ MAR การประมาณค่าพารามิเตอร์ต่าง ๆ มีแนวโน้มจะลำเอียงและขาดความน่าเชื่อถือ</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ขอมลสญหายจากสาเหตเฉพาะ" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="ขอมลสญหายจากสาเหตเฉพาะ"><span class="header-section-number">2.3</span> ข้อมูลสูญหายจากสาเหตุเฉพาะ</h3>
<p>สาเหตุเฉพาะหรือ Missing Not at Random (MNAR) คือ การสูญหายที่มีความสัมพันธ์กับค่าของตัวแปรที่สูญหายไป นอกจากนี้การสูญหายแบบ MNAR ยังอาจมีความสัมพันธ์ร่วมกับตัวแปรที่สังเกตค่าได้อีกด้วย เราสามารถเขียนสมการทางคณิตศาสตร์เพื่ออธิบายการสูญหายแบบ MNAR ได้ดังนี้</p>
<p><span class="math display">\[
p(m_{ij} = 1 | x_{obs}, x_{mis}) = f(x_{obs}, x_{mis})
\]</span></p>
<p>กล่าวง่าย ๆ ว่า MNAR เป็นการสูญหายที่เกิดขึ้นโดยสัมพันธ์กับค่าที่สูญหาย การสูญหายแบบนี้ไม่สามารถอธิบายได้ด้วยข้อมูลที่มี เช่น</p>
<ul>
<li><p>ผู้ตอบไม่ตอบคำถามเกี่ยวกับรายได้เพราะรายได้ของตนเองสูงเกินไป</p></li>
<li><p>นักเรียนที่มีคะแนนต่ำมากไม่ตอบคำถาม ไม่เข้าเรียน หรือไม่ส่งงานทำให้ครูไม่สามารถประเมินคะแนนให้นักเรียนได้</p></li>
<li><p>ผู้เรียนที่เรียนไม่เก่ง drop out ออกไปจากชั้นเรียนระหว่างการเรียนรู้ทำให้ไม่สามารถประเมินผลการเรียนรู้หรือตัวแปรที่เกี่ยวข้องได้</p></li>
</ul>
<p>ผลลัพธ์ด้านล่างแสดงผลการเปรียบเทียบการวิเคราะห์ในสถานการณ์ที่ข้อมูลสูญหายแบบ MNAR เปรียบเทียบกับการสูญหายแบบอื่น โดยใช้ข้อมูลจำลอง</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mnar =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    learning_performance <span class="sc">&lt;</span> <span class="dv">30</span>  <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, learning_performance) ,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> learning_performance</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y=</span>name))<span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance))<span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(learning_performance_mnar)<span class="sc">==</span>T), </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y=</span>ach), <span class="at">col=</span><span class="st">"maroon"</span>, <span class="at">shape =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(learning_performance, learning_performance_mcar, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         learning_performance_mar, learning_performance_mnar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"learning"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(value,<span class="at">na.rm =</span> T),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">cor =</span> <span class="fu">cor</span>(ach, value, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">r2 =</span> cor<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  name                       mean    sd median   cor    r2
  &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 learning_performance       45.8  26.0   47.6 0.846 0.715
2 learning_performance_mar   56.2  24.3   59.8 0.826 0.683
3 learning_performance_mcar  45.4  26.0   47.4 0.842 0.708
4 learning_performance_mnar  56.4  21.5   57.9 0.821 0.674</code></pre>
</div>
</div>
<p>การตรวจสอบ MNAR ค่อนข้างลำบากเมื่อเปรียบเทียบกับการวิเคราะห์กลไกการสูญหายแบบอื่น ตัวอย่างด้านล่างแสดงให้เห็นว่าเมื่อมีการสูญหายแบบ MAR ผลการวิเคราะห์ความสัมพันธ์ระหว่างการสูญหายกับตัวแปรในชุดข้อมูลมีลักษณะที่เหมือนกับผลการวิเคราะห์ที่ได้จาก MAR กล่าวคือการแยกกลไกการสูญหายแบบ MAR และ MNAR ออกจากกันด้วยข้อมูลเชิงปริมาณแต่เพียงอย่างเดียวทำได้ยากหรืออาจทำไม่ได้เลย</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span>  <span class="do">## สร้าง shadow matrix</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar_NA, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MCAR Mechanism"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>data <span class="sc">|&gt;</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span>  <span class="do">## สร้าง shadow matrix</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar_NA, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MAR Mechanism"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span>data <span class="sc">|&gt;</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span>  <span class="do">## สร้าง shadow matrix</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mnar_NA, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MNAR Mechanism"</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>จากลักษณะการสูญหายแบบ MNAR ที่มีกลไกที่แฝงอยู่เบื้องหลังค่าที่สูญหายอีกทีหนึ่งนี้ การตรวจสอบจึงค่อนข้างยากลำบาก แต่ก็สามารถดำเนินการได้ โดยวิธีการตรวจสอบที่เป็นไปได้ เช่น</p>
<p>การเปรียบเทียบกับทฤษฎีหรือความรู้หรือข้อมูลอื่นที่มีอยู่เกี่ยวกับบริบทที่ทำการวิเคราะห์ ยกตัวอย่างเช่น การเก็บรวบรวมข้อมูลรายได้ผู้ปกครองของนักเรียนซึ่งพบว่ามีค่าสูญหาย เมื่อทำการวิเคราะห์ข้อมูลรายได้ที่เก็บรวบรวมได้ดังกล่าวอาจพบว่าค่าเฉลี่ย และขอบเขตของรายได้ผู้ปกครองนักเรียนในโรงเรียนนี้มีแนวโน้มที่ต่ำกว่าปกติ โดยอาจสังเกตว่าต่ำกว่าผลการสำรวจในอดีต หรือต่ำกว่าที่ควรจะเป็นจากการพิจารณาบริบทแวดล้อมของโรงเรียน กรณีเช่นนี้อาจตั้งสมมุติฐานได้ว่าการสูญหายดังกล่าวเป็นการสูญหายในกลุ่มของนักเรียนที่ครอบครัวมีฐานะร่ำรวย จากตัวอย่างนี้จะเห็นว่าการตรวจสอบการสูญหายแบบ MNAR ต้องอาศัยความรู้ในส่วนอื่นนอกเหนือจากข้อมูลเชิงปริมาณที่เก็บรวบรวมมาแต่เพียงอย่างเดียว</p>
<p>อีกวิธีการหนึ่งคือการใช้โมเดลการวิเคราะห์ความลำเอียงในการเลือกตัวอย่าง (sample dplyr::selection bias) หรือ Heckman dplyr::selection Model หรือ Heckman Correction <span class="citation" data-cites="Galimard2018">(<a href="#ref-Galimard2018" role="doc-biblioref">Galimard et al. 2018</a>)</span></p>
<p>กลไกของการสูญหายของข้อมูลมีผลต่อประสิทธิภาพของวิธีการจัดการกับข้อมูลที่สูญหาย <span class="citation" data-cites="baraldi2010introduction">(<a href="#ref-baraldi2010introduction" role="doc-biblioref">Baraldi and Enders 2010</a>)</span></p>
<ul>
<li><p>วิธีการลบข้อมูล (เช่น การลบแบบ listwise หรือ pairwise) จะทำงานได้ดีเมื่อข้อมูลสูญหายเป็นแบบ MCAR (Missing Completely at Random) ถ้าว่ากันตามตรงใช้วิธีอะไรกับ MCAR ก็ได้ที่ไม่บิดเบือด distribution ของข้อมูลก็ใช้กับ MCAR ได้หมด MCAR เป็นการสูญหายในอุดมคติที่แก้ได้ง่ายมาก แต่มักไม่เกิดขึ้นจริง</p></li>
<li><p>Multiple Imputation หรือ Full Information Maximum Likelihood (FIML)สามารถทำงานได้ดีกว่าและให้ค่าประมาณพารามิเตอร์ที่ไม่ลำเอียง (unbiased parameter estimates) เมื่อข้อมูลสูญหายเป็นแบบ MCAR หรือ MAR (Missing at Random)</p></li>
<li><p>อย่างไรก็ตาม สิ่งสำคัญที่ต้องสังเกตคือ วิธีการที่ใช้จัดการกับข้อมูลสูญหายหลายวิธี (เช่น การลบข้อมูล, การใช้ multiple imputation หรือ FIML) ไม่ได้ทำงานดีเมื่อข้อมูลสูญหายเป็นแบบ MNAR (Missing Not at Random)</p></li>
<li><p>ในความเป็นจริงชุดข้อมูลหนึ่ง ๆ สามารถการค่าสูญหายหลาย ๆ กลไกได้พร้อมกัน แม้กระทั่งตัวแปรเดียวก็อาจมีการสูญหายทั้ง MAR และ MNAR ผสมกันอยู่ …</p></li>
</ul>
</section>
</section>
<section id="การวเคราะหขอมลทมคาสญหาย" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="การวเคราะหขอมลทมคาสญหาย"><span class="header-section-number">3</span> การวิเคราะห์ข้อมูลที่มีค่าสูญหาย</h2>
<p>การวิเคราะห์ข้อมูลเมื่อมีค่าสูญหายนั้นมีแนวทางหรือวิธีดำเนินงานที่หลากหลายขึ้นอยู่กับว่าเราอ้างอิงสำนักไหน นักสถิติหรือนักวิทยาการข้อมูลคนไหน กลุ่มไหน อย่างไรก็ตามแนวทางโดยทั่วไปที่เหมือนกันประกอบด้วย</p>
<ol type="1">
<li><p>การระบุ สำรวจและวิเคราะห์กลไกการสูญหาย</p></li>
<li><p>การแก้ปัญหาค่าสูญหาย</p></li>
</ol>
<p>รายละเอียดในแต่ละขั้นตอนมีดังนี้</p>
<section id="การระบ-สำรวจและวเคราะหกลไกการสญหาย" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="การระบ-สำรวจและวเคราะหกลไกการสญหาย"><span class="header-section-number">3.1</span> การระบุ สำรวจและวิเคราะห์กลไกการสูญหาย</h3>
<p>ดังที่ได้กล่าวไว้ข้างต้น ค่าสูญหายมีหลายลักษณะ และหลายกรณีการที่สามารถระบุค่าสูญหายว่าเป็นหน่วยข้อมูลใด หรือหน่วยข้อมูลในกลุ่มใด อาจนำไปสู่การแก้ปัญหาได้ในทันทีหากการสูญหายดังกล่าวเป็นการสูญหายที่เกิดจาการเก็บหรือจัดกระทำข้อมูลที่ไม่เหมาะสม</p>
<p>โดยปกติการใช้ทัศนภาพข้อมูลร่วมกับค่าสถิติเช่น จำนวน หรือร้อยละ เป็นวิธีการพื้นฐานในการระบุค่าผิดปกติที่เกิดขึ้นในชุดข้อมูล อย่างไรก็ตามในการทำงานกับข้อมูลขนาดใหญ่ การสำรวจค่าสูญหายด้วยวิธีการดังกล่าวอาจทำได้ยากและใช้เวลานาน กรณีเช่นนี้การนำอัลกอริทึมการเรียนรู้ของเครื่องมาประยุกต์ใช้อาจให้ประสิทธิภาพที่มากกว่า</p>
<section id="tabulating-missing-data" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="tabulating-missing-data"><span class="header-section-number">3.1.1</span> Tabulating Missing data</h4>
<p>ตารางวิเคราะห์ค่าสูญหายอาจจำแนกเป็นสองประเภท คือตารางวิเคราะห์ค่าสูญหายตามคอลัมน์ และตามแถว ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>onlinelearning_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/choat/Downloads/onlinelearning_miss.csv"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ภาพรวม</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_prop_summary</span>(onlinelearning_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      df   var  case
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0.0194  0.58 0.732</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(onlinelearning_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
   variable            n_miss pct_miss
   &lt;chr&gt;                &lt;int&gt;    &lt;num&gt;
 1 climate.online1         97      9.7
 2 climate.onsite2         88      8.8
 3 climate.online3         87      8.7
 4 climate.onsite3         80      8  
 5 climate.onsite1         72      7.2
 6 climate.online2         70      7  
 7 computer                29      2.9
 8 interaction.online1     27      2.7
 9 interaction.onsite1     27      2.7
10 outcome.onsite3         26      2.6
# ℹ 40 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_table</span>(onlinelearning_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   n_miss_in_var n_vars pct_vars
           &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1             0     21       42
 2            11      2        4
 3            15      1        2
 4            16      2        4
 5            18      1        2
 6            19      2        4
 7            20      2        4
 8            21      2        4
 9            22      4        8
10            24      2        4
11            25      1        2
12            26      1        2
13            27      2        4
14            29      1        2
15            70      1        2
16            72      1        2
17            80      1        2
18            87      1        2
19            88      1        2
20            97      1        2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(onlinelearning_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1     5      2        4
 2     6      2        4
 3     8      2        4
 4     9      2        4
 5    11      2        4
 6    17      2        4
 7    20      2        4
 8    22      2        4
 9    23      2        4
10    27      2        4
# ℹ 990 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_table</span>(onlinelearning_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  n_miss_in_case n_cases pct_cases
           &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
1              0     268      26.8
2              1     493      49.3
3              2     239      23.9</code></pre>
</div>
</div>
</section>
<section id="visualization-for-missing-data" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="visualization-for-missing-data"><span class="header-section-number">3.1.2</span> Visualization for Missing data</h4>
<p>เทคนิคทั้งหมดในหัวข้อนี้เหมาะสำหรับใช้กับชุดข้อมูลที่มีขนาดไม่ใหญ่มาก</p>
<ul>
<li><p>heatmap</p></li>
<li><p>missing data pattern plot</p></li>
<li><p>co-occurence plot</p></li>
<li><p>scatter plot</p></li>
</ul>
<p>ตัวอย่างมีดังนี้</p>
<section id="heatmap" class="level5" data-number="3.1.2.1">
<h5 data-number="3.1.2.1" class="anchored" data-anchor-id="heatmap"><span class="header-section-number">3.1.2.1</span> Heatmap</h5>
<p>การสร้าง heatmap สามารถทำได้หลายวิธีการ ตั้งแต่การสร้างแบบ manual (ซึ่งทำบ่อย ๆ ก็เหนื่อย) ไปจนถึงมีฟังก์ชันสำเร็จรูปจากหลาย library ตั้งแต่การใช้ ggplot2 ธรรมดาไปจนถึง library เฉพาะ</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">vis_miss</span>(onlinelearning_data, <span class="at">cluster =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"ChulaCharasNew"</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">vis_miss</span>(onlinelearning_data, <span class="at">cluster =</span> <span class="cn">TRUE</span>, <span class="at">facet =</span> <span class="st">`</span><span class="at">ประเภทสถานศึกษา</span><span class="st">`</span>)<span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"ChulaCharasNew"</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>ตัวอย่างข้างต้นจะเห็นว่า heatmap ดูค่อนข้างยากหากข้อมูลมีขนาดใหญ่ โดยเฉพาะข้อมูลที่มีตัวแปรจำนวนมาก ข้อจำกัดหนึ่งของการใช้ฟังก์ชันสำเร็จรูปคือ เราปรับแต่งการนำเสนอได้จำกัด ทำให้การวิเคราะห์มุมมองต่าง ๆ ของ missing value ทำไม่ค่อยได้ตามที่ต้องการ</p>
<p>อีกวิธีการหนึ่งคือการสร้าง heatmap หรือแผนภาพข้อมูลสูญหายเอง โดยใช้ ggplot2 หรือ library ที่เกี่ยวข้องผ่าน shadow matrix ของ naniar ตัวอย่างมีดังนี้</p>
<p>จากชุดข้อมูล data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>learning_performance) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">### สร้าง shadow matrix</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 387
Columns: 14
$ ach                          &lt;dbl&gt; 52.159780, 30.784999, 39.607737, 55.98535…
$ ontime_class                 &lt;chr&gt; "used to late", "used to late", "never la…
$ engage                       &lt;chr&gt; "no engage", "much engage", "much engage"…
$ practice                     &lt;chr&gt; "do practice", "do not praction", "do not…
$ learning_performance_mcar    &lt;dbl&gt; 32.666667, 10.666667, 28.000000, 52.66666…
$ learning_performance_mar     &lt;dbl&gt; 32.666667, NA, NA, 52.666667, 15.555556, …
$ learning_performance_mnar    &lt;dbl&gt; 32.666667, NA, NA, 52.666667, 15.555556, …
$ ach_NA                       &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !…
$ ontime_class_NA              &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !…
$ engage_NA                    &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !…
$ practice_NA                  &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !…
$ learning_performance_mcar_NA &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, NA, !NA, !NA, !N…
$ learning_performance_mar_NA  &lt;fct&gt; !NA, NA, NA, !NA, !NA, !NA, NA, !NA, !NA,…
$ learning_performance_mnar_NA &lt;fct&gt; !NA, NA, NA, !NA, !NA, !NA, NA, !NA, !NA,…</code></pre>
</div>
</div>
<p>ลองนำ shadow matrix ที่สร้างขึ้นมาใช้ประโยชน์</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>learning_performance) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">### สร้าง shadow matrix</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">387</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"NA"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y=</span> student_id))<span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value))<span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_grey</span>()</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>learning_performance) <span class="sc">|&gt;</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">### สร้าง shadow matrix</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">387</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"NA"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y=</span> <span class="fu">reorder</span>(student_id, ach)))<span class="sc">+</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value))<span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_grey</span>()</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>เมื่อจัดเรียงข้อมูลตาม ach จากน้อยไปมาก จะพบว่าในช่อง MAR มีรูปแบบการสูญหายในกลุ่ม ach น้อยมากกว่ากลุ่ม ach มาก ลักษณะนี้สะท้อนความสัมพันธ์ระหว่างการสูญหายกับตัวแปร ach กล่าวคือกลไกการสูญหายในตัวแปรดังกล่าวมีแนวโน้มเป็น MAR</p>
</section>
<section id="co-occurence-plot" class="level5" data-number="3.1.2.2">
<h5 data-number="3.1.2.2" class="anchored" data-anchor-id="co-occurence-plot"><span class="header-section-number">3.1.2.2</span> co-occurence plot</h5>
<p>co-occurence plot ช่วยแสดงสภาพการสูญหายที่ลึกกว่า heatmap เพราะมีทั้งมิติความถี่ของการสูญหายเป็นรายตัวแปรซึ่งจำแนกเป็นการสูญหายในตัวแปรเดียว และการสูญหายร่วมกัน</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(onlinelearning_data, <span class="at">nset =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>แผนภาพข้างต้นแสดงให้เห็นว่า ….</p>
</section>
<section id="scatter-plot" class="level5" data-number="3.1.2.3">
<h5 data-number="3.1.2.3" class="anchored" data-anchor-id="scatter-plot"><span class="header-section-number">3.1.2.3</span> Scatter plot</h5>
<p>บางสำนักเรียกว่า margin plot เป็นแผนภาพที่มีประโยชน์ในการสร้างทัศนภาพข้อมูลในเชิงความสัมพันธ์ระหว่างค่าสูญหายกับตัวแปรที่มีข้อมูลในชุดข้อมูล ซึ่งสามารถใช้สำรวจหรือระบุกลไกการสูญหายของข้อมูลได้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar))<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach ,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> learning_performance_mcar_NA))<span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"!NA"</span> <span class="ot">=</span> <span class="cn">NULL</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"maroon"</span>),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="cn">NULL</span>, <span class="st">"missing in LP"</span>))<span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MAR Mechanism"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar))<span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach ,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"!NA"</span> <span class="ot">=</span> <span class="cn">NULL</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"maroon"</span>),</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="cn">NULL</span>, <span class="st">"missing in LP"</span>))<span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MAR Mechanism"</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mnar))<span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y=</span>ach ,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> learning_performance_mnar_NA))<span class="sc">+</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"!NA"</span> <span class="ot">=</span> <span class="cn">NULL</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"maroon"</span>),</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="cn">NULL</span>, <span class="st">"missing in LP"</span>))<span class="sc">+</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MNAR Mechanism"</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>ในทางปฏิบัติหากชุดข้อมูลมีขนาดใหญ่ การที่จะระบุตัวแปรมาสร้างเป็นแผนภาพ scatter ข้างต้นก็ยากเหมือนกัน …</p>
</section>
</section>
</section>
<section id="การสำรวจคาสญหายสำหรบขอมลขนาดใหญ" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="การสำรวจคาสญหายสำหรบขอมลขนาดใหญ"><span class="header-section-number">3.2</span> การสำรวจค่าสูญหายสำหรับข้อมูลขนาดใหญ่</h3>
<p>จากข้อจำกัดของการใช้สถิติบรรยายและทัศนภาพข้อมูลพื้นฐานเพื่อสำรวจค่าสูญหาย ทำให้ผู้วิเคราะห์ต้องการตัวช่วยในการสำรวจดังกล่าวสำหรับชุดข้อมูลขนาดใหญ่ เราอาจจำแนกตัวช่วยออกเป็นสองกลุ่ม ได้แก่</p>
<ul>
<li><p>การวิเคราะห์ลักษณะของค่าสูญหายในชุดข้อมูล เช่่น การวิเคราะห์องค์ประกอบหลักของค่าสูญหาย หรือการวิเคราะห์จัดกลุ่ม</p></li>
<li><p>การวิเคราะห์กลไกการสูญหายในชุดข้อมูล เช่น การทดสอบ LittleMCAR การวิเคราะห์การถดถอยแบบ logistic หรือการทำ decision tree หรืออัลกอริทึมการเรียนรู้ของเครื่องแบบอื่น ๆ</p></li>
</ul>
<section id="การวเคราะหองคประกอบหลกของคาสญหาย" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="การวเคราะหองคประกอบหลกของคาสญหาย"><span class="header-section-number">3.2.1</span> การวิเคราะห์องค์ประกอบหลักของค่าสูญหาย</h4>
<p>การวิเคราะห์องค์ประกอบหลัก (Principal Component Analysis หรือ PCA) สำหรับข้อมูลสูญหายเป็นเทคนิคที่ใช้เพื่อลดมิติของข้อมูลและระบุรูปแบบหรือโครงสร้างที่ซ่อนอยู่ในชุดข้อมูล โดยเฉพาะเมื่อข้อมูลมีค่าสูญหายเป็นจำนวนมาก การใช้ PCA ช่วยให้ผู้วิเคราะห์สามารถเข้าใจการสูญหายของข้อมูลในเชิงโครงสร้างว่ามีการกระจายหรือสัมพันธ์กันอย่างไรในตัวแปรต่างๆ</p>
<p>จุดเด่นของ PCA สามารถใช้ในการ<strong>ระบุรูปแบบการสูญหายที่เกิดขึ้นร่วมกัน (co-occurring missingness)</strong> การตรวจสอบลักษณะการสูญหายเช่นนี้จะช่วยให้คุณเห็นความสัมพันธ์ระหว่างการสูญหายของข้อมูลและปัจจัยพื้นฐานที่อาจไม่ได้สังเกตเห็นจากการวิเคราะห์แบบพื้นฐาน ซึ่งนอกจากจะช่วยให้เข้าใจรูปแบบการสูญหายได้ง่ายขึ้นและนำไปสู่การวิเคราะห์ขั้นต่อไปที่แม่นยำขึน</p>
<p>การใช้ PCA ในบริบทนี้สามารถดำเนินการได้ดังนี้</p>
<ol type="1">
<li><p>แปลงข้อมูลของตัวแปรที่มีค่าสูญหายเป็น dummy variable โดยใช้ 1 แทนค่าสูญหาย และ 0 แทนค่าที่ไม่สูญหาย (สามารถสร้างได้จาก shadow matrix)</p></li>
<li><p>ใช้ PCA เพื่อสกัดองค์ประกอบหลักจาก matrix ของ dummy ดังกล่าว</p></li>
<li><p>ลักษณะการทำงานของ PCA คือจะสร้างองค์ประกอบหลักที่สามารถอธิบายความแปรปรวนของตัวแปรต้นฉบับเดิมให้ได้มากที่สุด ดังนั้นเมื่อตัวแปรนำเข้าเป็นแบบ binary 0,1 องค์ประกอบหลักที่ได้จึงจะสะท้อนความแปรปรวนหรือรูปแบบการสูญหายของข้อมูล</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## list ตัวแปรที่มี missing ในชุดข้อมูล</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>miss_var <span class="ot">&lt;-</span> onlinelearning_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">is.na</span>(.)))) <span class="sc">|&gt;</span> <span class="fu">names</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">### เตรียมชุดข้อมูลค่าสูญหาย ผลลัพธ์ในขั้นตอนนี้จะได้ dummy matrix</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>missing_mat <span class="ot">&lt;-</span> onlinelearning_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## คัดเลือกเฉพาะตัวแปรที่มี missing value เท่านั้น</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(miss_var)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## สร้าง shadow matrix ด้วย naniar</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">58</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span>.<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="do">### นำไปวิเคราะห์ PCA</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">princomp</span>(missing_mat)  </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>pca_res<span class="sc">$</span>sdev <span class="do">## standard deviation ของ PC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Comp.1     Comp.2     Comp.3     Comp.4     Comp.5     Comp.6     Comp.7 
0.30853920 0.29735361 0.28877468 0.27633126 0.26694412 0.20588165 0.16862664 
    Comp.8     Comp.9    Comp.10    Comp.11    Comp.12    Comp.13    Comp.14 
0.16365996 0.16219699 0.15949719 0.15620654 0.15439095 0.15281102 0.14823398 
   Comp.15    Comp.16    Comp.17    Comp.18    Comp.19    Comp.20    Comp.21 
0.14803777 0.14617429 0.14500372 0.14451515 0.14177341 0.14112542 0.13863524 
   Comp.22    Comp.23    Comp.24    Comp.25    Comp.26    Comp.27    Comp.28 
0.13728069 0.13486908 0.12850218 0.12625917 0.12300133 0.11141953 0.10424542 
   Comp.29 
0.09761994 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Scree plot</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">PC =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>, <span class="at">eigen =</span> pca_res<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC, <span class="at">y=</span>eigen))<span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Scree plot of PC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Scree plot ด้านบนแปลความหมายว่าอย่างไร</p>
<p>Component หรือ Factor Loading คือสหสัมพันธ์ระหว่างตัวแปรต้นฉบับกับองค์ประกอบหลักแต่ละตัว ใช้ตีความหมายขององค์ประกอบหลักใน PCA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## component loading</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>pca_res<span class="sc">$</span>loadings[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"var"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">y=</span>var))<span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name)<span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"ChulaCharasNew"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-of-missing-value" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="correlation-of-missing-value"><span class="header-section-number">3.2.2</span> Correlation of Missing Value</h4>
<p>จากผลการวิเคราะห์ข้างต้นจะเห็นว่า component score ที่ได้จาก PCA สามารถสะท้อนสภาพการสูญหายโดยเฉพาะะ co-occurence missing value ผู้วิเคราะห์สามารถนำคะแนน component ดังกล่าวไปดำเนินการวิเคราะห์เพื่อระบุกลไกการสูญหายของข้อมูลในมิติต่าง ๆ ที่เกิดขึ้นในชุดข้อมูล ยกตัวอย่างเช่น</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ดึง component score แรกมาลองวิเคราะห์</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>missing_pca1<span class="ot">&lt;-</span> pca_res<span class="sc">$</span>scores[,<span class="dv">1</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>missing_pca2<span class="ot">&lt;-</span> pca_res<span class="sc">$</span>scores[,<span class="dv">2</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(missing_pca1 <span class="sc">|&gt;</span> <span class="fu">abs</span>())</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(missing_pca2 <span class="sc">|&gt;</span> <span class="fu">abs</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> onlinelearning_data <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">missing_pca1 =</span> missing_pca1) <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_pca1 =</span> <span class="fu">abs</span>(missing_pca1)) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>missing_pca1) <span class="sc">|&gt;</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cor =</span> <span class="fu">cor</span>(missing_pca1, value, <span class="at">use =</span> <span class="st">"complete.obs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r2 =</span> cor<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r2, <span class="at">y=</span> <span class="fu">reorder</span>(name, <span class="fu">abs</span>(cor))))<span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"ChulaCharasNew"</span>))<span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>missing_pca2<span class="ot">&lt;-</span> pca_res<span class="sc">$</span>scores[,<span class="dv">2</span>]</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> onlinelearning_data <span class="sc">|&gt;</span> </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">missing_pca2 =</span> missing_pca2) <span class="sc">|&gt;</span> </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_pca2 =</span> <span class="fu">abs</span>(missing_pca2)) <span class="sc">|&gt;</span> </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>missing_pca2) <span class="sc">|&gt;</span> </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cor =</span> <span class="fu">cor</span>(missing_pca2, value, <span class="at">use =</span> <span class="st">"complete.obs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r2 =</span> cor<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r2, <span class="at">y=</span> <span class="fu">reorder</span>(name, <span class="fu">abs</span>(cor))))<span class="sc">+</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"ChulaCharasNew"</span>))<span class="sc">+</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>ผลการวิเคราะห์ข้างต้นแปลความได้อย่างไร</p>
</section>
<section id="regression-of-missing-values" class="level4" data-number="3.2.3">
<h4 data-number="3.2.3" class="anchored" data-anchor-id="regression-of-missing-values"><span class="header-section-number">3.2.3</span> Regression of Missing Values</h4>
<p>นอกจากการใช้ correlation แล้วเรายังสามารถใช้ regression analysis หรือ logistic regression analysis เพื่อวิเคราะห์</p>
<section id="using-linear-regression" class="level5" data-number="3.2.3.1">
<h5 data-number="3.2.3.1" class="anchored" data-anchor-id="using-linear-regression"><span class="header-section-number">3.2.3.1</span> Using Linear Regression</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a> onlinelearning_data <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">missing_pca1 =</span> missing_pca1) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_pca1 =</span> <span class="fu">abs</span>(missing_pca1)) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(missing_pca1 <span class="sc">~</span> ., <span class="at">data =</span> .) <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = missing_pca1 ~ ., data = .)

Residuals:
       Min         1Q     Median         3Q        Max 
-6.971e-17 -9.480e-19  3.140e-19  1.324e-18  6.529e-18 

Coefficients: (1 not defined because of singularities)
                                             Estimate Std. Error    t value
(Intercept)                                 2.032e-02  6.273e-18  3.240e+15
`ประเภทสถานศึกษา`โรงเรียนมัธยมศึกษา             7.075e-19  2.027e-18  3.490e-01
`ที่ตั้งสถานศึกษา`ใต้                             7.606e-19  2.437e-18  3.120e-01
`ที่ตั้งสถานศึกษา`เหนือ                           8.852e-19  1.544e-18  5.730e-01
`ที่ตั้งสถานศึกษา`อิสาน                           1.662e-18  2.085e-18  7.970e-01
`จำนวนรายวิชาที่ลงทะเบียน`                      2.890e-19  3.917e-19  7.380e-01
`จำนวนรายวิชาonline`                        -1.755e-19  2.097e-19 -8.370e-01
`จำนวนรายวิชาonsite`                                NA         NA         NA
`ระดับความพร้อมสถานศึกษา`                      1.079e-19  4.213e-19  2.560e-01
videoConference                            -6.734e-19  8.073e-19 -8.340e-01
Live                                       -5.786e-19  7.645e-19 -7.570e-01
LMS                                        -4.784e-19  7.854e-19 -6.090e-01
groupChat                                  -1.115e-18  8.363e-19 -1.334e+00
email                                       1.246e-18  7.974e-19  1.563e+00
collapApps                                  2.842e-19  9.208e-19  3.090e-01
clipVideo                                  -1.316e-19  7.927e-19 -1.660e-01
`อายุเฉลี่ยผู้สอน`                               8.338e-19  1.015e-18  8.210e-01
`ภาพรวมความสามารถในการใช้สื่อเทคโนโลยีของผู้สอน`  1.233e-18  7.855e-19  1.569e+00
climate.online1                            -5.366e-19  3.715e-19 -1.445e+00
climate.online2                            -4.644e-19  3.991e-19 -1.164e+00
climate.online3                             2.116e-19  4.136e-19  5.110e-01
climate.onsite1                            -3.987e-19  3.282e-19 -1.215e+00
climate.onsite2                             3.600e-19  3.772e-19  9.540e-01
climate.onsite3                            -2.151e-19  3.148e-19 -6.830e-01
`เพศผู้เรียน`                                  2.837e-19  6.757e-19  4.200e-01
`ระดับชั้น`                                   -8.743e-20  3.911e-19 -2.240e-01
`ภูมิลำเนา`ใต้                                -7.852e-20  1.652e-18 -4.800e-02
`ภูมิลำเนา`เหนือ                               3.283e-19  1.034e-18  3.180e-01
`ภูมิลำเนา`อิสาน                               1.041e-18  1.317e-18  7.900e-01
`สไตล์การเรียนที่ชอบ`                          -3.487e-19  5.113e-19 -6.820e-01
smartphone                                 -6.067e-19  1.172e-18 -5.180e-01
ipad                                       -2.329e-19  1.089e-18 -2.140e-01
computer                                   -1.400e-18  1.455e-18 -9.620e-01
`ความพร้อมของinternet`                      -5.809e-21  9.212e-19 -6.000e-03
`บรรยากาศที่พักอาศัย`                           2.315e-19  7.660e-19  3.020e-01
`ความสามารถผู้เรียนในการใช้เทคโนโลยี`            8.491e-20  6.952e-19  1.220e-01
`ความคิดเห็นต่อการเรียน`                        1.944e-19  4.554e-19  4.270e-01
interaction.online1                         1.178e-19  6.072e-19  1.940e-01
interaction.online2                        -4.328e-20  5.957e-19 -7.300e-02
interaction.online3                         4.540e-19  5.683e-19  7.990e-01
interaction.onsite1                        -4.410e-20  5.585e-19 -7.900e-02
interaction.onsite2                        -5.678e-20  5.446e-19 -1.040e-01
interaction.onsite3                        -3.403e-19  5.005e-19 -6.800e-01
`ความเครียดขณะเรียนonline`                   -2.817e-19  2.363e-19 -1.192e+00
`ความเครียดขณะเรียนonsite`                    7.786e-20  2.334e-19  3.340e-01
outcome.online1                            -6.562e-19  6.707e-19 -9.780e-01
outcome.online2                             4.559e-19  7.021e-19  6.490e-01
outcome.online3                            -1.922e-19  7.204e-19 -2.670e-01
outcome.online4                            -1.372e-20  4.885e-20 -2.810e-01
outcome.onsite1                            -9.543e-19  5.845e-19 -1.633e+00
outcome.onsite2                             6.112e-20  6.274e-19  9.700e-02
outcome.onsite3                            -6.383e-20  5.998e-19 -1.060e-01
outcome.onsite4                             9.239e-20  5.031e-20  1.836e+00
                                           Pr(&gt;|t|)    
(Intercept)                                  &lt;2e-16 ***
`ประเภทสถานศึกษา`โรงเรียนมัธยมศึกษา              0.7275    
`ที่ตั้งสถานศึกษา`ใต้                              0.7553    
`ที่ตั้งสถานศึกษา`เหนือ                            0.5670    
`ที่ตั้งสถานศึกษา`อิสาน                            0.4264    
`จำนวนรายวิชาที่ลงทะเบียน`                       0.4615    
`จำนวนรายวิชาonline`                          0.4035    
`จำนวนรายวิชาonsite`                              NA    
`ระดับความพร้อมสถานศึกษา`                       0.7982    
videoConference                              0.4051    
Live                                         0.4499    
LMS                                          0.5431    
groupChat                                    0.1837    
email                                        0.1195    
collapApps                                   0.7579    
clipVideo                                    0.8683    
`อายุเฉลี่ยผู้สอน`                                0.4125    
`ภาพรวมความสามารถในการใช้สื่อเทคโนโลยีของผู้สอน`   0.1181    
climate.online1                              0.1500    
climate.online2                              0.2459    
climate.online3                              0.6096    
climate.onsite1                              0.2257    
climate.onsite2                              0.3410    
climate.onsite3                              0.4952    
`เพศผู้เรียน`                                   0.6750    
`ระดับชั้น`                                     0.8233    
`ภูมิลำเนา`ใต้                                  0.9621    
`ภูมิลำเนา`เหนือ                                0.7511    
`ภูมิลำเนา`อิสาน                                0.4305    
`สไตล์การเรียนที่ชอบ`                            0.4960    
smartphone                                   0.6052    
ipad                                         0.8309    
computer                                     0.3370    
`ความพร้อมของinternet`                        0.9950    
`บรรยากาศที่พักอาศัย`                            0.7628    
`ความสามารถผู้เรียนในการใช้เทคโนโลยี`             0.9029    
`ความคิดเห็นต่อการเรียน`                         0.6699    
interaction.online1                          0.8463    
interaction.online2                          0.9421    
interaction.online3                          0.4253    
interaction.onsite1                          0.9371    
interaction.onsite2                          0.9171    
interaction.onsite3                          0.4974    
`ความเครียดขณะเรียนonline`                     0.2344    
`ความเครียดขณะเรียนonsite`                     0.7390    
outcome.online1                              0.3290    
outcome.online2                              0.5169    
outcome.online3                              0.7898    
outcome.online4                              0.7791    
outcome.onsite1                              0.1040    
outcome.onsite2                              0.9225    
outcome.onsite3                              0.9153    
outcome.onsite4                              0.0677 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.097e-18 on 216 degrees of freedom
  (732 observations deleted due to missingness)
Multiple R-squared:  0.5083,    Adjusted R-squared:  0.3922 
F-statistic: 4.378 on 51 and 216 DF,  p-value: 1.278e-14</code></pre>
</div>
</div>
<p>อย่างไรก็ตามจะเห็นว่าผลการวิเคราะห์ข้างต้นมีปัญหา singularity เนื่องจากข้อมูลมีขนาดใหญ่ ตัวแปรมีจำนวนมาก การใส่ตัวแปรทั้งหมดลงไปวิเคราะห์มีแนวโน้มที่จะทำให้เกิดปัญหา multicollinearity การแก้ปัญหาดังกล่าวสามารถทำได้ด้วยการเลือก ML ตัวอื่น ๆ ที่แก้ปัญหาได้โดยตรง เช่น regularized regression หรืออื่น ๆ (ไปเรียนใน ML ดีกว่าครับ)</p>
<p>หากเราทำ ML ยังไม่ได้แล้วจะต้องทำ regression ข้างต้น เราจะลองแก้ปัญหายังไงได้บ้าง ??</p>
</section>
<section id="using-logistic-regression" class="level5" data-number="3.2.3.2">
<h5 data-number="3.2.3.2" class="anchored" data-anchor-id="using-logistic-regression"><span class="header-section-number">3.2.3.2</span> Using Logistic Regression</h5>
<p>นอกจากการทำ linear regression แล้วเรายังสามารถทำ logistic regression ของค่าสูญหายได้ด้วย ในกรณีนี้ขอใช้ตัวอย่างเล็ก ๆ ก่อนเพื่อให้ focus ส่วนเนื้อหา logistic regression ไปพร้อมกับการวิเคราะห์ค่าสูญหายได้ด้วย</p>
<p>เราจะใช้ข้อมูล <code>data</code> เพื่อวิเคราะห์กลไกการสูญหายในตัวแปร <code>learning_performance_mar</code> ดังนั้นขั้นแรกเราจะจัดกระทำข้อมูลให้มีเฉพาะตัวแปรที่ต้องการใช้งานก่อน</p>
<p>เมื่อตัวแปรตามเป็นตัวแปรแบบ binary ที่มีสองค่าได้แก่ 0,1 จะทำให้ค่าทำนายที่ได้จากสมการถดถอยมีความหมายเป็นสัดส่วนของการเกิดเหตุการณ์ที่สนใจ (เพราะอะไร?) ดังนั้นจึงมีความเป็นไปได้ที่จะใช้สมการถดถอยเชิงเส้นสำหรับอธิบายความสัมพันธ์ระหว่างสัดส่วนหรือความน่าจะเป็นของการเกิดเหตุการณ์ที่สนใจกับตัวแปรอิสระ</p>
<p>จากรูปด้านล่าง (ซ้าย) แสดงการใช้สมการเส้นตรง fit กับความสัมพันธ์ระหว่างตัวแปรตามแบบ binary คือการสูญหายใน learning performance กับผลสัมฤทธิ์ทางการเรียน (ach) เมื่อพิจารณาในส่วน scatter plot จะเห็นว่าความสัมพันธ์ระหว่างการสูญหายใน learning performance กับ ach มีแนวโน้มสัมพันธ์ในทิศทางลบ กล่าวคือการสูญหายมีแนวโน้มพบมากกว่าในกลุ่มนักเรียนที่มี ach ต่ำ ค่าทำนายของสัดส่วนหรือโอกาสการเกิดค่าสูญหาย (พิจารณาจากเส้นตรง) จึงมีแนวโน้มสูงในกลุ่ม ach ต่ำ และมีแนวโน้มลดต่ำลงเมื่อ ach มีแนวโน้มเพิ่มสูงขึ้น ในทางสถิติเรียกโมเดลการวิเคราะห์นี้ว่า โมเดลความน่าจะเป็นเชิงเส้น (linear probability model) อย่างไรก็ตามการใช้โมเดลดังกล่าวเพื่อทำนายความน่าจะเป็นของเหตุการณ์ที่สนใจไม่เหมาะสมนัก ทั้งนี้เป็นเพราะสมการทำนายดังกล่าวสามารถให้ค่าความน่าจะเป็นที่ต่ำกว่า 0 และมากกว่า 1 ได้โดยเฉพาะบริเวณส่วนปลายของการแจกแจง ach ซึ่งไม่สอดคล้องกับสัจพจน์ (axoim) ของความน่าจะเป็น</p>
<p>การแก้ปัญหาดังกล่าวสามารถทำได้ด้วยการปรับเปลี่ยนฟังก์ชันการตอบสนอง (response function) หรือ functional form ของสมการถดถอยให้เป็นแบบ non-linear สมการที่เหมาะสมคือ logistic function หรือที่เรียกว่า Sigmoid curve ดังรูปด้านล่าง (ขวา) ทั้งนี้เป็นเพราะฟังก์ชันดังกล่าวมีลักษณะเป็นเส้นโค้งที่สามารถกำกับค่าความน่าจะเป็นให้อยู่ในช่วง [0,1]</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>โมเดล logistic regression สามารถเขียนได้หลายรูปแบบ สมการด้านล่างเรียกว่า logistic regression แสดงความสัมพันธ์ระหว่างความน่าจะเป็นของการสูญหายกับตัวแปรอื่น ๆ ที่สังเกตค่าได้ในชุดข้อมูล</p>
<p><span class="math display">\[
p = P(missing = 1) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \ldots + \beta_k x_k)}}
\]</span></p>
<p>อีกรูปแบบหนึ่งของ logistic regression เรียกว่า logit model สมการดังกล่าวสร้างจากการหาอัตราส่วนระหว่างความน่าจะเป็นที่จะเกิดเหตุการณ์ต่อความน่าจะเป็นที่ไม่เกิดเหตุการณ์ เชิงเทคนิคเรียกอัตราส่วนนี้ว่า อัตราส่วนของโอกาส หรือ อัตราต่อรอง (Odd) จะเห็นว่าสมการของ log ของอัตราส่วนดังกล่าวสามารถเขียนได้เป็นความสัมพันธ์เชิงเส้นตรงกับตัวแปรอิสระในโมเดล</p>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \ldots + \beta_k x_k
\]</span></p>
<p>การใช้ประโยชน์จาก logistic regression นี้สามารถทำได้สองลักษณะ ลักษณะแรกคือการทำนายโอกาสของการเกิดเหตุการณ์ด้วยข้อมูลของตัวแปรอิสระ อีกลักษณะหนึ่งคือการอธิบายความสัมพันธ์ระหว่างโอกาสของการเกิดเหตุการณ์ที่สนใจกับตัวแปรอิิสระ ในบทเรียนนี้เราจะกล่าวถึงวัตถุประสงค์ข้อที่ 2 ก่อน</p>
<p>จาก logit model ข้างต้นจะเห็นว่าสัมประสิทธิ์การถดถอยในโมเดลสามารถบ่งชี้ความสัมพันธ์ระหว่างโอกาสกับตัวแปรอิสระต่าง ๆ ทั้งเชิงขนาดและทิศทาง โดยถ้าเครื่องหมายเป็นบวกแสดงว่าปัจจัยหรือตัวแปรอิสระนั้นมีความสัมพันธ์เชิงบวกกับโอกาสที่สนใจ หากสัมประสิทธิ์ดังกล่าวมีค่าเข้าใกล้ 0 แสดงว่าปัจจัยดังกล่าวไม่ได้มีความสัมพันธ์เชิงเส้นกับโอกาส</p>
<p>อย่างไรก็ตามการประเมินขนาดของค่าสัมประสิทธิ์จากสมการ logit ยังทำได้ยาก เพราะหน่วยการประเมินเป็น log ของอัตราต่อรอง เพื่อให้สามารถอธิบายความสัมพันธ์ดังกล่าวได้อย่างมีความหมายเราจำเป็นจะต้องสร้างดัชนีที่แปลผลได้ในการรับรู้ของมนุษย์</p>
<p>สมมุติว่า <span class="math inline">\(x_1\)</span> เป็นตัวแปรที่สนใจที่จะวิเคราะห์ขนาดอิทธิพล เราจะกำหนดให้ตัวแปรอิสระอื่น ๆ คงที่ และจะพิจารณาอิทธิพล/ความสัมพันธ์ของ <span class="math inline">\(x_1\)</span> จากการหาตัวเปรียบเทียบ Odd ระหว่างสถานการณ์ที่ <span class="math inline">\(x_1 = x\)</span> และ <span class="math inline">\(x_1 = x+1\)</span></p>
<p><span class="math display">\[
log(Odd|x_1=x) = \beta_0 + \beta_1 (x) + ...
\]</span></p>
<p><span class="math display">\[
log(Odd|x_1=x+1) = \beta_0 + \beta_1 (x+1) + ...  = \beta_0 + \beta_1 x + \beta_1 + ...
\]</span></p>
<p>นำสองสมการมาลบกันเพื่อเปรียบเทียบการเปลี่ยนแปลงของ odd ระหว่างสองสถานการณ์ข้างต้น</p>
<p>ดังนั้นจะเห็นว่า exponential ของสัมประสิทธิ์การถดถอยจะมีความหมายเป็นอัตราส่วนของ Odd เรียกว่า Odd Ratio สามารถแปลความหมายได้ว่า …</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ach, learning_performance_mar, engage, ontime_class, practice) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_in_LP =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">glm</span>(missing_in_LP <span class="sc">~</span> ach <span class="sc">+</span> engage <span class="sc">+</span> practice <span class="sc">+</span> ontime_class, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> ., <span class="at">family =</span> <span class="st">"binomial"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = missing_in_LP ~ ach + engage + practice + ontime_class, 
    family = "binomial", data = .)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               3.35162    0.48998   6.840 7.90e-12 ***
ach                      -0.09102    0.01102  -8.261  &lt; 2e-16 ***
engagemoderate engage     2.68888    0.49369   5.447 5.14e-08 ***
engagemuch engage        -0.53232    0.36063  -1.476    0.140    
engageno engage           0.32770    0.58935   0.556    0.578    
practicedo practice       0.18806    0.36223   0.519    0.604    
ontime_classused to late -0.14451    0.29007  -0.498    0.618    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 531.71  on 386  degrees of freedom
Residual deviance: 326.56  on 380  degrees of freedom
AIC: 340.56

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>การประเมินประสิทธิภาพของ classification model เช่น logistic regression มีตัวชี้วัดที่แตกต่างจาก linear regression แบบปกติ เครื่องมือหลักที่ใช้ในการสร้างดัชนีประเมินประสิทธิภาพเรียกว่า confusion matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>missing_model <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ach, learning_performance_mar, engage, ontime_class, practice) <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_in_LP =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">glm</span>(missing_in_LP <span class="sc">~</span> ach <span class="sc">+</span> engage <span class="sc">+</span> practice <span class="sc">+</span> ontime_class, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> ., <span class="at">family =</span> <span class="st">"binomial"</span>))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>prob_missing <span class="ot">&lt;-</span> <span class="fu">predict</span>(missing_model)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>pred_missing <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_missing<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confusion Matrix คือเครื่องมือที่ใช้ในการวัดประสิทธิภาพของโมเดลการจำแนก (classification) โดยเป็นตารางที่แสดงผลลัพธ์การทำนายของโมเดลเทียบกับผลลัพธ์ที่แท้จริง ตารางนี้ถูกเรียกว่า “confusion” เนื่องจากมันช่วยแสดงให้เห็นว่าโมเดลสับสนอย่างไรในการจำแนกประเภทต่างๆ ในตารางมีส่วนประกอบได้แก่</p>
<ul>
<li><p>true positive (TP)</p></li>
<li><p>true negative (TN)</p></li>
<li><p>false positive (FP)</p></li>
<li><p>false negative (FN)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## confusion matrix</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">factor</span>(missing_truth)) <span class="sc">|&gt;</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred_missing =</span> pred_missing) <span class="sc">|&gt;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_missing =</span> <span class="fu">factor</span>(pred_missing)) <span class="sc">|&gt;</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> missing_truth, <span class="at">estimate =</span> pred_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction   0   1
         0 188  64
         1  27 108</code></pre>
</div>
</div>
<p>จากตารางดังกล่าวสามารถนำไปใช้สร้างดัชนีอีกหลายตัว เช่น</p>
<ul>
<li><p>accuracy = (TP + TN)/(Total)</p></li>
<li><p>sensitivity หรือ recall = TP/(TP + FP)</p></li>
<li><p>specificity = TN/(TN + FN)</p></li>
<li><p>precision = TP/(TP + FP)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">factor</span>(missing_truth)) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred_missing =</span> pred_missing) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_missing =</span> <span class="fu">factor</span>(pred_missing)) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(<span class="at">truth =</span> missing_truth, <span class="at">estimate =</span> pred_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary         0.765</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">factor</span>(missing_truth)) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred_missing =</span> pred_missing) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_missing =</span> <span class="fu">factor</span>(pred_missing)) <span class="sc">|&gt;</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sens</span>(<span class="at">truth =</span> missing_truth, <span class="at">estimate =</span> pred_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 sens    binary         0.874</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">factor</span>(missing_truth)) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred_missing =</span> pred_missing) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_missing =</span> <span class="fu">factor</span>(pred_missing)) <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spec</span>(<span class="at">truth =</span> missing_truth, <span class="at">estimate =</span> pred_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 spec    binary         0.628</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing_truth =</span> <span class="fu">factor</span>(missing_truth)) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred_missing =</span> pred_missing) <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_missing =</span> <span class="fu">factor</span>(pred_missing)) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">precision</span>(<span class="at">truth =</span> missing_truth, <span class="at">estimate =</span> pred_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric   .estimator .estimate
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
1 precision binary         0.746</code></pre>
</div>
</div>
<p>ผลการวิเคราะห์ข้างต้นบ่งชี้ว่าการสูญหายใน learning_performance_mar มีแนวโน้มสูญหายแบบ MAR อย่างชัดเจน</p>
</section>
</section>
</section>
<section id="การแกปญหาคาสญหาย" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="การแกปญหาคาสญหาย"><span class="header-section-number">3.3</span> การแก้ปัญหาค่าสูญหาย</h3>
<p>การแก้ปัญหาค่าสูญหายสามารถดำเนินการได้หลายลักษณะ ทั้งนี้ก็ขึ้นอยู่กับสาเหตุการสูญหายของข้อมูลด้วย กล่าวคือ หากสาเหตุการสูญหายเกิดขึ้นจากการเก็บรวบรวมข้อมูล จัดกระทำข้อมูล เชื่อมโยงข้อมูล การแก้ปัญหาอาจสามารถทำได้โดย เช่น ค้นหาข้อมูลที่ตกหล่นหายไประหว่างกระบวนการเก็บรวบรวม หรือจัดกระทำข้อมูลให้เหมาะสม ตรวจสอบและปรับวิธีการเชื่อมโยงฐานข้อมูล เพื่อให้ได้ข้อมูลกลับมามากขึ้น</p>
<p>หากการสูญหายเกิดจากปรากฏการณ์สุ่ม ได้แก่ MCAR หรือ MAR ผู้วิเคราะห์อาจแก้ไขได้สองลักษณะ ลักษณะแรกคือใช้การตัดข้อมูลที่สูญหายออกจาการวิเคราะห์ หรือเรียกอีกชื่อหนึ่งว่า complete case analysis การแก้ปัญหาแบบนี้ใช้งานได้ในสถานการณ์แบบ MCAR ลักษณะที่สองคือการทดแทนค่าสูญหาย (missing value imputation) ซึ่งสามารถใช้ได้กับทั้ง MAR และ MCAR การทดแทนค่าสูญหายมีหลายวิธีการ ตั้งแต่การทดแทนแบบง่าย ๆ โดยใช้ค่ากลาง เช่น ค่าเฉลี่ย มัธยฐาน การทดแทนด้วยสมการถดถอย และการทดแทนแบบหลายค่า</p>
<p>หากการสูญหายของข้อมูลเกิดจากสาเหตุเฉพาะที่เรียกว่า MNAR (Missing Not at Random) หรือเกิดจากการที่การสูญหายมีความเกี่ยวข้องกับค่าของตัวแปรที่สูญหายเอง การแก้ปัญหาจะซับซ้อนกว่า เนื่องจากไม่สามารถใช้วิธีการตัดข้อมูลที่สูญหายออกหรือการทดแทนข้อมูลแบบง่ายได้</p>
<p>ในกรณีที่การสูญหายเป็น MNAR ผู้วิเคราะห์อาจจำเป็นต้องใช้วิธีที่เฉพาะเจาะจงสำหรับการจัดการข้อมูลที่สูญหาย ซึ่งอาจรวมถึง:</p>
<ul>
<li><p>การใช้โมเดลสถิติขั้นสูง: เช่น การใช้ dplyr::selection models หรือ Pattern-mixture models ที่ถูกออกแบบมาเพื่อตรวจสอบกลไกการสูญหายของข้อมูลแบบ MNAR โดยจะรวมตัวแปรที่เกี่ยวข้องกับการสูญหายมาในโมเดลด้วย เพื่อสร้างความเป็นไปได้ในการคาดการณ์ค่าที่สูญหาย</p></li>
<li><p>Multiple Imputation แบบปรับแต่ง: ในบางกรณีสามารถใช้การทดแทนหลายครั้ง (multiple imputation) แบบที่รวมถึงการสร้างโมเดลที่สามารถทำนายค่าสูญหายโดยใช้ตัวแปรอื่นๆ ที่สัมพันธ์กับการสูญหายของข้อมูล</p></li>
</ul>
<p>ทั้งนี้วิธีการแก้ปัญหาขึ้นอยู่กับลักษณะและกลไกการสูญหายของข้อมูลที่เกิดขึ้นในแต่ละชุดข้อมูล</p>
<p>บทเรียนนี้จะกล่าวถึงการทดแทนการสูญหายสำหรับ MAR และ MCAR วิธีการทดแทนค่าสูญหายนี้อาจจำแนกได้เป็น 3 กลุ่ม</p>
<ul>
<li><p>Simple imputation</p></li>
<li><p>Donor-based imputation</p></li>
<li><p>Model-based imputation</p></li>
<li><p>Multiple imputation</p></li>
</ul>
<p>รายละเอียดมีดังนี้</p>
<section id="simple-imputation" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="simple-imputation"><span class="header-section-number">3.3.1</span> Simple imputation</h4>
<p>วิธีการนี้เป็นการใช้ค่าสถิติที่เป็นตัวแทนของข้อมูลเป็นค่าทดแทนค่าสูญหายเช่น การทดแทนด้วยค่าเฉลี่ย (mean imputation) หรือการทดแทนด้วยมัธยฐาน (median imputation) วิธีการในกลุ่มนี้สามารถใช้ได้กับการสูญหายแบบ MCAR และในกรณีที่มีข้อมูลสูญหายน้อยมาก ๆ เพราะหากมีข้อมูลสูญหายในปริมาณมากเกินไป การทดแทนลักษณะนี้สามารถบิดเบือนการแจกแจงของข้อมูล ซึ่งนำไปสู่ความลำเอียงของผลการวิเคราะห์ได้ และความลำเอียงนี้เกิดจากตัวผู้วิเคราะห์เองด้วย</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mean_imp =</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar)<span class="sc">==</span>T,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(learning_performance_mar, <span class="at">na.rm =</span> T),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                learning_performance_mar)) <span class="sc">|&gt;</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(learning_performance, learning_performance_mean_imp) <span class="sc">|&gt;</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="sc">~</span>name)<span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mean_imp =</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar)<span class="sc">==</span>T,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(learning_performance_mar, <span class="at">na.rm =</span> T),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                learning_performance_mar)) <span class="sc">|&gt;</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span> learning_performance_mar,<span class="at">y=</span> ach),<span class="at">col =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(learning_performance_mar)<span class="sc">==</span>T),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mean_imp, <span class="at">y=</span>ach), <span class="at">col =</span> <span class="st">"maroon"</span>)<span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">67</span>, <span class="at">y=</span><span class="dv">20</span>, <span class="at">label =</span> <span class="st">"Mean Imputation"</span>, <span class="at">col =</span> <span class="st">"maroon"</span>)<span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mean Imputation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>ผลการวิเคราะห์ด้วยสถิติพื้นฐานด้านล่างแสดงให้เห็นว่าการทดแทนค่าสูญหายด้วยค่าเฉลี่ยนอกจากจะไม่แก้ปัญหาแล้วยังเพิ่มปัญหาไปอีกด้วย ดังนั้นการใช้ mean หรือ median imputation ควรใช้อย่างระมัดระวังมาก ๆ และควรใช้ในกรณีที่ชุดข้อมูลมีค่าสูญหายจำนวนน้อยมาก ๆ เท่านั้น</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mean_imp =</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(<span class="fu">is.na</span>(learning_performance_mar)<span class="sc">==</span>T,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(learning_performance_mar, <span class="at">na.rm =</span> T),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                learning_performance_mar)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"learning_performance"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">cor =</span> <span class="fu">cor</span>(ach,value, <span class="at">use =</span> <span class="st">"complete.obs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  name                           mean    sd   cor
  &lt;chr&gt;                         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 learning_performance           45.8  26.0  0.85
2 learning_performance_mar       56.2  24.3  0.83
3 learning_performance_mcar      45.4  26.0  0.84
4 learning_performance_mean_imp  56.2  18.1  0.52
5 learning_performance_mnar      56.4  21.5  0.82</code></pre>
</div>
</div>
</section>
<section id="donor-based-imputation" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="donor-based-imputation"><span class="header-section-number">3.3.2</span> Donor-based imputation</h4>
<p>วิธีการในกลุ่มนี้มีลักษณะสำคัญคือใช้ข้อมูลจากหน่วยข้อมูลที่คล้ายกัน (หรือที่เรียกว่า “donors”) เพื่อทดแทนค่าสูญหายในชุดข้อมูล วิธีนี้จะค้นหาหน่วยข้อมูลอื่นที่มีลักษณะคล้ายคลึงกันตามตัวแปรที่เกี่ยวข้อง จากนั้นใช้ข้อมูลจากหน่วยนั้นในการเติมค่าที่สูญหาย โดยวิธีการนี้แบ่งออกเป็นหลายเทคนิค เช่น:</p>
<ul>
<li><p>Hot-Deck imputation</p></li>
<li><p>KNN imputation</p></li>
</ul>
<p>Hot-Deck เป็นวิธีการทดแทนค่าสูญหายที่ใช้ข้อมูลจากหน่วยข้อมูลที่คล้ายกันในชุดข้อมูลเพื่อเติมค่าให้กับหน่วยที่มีค่าสูญหาย โดยกระบวนการหลักจะเกี่ยวข้องกับการสุ่มหรือการจับคู่หน่วยข้อมูลที่มีค่าที่สมบูรณ์ (เรียกว่า “donors”) เพื่อทดแทนค่าที่หายไปในหน่วยข้อมูลที่สูญหาย (เรียกว่า “recipients”) วิธีนี้เป็นที่นิยมเนื่องจากมีความยืดหยุ่นและสามารถรักษาคุณลักษณะของข้อมูลจริงได้ดี อย่างไรก็ตามควรใช้วิธีการนี้กับการสูญหายแบบ MCAR</p>
<section id="random-hot-deck-imputation" class="level5" data-number="3.3.2.1">
<h5 data-number="3.3.2.1" class="anchored" data-anchor-id="random-hot-deck-imputation"><span class="header-section-number">3.3.2.1</span> Random Hot-Deck imputation</h5>
<p>การทำ hot-deck imputation ใน R สามารถทำได้จากหลาย library เช่น การใช้ฟังก์ชัน <code>hotdeck()</code> จาก library-VIM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hotdeck</span>(<span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"learning_performance_mcar"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id learning_performance_mcar       ach learning_performance_mcar_imp
1     1                 32.666667 52.159780                         FALSE
2     2                 10.666667 30.784999                         FALSE
3     3                 28.000000 39.607737                         FALSE
4     4                 52.666667 55.985351                         FALSE
5     5                 15.555556 31.800255                         FALSE
6     6                  4.444444 70.544232                          TRUE
7     7                 18.666667 21.153590                         FALSE
8     8                 14.222222  9.963093                         FALSE
9     9                 68.444444 65.028104                         FALSE
10   10                 55.111111 61.423482                         FALSE
11   11                  6.222222 14.158104                         FALSE
12   12                 21.777778 29.131224                         FALSE
13   13                 14.000000 19.246805                         FALSE
14   14                 29.111111 31.566105                         FALSE
15   15                 34.888889 25.048183                          TRUE
16   16                 22.222222 20.244099                         FALSE
17   17                 41.555556 40.828556                         FALSE
18   18                 58.666667 36.332986                          TRUE
19   19                 25.555556 46.742625                         FALSE
20   20                 72.888889 66.304324                         FALSE
21   21                 71.111111 62.449263                         FALSE
22   22                 75.555556 66.015826                         FALSE
23   23                 59.777778 48.727004                         FALSE
24   24                 74.444444 64.040506                         FALSE
25   25                 58.444444 57.483179                         FALSE
26   26                 79.555556 62.591741                         FALSE
27   27                 92.000000 78.382666                         FALSE
28   28                 56.222222 56.778988                         FALSE
29   29                 59.111111 50.250194                         FALSE
30   30                 72.888889 40.991311                          TRUE
31   31                 96.000000 77.102606                         FALSE
32   32                 95.555556 75.104048                         FALSE
33   33                 70.666667 62.338120                         FALSE
34   34                 13.555556 28.622395                         FALSE
35   35                 54.888889 69.627446                          TRUE
36   36                 92.222222 75.121712                         FALSE
37   37                 46.222222 50.194450                         FALSE
38   38                 87.555556 69.170199                         FALSE
39   39                 57.777778 44.172282                         FALSE
40   40                 47.333333 41.376205                         FALSE
41   41                  6.888889 30.019246                          TRUE
42   42                 92.888889 71.456394                         FALSE
43   43                 85.777778 58.758231                         FALSE
44   44                 55.111111 64.209985                         FALSE
45   45                 54.222222 56.074985                          TRUE
46   46                 15.333333 39.152925                          TRUE
47   47                 47.555556 37.733248                         FALSE
48   48                 70.222222 64.015246                         FALSE
49   49                 49.777778 51.034486                         FALSE
50   50                 45.333333 44.634737                         FALSE
51   51                 40.000000 55.853736                          TRUE
52   52                 51.777778 46.939940                         FALSE
53   53                 83.555556 54.989688                         FALSE
54   54                 75.555556 63.740542                          TRUE
55   55                 78.666667 59.107009                         FALSE
56   56                 24.444444 26.200015                         FALSE
57   57                 18.222222 43.873145                          TRUE
58   58                 38.222222 22.100319                         FALSE
59   59                 29.555556 34.259831                         FALSE
60   60                 85.777778 66.461050                         FALSE
61   61                 14.444444 32.162707                         FALSE
62   62                 15.555556 58.365416                          TRUE
63   63                 88.000000 83.414677                         FALSE
64   64                 76.666667 62.701549                         FALSE
65   65                 52.444444 30.956524                         FALSE
66   66                  4.888889 21.851733                         FALSE
67   67                 64.222222 58.775803                         FALSE
68   68                  6.666667 13.652267                         FALSE
69   69                 72.000000 53.825437                         FALSE
70   70                 63.555556 49.410834                         FALSE
71   71                 57.111111 37.053727                         FALSE
72   72                 73.111111 53.280283                         FALSE
73   73                 34.888889 38.677377                         FALSE
74   74                 85.333333 50.593266                          TRUE
75   75                 46.888889 43.748650                         FALSE
76   76                 52.222222 46.067695                         FALSE
77   77                 73.111111 75.109772                         FALSE
78   78                 66.000000 45.427755                         FALSE
79   79                 23.555556 45.626542                         FALSE
80   80                 22.666667 30.503778                          TRUE
81   81                 81.777778 77.445374                         FALSE
82   82                 42.444444 45.643483                         FALSE
83   83                 61.111111 60.622359                         FALSE
84   84                 83.333333 56.835232                         FALSE
85   85                 57.111111 33.327661                          TRUE
86   86                 19.555556 27.784317                         FALSE
87   87                 52.222222 56.888530                         FALSE
88   88                 34.666667 50.461564                         FALSE
89   89                 46.222222 49.933358                         FALSE
90   90                 35.777778 55.340994                          TRUE
91   91                 65.333333 50.887105                          TRUE
92   92                 32.222222 15.133796                         FALSE
93   93                 74.000000 56.835426                         FALSE
94   94                 54.222222 46.046210                         FALSE
95   95                 27.333333  6.453335                         FALSE
96   96                 72.000000 34.214203                          TRUE
97   97                 66.666667 66.149144                         FALSE
98   98                 38.444444 44.499339                          TRUE
99   99                 52.000000 42.697130                         FALSE
100 100                 80.888889 65.974096                         FALSE
101 101                 27.555556 43.254268                         FALSE
102 102                 24.000000 35.658121                         FALSE
103 103                 66.222222 44.935297                         FALSE
104 104                 66.666667 48.099891                         FALSE
105 105                 87.555556 61.750784                         FALSE
106 106                 72.666667 57.868442                         FALSE
107 107                  5.777778 30.761188                         FALSE
108 108                 14.666667 41.999791                         FALSE
109 109                 47.333333 38.840754                         FALSE
110 110                 14.444444 65.887166                          TRUE
111 111                 13.555556 35.707178                         FALSE
112 112                 44.666667 35.507200                         FALSE
113 113                 16.666667 49.100709                          TRUE
114 114                 41.555556 36.318975                         FALSE
115 115                  6.000000 22.355916                         FALSE
116 116                 82.666667 38.026119                          TRUE
117 117                 61.333333 35.804370                         FALSE
118 118                 83.111111 50.911634                         FALSE
119 119                 92.444444 75.021971                         FALSE
120 120                 73.777778 54.064800                         FALSE
121 121                 42.444444 51.889430                         FALSE
122 122                 94.888889 65.228950                         FALSE
123 123                 70.444444 52.851567                         FALSE
124 124                 30.000000 37.275190                         FALSE
125 125                 27.333333 13.821305                         FALSE
126 126                 95.555556 57.457202                         FALSE
127 127                 24.444444 22.061439                          TRUE
128 128                 64.888889 56.852451                          TRUE
129 129                 65.333333 40.024283                          TRUE
130 130                 58.888889 50.740190                         FALSE
131 131                 49.555556 31.850431                         FALSE
132 132                 67.555556 41.138200                         FALSE
133 133                 34.444444 28.476372                         FALSE
134 134                 59.333333 34.960741                         FALSE
135 135                 42.888889 44.887023                         FALSE
136 136                 13.777778 23.997759                         FALSE
137 137                 68.888889 58.155935                         FALSE
138 138                 62.444444 47.359959                         FALSE
139 139                 57.333333 37.669322                         FALSE
140 140                 76.666667 59.758422                         FALSE
141 141                 28.666667 41.681319                         FALSE
142 142                 34.888889 27.254943                         FALSE
143 143                 65.333333 64.881954                          TRUE
144 144                 34.444444 48.565652                          TRUE
145 145                 60.888889 39.621925                         FALSE
146 146                 54.444444 49.987031                         FALSE
147 147                 51.777778 31.404050                         FALSE
148 148                 82.666667 32.254133                          TRUE
149 149                 32.888889 30.471432                         FALSE
150 150                 55.111111 37.540283                         FALSE
151 151                 22.666667 14.857692                         FALSE
152 152                 21.333333  8.775116                         FALSE
153 153                 52.222222 49.111824                         FALSE
154 154                 48.444444 53.570274                         FALSE
155 155                 17.111111 23.832523                          TRUE
156 156                 60.222222 52.873493                         FALSE
157 157                 91.111111 72.204089                         FALSE
158 158                 72.000000 66.837116                         FALSE
159 159                 75.555556 56.445136                         FALSE
160 160                 64.222222 50.464240                         FALSE
161 161                 35.777778 46.902832                         FALSE
162 162                 34.888889 39.359723                         FALSE
163 163                 52.444444 42.730307                         FALSE
164 164                 68.000000 62.396606                         FALSE
165 165                 67.555556 49.526841                         FALSE
166 166                 71.333333 66.743900                         FALSE
167 167                 82.666667 76.485153                         FALSE
168 168                 25.333333 31.837708                         FALSE
169 169                 18.444444 47.889315                         FALSE
170 170                 50.444444 42.519219                         FALSE
171 171                 64.888889 61.230313                         FALSE
172 172                 24.444444 24.254402                          TRUE
173 173                 63.555556 61.744853                         FALSE
174 174                 73.555556 56.143639                         FALSE
175 175                 31.777778 34.491855                         FALSE
176 176                 66.222222 58.595600                         FALSE
177 177                 73.555556 53.014102                         FALSE
178 178                 72.888889 78.282790                         FALSE
179 179                 24.666667 33.885158                         FALSE
180 180                 40.222222 41.210304                         FALSE
181 181                 54.444444 36.605234                         FALSE
182 182                 69.333333 53.084875                         FALSE
183 183                 42.444444 50.931677                         FALSE
184 184                 88.888889 60.301155                         FALSE
185 185                 60.666667 64.463870                         FALSE
186 186                 68.888889 55.116632                         FALSE
187 187                 11.555556 42.239084                         FALSE
188 188                 53.555556 51.485406                         FALSE
189 189                 31.111111 32.725641                         FALSE
190 190                 21.333333 32.683710                         FALSE
191 191                 41.555556 31.133709                         FALSE
192 192                 47.333333 43.249440                         FALSE
193 193                 50.444444 43.313191                         FALSE
194 194                 11.111111 14.222776                         FALSE
195 195                 18.666667 42.406885                         FALSE
196 196                 44.000000 31.748585                         FALSE
197 197                 18.222222 23.596056                         FALSE
198 198                 68.666667 64.481467                         FALSE
199 199                 14.000000 55.381013                          TRUE
200 200                 30.222222 42.313398                         FALSE
201 201                 64.888889 50.508336                         FALSE
202 202                 12.222222 23.335141                         FALSE
203 203                 84.666667 63.220976                         FALSE
204 204                  6.444444 28.981081                         FALSE
205 205                 83.333333 77.229266                         FALSE
206 206                 62.000000 60.107249                         FALSE
207 207                 58.666667 66.404280                         FALSE
208 208                 80.444444 68.368183                         FALSE
209 209                 59.111111 34.418131                          TRUE
210 210                 76.666667 73.302312                          TRUE
211 211                 42.666667 41.822497                         FALSE
212 212                 77.111111 68.120110                         FALSE
213 213                 24.888889 41.915937                         FALSE
214 214                 30.000000 49.977550                         FALSE
215 215                 55.111111 59.180179                          TRUE
216 216                 18.222222 23.282042                         FALSE
217 217                 50.888889 41.042072                         FALSE
218 218                 79.111111 70.732889                         FALSE
219 219                 52.444444 49.425920                         FALSE
220 220                 24.000000 38.570078                         FALSE
221 221                 50.666667 56.095645                         FALSE
222 222                 93.333333 71.486747                         FALSE
223 223                 16.444444 14.683723                         FALSE
224 224                 85.333333 78.023473                         FALSE
225 225                 71.555556 53.918175                          TRUE
226 226                 32.888889  7.134282                         FALSE
227 227                 65.333333 50.825690                         FALSE
228 228                 51.111111 54.410973                         FALSE
229 229                 81.111111 62.451924                         FALSE
230 230                 66.000000 57.541582                         FALSE
231 231                 75.555556 54.018752                         FALSE
232 232                 71.555556 45.298130                         FALSE
233 233                 75.777778 59.804928                         FALSE
234 234                 11.777778 43.324704                          TRUE
235 235                 69.333333 51.363519                         FALSE
236 236                 27.555556 28.273272                         FALSE
237 237                 16.444444 24.113266                          TRUE
238 238                 58.000000 55.881960                         FALSE
239 239                 92.222222 64.906012                          TRUE
240 240                 58.000000 55.142469                         FALSE
241 241                 47.333333 33.701291                         FALSE
242 242                 27.777778 47.520497                         FALSE
243 243                 10.666667 46.841390                          TRUE
244 244                 18.222222 37.643333                         FALSE
245 245                 61.111111 59.791786                         FALSE
246 246                 17.111111 21.722665                         FALSE
247 247                 11.333333 31.465894                         FALSE
248 248                 23.333333 33.017200                         FALSE
249 249                 28.666667 35.689278                         FALSE
250 250                 15.777778 21.051837                         FALSE
251 251                 13.333333 28.400471                         FALSE
252 252                 35.777778 30.394915                         FALSE
253 253                  5.777778 29.078974                         FALSE
254 254                  6.888889 20.737224                         FALSE
255 255                 54.888889 47.651567                         FALSE
256 256                 17.555556 33.561586                         FALSE
257 257                 42.444444 51.189638                          TRUE
258 258                 14.222222  8.627494                         FALSE
259 259                  8.222222 35.217834                         FALSE
260 260                 13.777778 24.199900                         FALSE
261 261                 69.111111 63.115875                         FALSE
262 262                 77.333333 75.414644                         FALSE
263 263                  4.000000 32.476183                         FALSE
264 264                 18.666667  8.308901                         FALSE
265 265                 24.666667 33.544572                         FALSE
266 266                  8.444444 32.348799                         FALSE
267 267                  2.666667 11.355064                         FALSE
268 268                 25.777778 38.317478                         FALSE
269 269                 14.444444 16.405277                          TRUE
270 270                 20.666667 25.710983                         FALSE
271 271                 16.000000 28.886049                         FALSE
272 272                 27.333333 12.463117                          TRUE
273 273                 60.666667 16.043602                          TRUE
274 274                 55.111111 31.130925                          TRUE
275 275                 16.666667 19.103720                         FALSE
276 276                 23.111111 36.898098                         FALSE
277 277                  6.888889 28.683384                         FALSE
278 278                 38.000000 36.756780                         FALSE
279 279                 14.000000 17.165950                          TRUE
280 280                  3.777778  3.523936                         FALSE
281 281                  7.111111  4.104578                         FALSE
282 282                 42.444444 28.787424                          TRUE
283 283                 14.666667 25.572049                         FALSE
284 284                 74.000000 67.400627                         FALSE
285 285                 67.555556 33.433171                          TRUE
286 286                 88.666667 65.625006                         FALSE
287 287                 63.555556 48.700585                          TRUE
288 288                 30.222222 47.570969                         FALSE
289 289                 34.888889 27.611006                          TRUE
290 290                 30.000000 25.583903                         FALSE
291 291                 62.444444 59.882999                         FALSE
292 292                 51.777778 57.971862                          TRUE
293 293                 24.666667 56.152910                          TRUE
294 294                 50.000000 58.409910                         FALSE
295 295                 48.000000 52.001565                         FALSE
296 296                 13.333333 41.641811                         FALSE
297 297                 61.555556 55.656791                         FALSE
298 298                 56.222222 50.260517                          TRUE
299 299                 72.666667 33.866946                          TRUE
300 300                 11.777778 20.548251                         FALSE
301 301                 23.111111 29.525051                         FALSE
302 302                 82.666667 66.370251                          TRUE
303 303                 68.666667 73.963743                         FALSE
304 304                 69.777778 59.119187                         FALSE
305 305                 40.000000 25.112639                         FALSE
306 306                  8.222222  9.983790                         FALSE
307 307                 22.666667 51.034396                          TRUE
308 308                 42.444444 44.577051                          TRUE
309 309                 31.777778 40.190718                         FALSE
310 310                  9.777778 12.832670                         FALSE
311 311                  4.444444 43.452167                         FALSE
312 312                 10.666667 25.832618                         FALSE
313 313                 16.888889 33.534645                         FALSE
314 314                 17.333333 57.879993                          TRUE
315 315                 72.666667 62.285026                         FALSE
316 316                 48.000000 31.360606                         FALSE
317 317                 70.888889 52.089733                         FALSE
318 318                 92.666667 66.334289                         FALSE
319 319                 38.444444 51.842048                         FALSE
320 320                 57.111111 54.756749                         FALSE
321 321                 86.666667 58.143628                         FALSE
322 322                 85.333333 66.552569                         FALSE
323 323                 10.666667 60.607715                          TRUE
324 324                 75.555556 57.928153                         FALSE
325 325                 75.777778 12.430458                          TRUE
326 326                 66.444444 69.995842                          TRUE
327 327                 66.444444 49.603018                         FALSE
328 328                 16.444444 69.705728                          TRUE
329 329                 15.333333 18.791411                         FALSE
330 330                 15.333333  8.238568                         FALSE
331 331                 62.444444 29.615403                         FALSE
332 332                 56.000000 24.805120                         FALSE
333 333                 66.222222 62.073011                         FALSE
334 334                 54.222222 45.535498                         FALSE
335 335                 18.000000 46.463795                         FALSE
336 336                 16.444444  6.769625                         FALSE
337 337                 70.666667 57.353560                         FALSE
338 338                 71.111111 69.222212                         FALSE
339 339                 32.222222 45.088006                         FALSE
340 340                 10.444444 13.881842                         FALSE
341 341                 10.666667 29.331037                         FALSE
342 342                 38.000000 61.639197                          TRUE
343 343                 50.888889 28.315896                         FALSE
344 344                 14.000000 -1.575576                         FALSE
345 345                  8.000000 15.606012                         FALSE
346 346                  5.111111 17.003194                         FALSE
347 347                 17.777778 34.484268                         FALSE
348 348                 54.666667 56.211766                         FALSE
349 349                 34.222222 17.045757                         FALSE
350 350                 81.111111 59.087025                         FALSE
351 351                 18.222222 46.070195                          TRUE
352 352                 28.444444 22.170878                         FALSE
353 353                 58.666667 54.252386                         FALSE
354 354                 24.888889 45.018613                          TRUE
355 355                 79.555556 66.718427                         FALSE
356 356                 24.444444 39.925445                         FALSE
357 357                 21.777778 29.588151                         FALSE
358 358                 13.111111 37.419969                         FALSE
359 359                 36.444444 40.289666                         FALSE
360 360                  6.666667 22.949017                         FALSE
361 361                 15.555556 79.967639                          TRUE
362 362                  6.888889 54.075336                          TRUE
363 363                 27.777778 34.158403                         FALSE
364 364                  6.888889 25.935650                         FALSE
365 365                 47.555556 43.331507                         FALSE
366 366                 13.555556 26.623358                         FALSE
367 367                 52.444444 32.058265                          TRUE
368 368                 59.111111 27.463084                          TRUE
369 369                 84.666667 57.828346                         FALSE
370 370                 24.222222 21.705117                         FALSE
371 371                 22.444444 15.515806                         FALSE
372 372                 28.888889 37.283463                         FALSE
373 373                 19.777778 44.287377                         FALSE
374 374                 14.222222 35.389668                         FALSE
375 375                  6.888889 31.583689                         FALSE
376 376                 10.666667 29.702664                         FALSE
377 377                  7.777778 23.223320                         FALSE
378 378                 48.000000 42.136068                         FALSE
379 379                 47.555556 37.005496                         FALSE
380 380                 30.888889 46.590159                         FALSE
381 381                 65.333333 38.282243                         FALSE
382 382                  8.666667 29.641562                         FALSE
383 383                 28.222222 40.898818                         FALSE
384 384                  8.444444 16.407469                         FALSE
385 385                  7.111111 31.738276                         FALSE
386 386                 17.333333 24.129012                         FALSE
387 387                 70.444444 32.661737                          TRUE</code></pre>
</div>
</div>
<p>อัลกอริทึมข้างต้นเรียกว่า random hot-deck ซึ่งจะทดแทนค่าสูญหายในคอลัมน์ที่กำหนดโดยการสุ่มค่าสังเกตที่มีข้อมูลในคอลัมน์เดียวกัน ดังนั้นการทดแทนค่าสูญหาย เช่น <code>learning_performance_mcar</code> ในหน่วยข้อมูลที่ 3 จะทดแทนโดยการสุ่มค่า learning performance ที่มีข้อมูลเพื่อมาเป็นค่าทดแทนค่าสูญหาย ดังนั้นผลลัพธ์ที่ได้ในแต่ละครั้งอาจไม่เหมือนกัน และเนื่องจากอัลกอริทึมในการสุ่มอย่างง่ายจากข้อมูลที่มีโดยไม่ได้มีการควบคุม ผลลัพธ์ที่ได้จึงอาจบิดเบือนการแจกแจงของข้อมูลรวมทั้งความสัมพันธ์ระหว่างข้อมูล</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar))<span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hotdeck</span>(<span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"learning_performance_mcar"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar))<span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"maroon"</span>,<span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance_mcar, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar, </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> ach, <span class="at">col =</span> <span class="fu">factor</span>(learning_performance_mcar_NA)),</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"l"</span>)<span class="sc">+</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Original Data"</span>)<span class="sc">+</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach) <span class="sc">%&gt;%</span> </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hotdeck</span>(<span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"learning_performance_mcar"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance_mcar, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mcar_imp))<span class="sc">+</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar, </span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> ach, <span class="at">col =</span> <span class="fu">factor</span>(learning_performance_mcar_imp)),</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"l"</span>)<span class="sc">+</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Imputed Data: Random Hot-Deck"</span>)<span class="sc">+</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">+</span>p2)<span class="sc">/</span>(p3<span class="sc">+</span>p4) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conditional-hot-deck-imputation" class="level5" data-number="3.3.2.2">
<h5 data-number="3.3.2.2" class="anchored" data-anchor-id="conditional-hot-deck-imputation"><span class="header-section-number">3.3.2.2</span> Conditional Hot-Deck imputation</h5>
<p>เป็นวิธีการทดแทนข้อมูลสูญหาย (missing data) โดยใช้ข้อมูลที่มีอยู่ในชุดข้อมูลเดียวกันเพื่อทำการสุ่มเลือกค่าทดแทน แต่การสุ่มเลือกค่านี้จะถูกกำหนดโดยตัวแปรเงื่อนไข (domain variable) ซึ่งทำให้กระบวนการสุ่มเลือกค่าทดแทนมีความเฉพาะเจาะจงมากขึ้น กล่าวคือ ค่าที่ถูกใช้ในการทดแทนจะถูกสุ่มมาจากกลุ่มข้อมูลที่มีเงื่อนไขหรือคุณสมบัติที่เหมือนกันกับตัวแปรเงื่อนไขที่กำหนดไว้</p>
<p>ข้อจำกัดของวิธีการนี้คือตัวแปรที่จะทดแทนค่าสูญหายควรมีความสัมพันธ์กับตัวแปรที่ใช้กำหนดเป็นเงื่อนไข เพื่อให้การทดแทนค่าสูญหายมีความแม่นยำมากขึ้น นอกจากนี้การกำหนดตัวแปรเงื่อนไขยังทำได้เฉพาะตัวแปรแบบจัดประเภทอีกด้วย</p>
<p>ตัวอย่างด้านล่างผลการวิเคราะห์เราพบว่าตัวแปร learning_performance มีแนวโน้มสัมพันธ์กับ engage</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">engage =</span> <span class="fu">fct_relevel</span>(engage, <span class="st">"no engage"</span>,<span class="st">"little engage"</span>,<span class="st">"moderate engage"</span>,<span class="st">"much engage"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(engage, learning_performance_mcar))<span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>การกำหนดเงื่อนไขการทดแทนค่าสูญหายโดยใช้ engage เป็นเงื่อนไขจึงมีแนวโน้มที่น่าจะให้ค่าทดแทนค่าสูญหายที่ดีขึ้น</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-43"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-43-1"><a href="#annotated-cell-43-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-43-2"><a href="#annotated-cell-43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-43-3"><a href="#annotated-cell-43-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach, engage) <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-43-4"><a href="#annotated-cell-43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-43-5"><a href="#annotated-cell-43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hotdeck</span>(<span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"learning_performance_mcar"</span>), </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-43-6" class="code-annotation-target"><a href="#annotated-cell-43-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">domain_var =</span> <span class="st">"engage"</span>) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-43-7" class="code-annotation-target"><a href="#annotated-cell-43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance_mcar, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="annotated-cell-43-8"><a href="#annotated-cell-43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="annotated-cell-43-9"><a href="#annotated-cell-43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mcar_imp))<span class="sc">+</span></span>
<span id="annotated-cell-43-10"><a href="#annotated-cell-43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar, </span>
<span id="annotated-cell-43-11"><a href="#annotated-cell-43-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> ach, <span class="at">col =</span> <span class="fu">factor</span>(learning_performance_mcar_imp)),</span>
<span id="annotated-cell-43-12"><a href="#annotated-cell-43-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"l"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-43-13"><a href="#annotated-cell-43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="annotated-cell-43-14"><a href="#annotated-cell-43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Imputed Data: Conditional Hot-Deck1"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-43-15"><a href="#annotated-cell-43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="annotated-cell-43-16"><a href="#annotated-cell-43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-43" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="6" data-code-annotation="1">กำหนด engage เป็นตัวแปรเงื่อนไขในการทดแทนค่าสูญหายใน <code>domain_var</code></span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="7" data-code-annotation="2">สร้าง scatter plot เพื่อพิจารณาการทดแทนข้อมูลสูญหาย</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>p4<span class="sc">+</span>p5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>ประสิทธิภาพของวิธีการนี้ขึ้นกับความสัมพันธ์ระหว่างตัวแปรที่ใช้เป็นเงื่อนไขและตัวแปรที่จะทดแทนค่าสูญหาย สำหรับตัวแปรแบบต่อเนื่อง conditional hot-deck จะใช้การเรียงลำดับชุดข้อมูลใหม่ตามตัวแปรต่อเนื่องที่มีความสัมพันธ์กับตัวแปรที่ต้องการทดแทนค่าสูญหาย จากนั้นเลือกหรือสุ่มข้อมูลสมบูรณ์จากหน่วยข้อมูลที่มีความคล้ายคลึงกับหน่วยข้อมูลที่มีค่าสูญหายเป็นค่าทดแทน</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-45"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-45-1"><a href="#annotated-cell-45-1" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-45-2"><a href="#annotated-cell-45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-45-3"><a href="#annotated-cell-45-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id,learning_performance_mcar, ach, engage) <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-45-4"><a href="#annotated-cell-45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="annotated-cell-45-5"><a href="#annotated-cell-45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hotdeck</span>(<span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"learning_performance_mcar"</span>), </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-45-6" class="code-annotation-target"><a href="#annotated-cell-45-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">domain_var =</span> <span class="st">"engage"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-45-7" class="code-annotation-target"><a href="#annotated-cell-45-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ord_var =</span> <span class="st">"ach"</span>) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-45-8" class="code-annotation-target"><a href="#annotated-cell-45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>learning_performance_mcar, <span class="at">y=</span>ach))<span class="sc">+</span></span>
<span id="annotated-cell-45-9"><a href="#annotated-cell-45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="annotated-cell-45-10"><a href="#annotated-cell-45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mcar_imp))<span class="sc">+</span></span>
<span id="annotated-cell-45-11"><a href="#annotated-cell-45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mcar, </span>
<span id="annotated-cell-45-12"><a href="#annotated-cell-45-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> ach, <span class="at">col =</span> <span class="fu">factor</span>(learning_performance_mcar_imp)),</span>
<span id="annotated-cell-45-13"><a href="#annotated-cell-45-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"l"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-45-14"><a href="#annotated-cell-45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="annotated-cell-45-15"><a href="#annotated-cell-45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Imputed Data: Conditional Hot-Deck2"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-45-16"><a href="#annotated-cell-45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="annotated-cell-45-17"><a href="#annotated-cell-45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-45" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="6" data-code-annotation="1">กำหนด engage เป็นตัวแปรเงื่อนไขในการทดแทนค่าสูญหายใน <code>domain_var</code></span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="7" data-code-annotation="2">กำหนดให้ ach เป็นตัวแปรต่อเนื่องที่ใช้เรียงลำดับหน่วยข้อมูล</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="8" data-code-annotation="3">สร้าง scatter plot เพื่อพิจารณาการทดแทนข้อมูลสูญหาย</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>p4<span class="sc">+</span>p4<span class="sc">+</span>p6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="กจกรรม" class="level5" data-number="3.3.2.3">
<h5 data-number="3.3.2.3" class="anchored" data-anchor-id="กจกรรม"><span class="header-section-number">3.3.2.3</span> กิจกรรม</h5>
<p>ลองทดแทนค่าสูญหายด้วย conditional hot-deck กับสถานการณ์การสูญหายแบบ MAR และ MNAR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>exam_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/choat/Downloads/exam.csv"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>missing_data <span class="ot">&lt;-</span> exam_data <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## สร้างตัวแปรใหม่ที่สูญหายแบบ MAR โดยมีความสัมพันธ์กับ ach และ engage</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>     ach <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">|</span> engage <span class="sc">==</span> <span class="st">"moderate engage"</span>  <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, learning_performance) ,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> learning_performance</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## สร้างตัวแปรใหม่ที่สูญหายแบบ MNAR โดยมีความสัมพันธ์กับ ach และ engage</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">learning_performance_mnar =</span> <span class="fu">case_when</span>(</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    learning_performance <span class="sc">&lt;</span> <span class="dv">30</span>  <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, learning_performance) ,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> learning_performance</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>missing_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 387 × 7
     ach learning_performance ontime_class engage      practice       
   &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;          
 1 52.2                  32.7 used to late no engage   do practice    
 2 30.8                  10.7 used to late much engage do not praction
 3 39.6                  28   never late   much engage do not praction
 4 56.0                  52.7 used to late much engage do practice    
 5 31.8                  15.6 used to late much engage do not praction
 6 70.5                  88.2 used to late much engage do practice    
 7 21.2                  18.7 used to late much engage do not praction
 8  9.96                 14.2 used to late much engage do not praction
 9 65.0                  68.4 used to late much engage do not praction
10 61.4                  55.1 used to late much engage do practice    
# ℹ 377 more rows
# ℹ 2 more variables: learning_performance_mar &lt;dbl&gt;,
#   learning_performance_mnar &lt;dbl&gt;</code></pre>
</div>
</div>
<p><strong>ผลลัพธ์ที่ได้เป็นอย่างไร?</strong></p>
<p>Note: มีอีก library หนึ่งคือ {<code>simputation</code>} ที่สามารถปรับการทดแทนค่าสูญหายในบางอัลกอริทึมได้ละเอียดกว่า</p>
<p><a href="https://github.com/markvanderloo/simputation" class="uri">https://github.com/markvanderloo/simputation</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simputation)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>missing_data <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>learning_performance_mnar) <span class="sc">%&gt;%</span> </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_shd</span>(learning_performance_mar <span class="sc">~</span> ach, <span class="at">pool =</span> <span class="st">"univariate"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach))<span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="knn-imputation" class="level5" data-number="3.3.2.4">
<h5 data-number="3.3.2.4" class="anchored" data-anchor-id="knn-imputation"><span class="header-section-number">3.3.2.4</span> KNN imputation</h5>
<p>วิธีการนี้สามารถใช้ได้กับการสูญหายแบบ MAR ในบางสถานการณ์ วิธีการนี้จะใช้ข้อมูลจากหน่วยข้อมูลที่คล้ายคลึงกันมาเติมเต็มค่าสูญหาย โดยพิจารณาความคล้ายคลึงจากระยะทางระหว่างหน่วยข้อมูลดังกล่าว อัลกอริทึมนี้มี hyperparameter 1 ตัวได้แก่ k หรือจำนวนหน่วยข้อมูลคล้ายคลึงที่จะนำมาเฉลี่ยเพื่อสร้างค่าทดแทนของข้อมูลสูญหาย</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>dat_imp_knn <span class="ot">&lt;-</span> missing_data <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_knn</span>(learning_performance_mar <span class="sc">~</span> ach, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>dat_imp_knn <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach))<span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Imputation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-based-imputation" class="level4" data-number="3.3.3">
<h4 data-number="3.3.3" class="anchored" data-anchor-id="model-based-imputation"><span class="header-section-number">3.3.3</span> Model-Based Imputation</h4>
<p>การทดแทนค่าสูญหายในกลุ่มนี้เป็นการนำโมเดลทางสถิติรวมทั้ง machine learning มาช่วยทดแทนค่าสูญหายในแต่ละตัวแปร หลักการสำคัญของวิธีการในกลุ่มนี้คือการใช้ความสัมพันธ์ระหว่างตัวแปรในชุดข้อมูลเข้ามาช่วยทำนายค่าสูญหาย โดยทั่วไปวิธีการนี้มีลักษณะเด่นดังนี้</p>
<ul>
<li><p>เป็นกระบวนการทวนซ้ำตามตัวแปรที่มีค่าสูญหาย</p></li>
<li><p>แต่ละตัวแปรที่มีค่าสูญหายจะต้องมีการกำหนดโมเดลทำนายค่าสูญหาย</p></li>
<li><p>มีการ train โมเดลสำหรับทำนายค่าสูญหายและใช้โมเดลดังกล่าวในการทำนายค่าสูญหาย</p></li>
<li><p>กระบวนการทดแทนนี้จะทำซ้ำเรียงตามลำดับตัวแปรไปจนกระทั่งค่าทดแทนค่าสูญหายมีแนวโน้มลู่เข้าจึงหยุดกระบวนการ</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="cn">NA</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">c</span>(<span class="dv">34</span>,<span class="dv">22</span>,<span class="dv">65</span>,<span class="dv">87</span>,<span class="dv">23</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">55</span>,<span class="dv">27</span>,<span class="dv">10</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x4 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>example_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2 x3 x4
1  5 34 NA  1
2  1 22 NA  4
3 NA 65 55  2
4  4 87 27  2
5 NA 23 10  1</code></pre>
</div>
</div>
<section id="chain-imputation-algorithm" class="level5" data-number="3.3.3.1">
<h5 data-number="3.3.3.1" class="anchored" data-anchor-id="chain-imputation-algorithm"><span class="header-section-number">3.3.3.1</span> Chain-Imputation Algorithm</h5>
<p>เราออกแบบการทดแทนค่าสูญหายด้วยโมเดลทำนายดังนี้</p>
<ol type="1">
<li><p>ทดแทนค่าสูญหายในตัวแปร<code>x1</code> โดยใช้ตัวแปรที่เหลือในชุดข้อมูลเป็นตัวแปรทำนาย</p></li>
<li><p>ทดแทนค่าสูญหายในตัวแปร <code>x2</code> โดยใช้ตัวแปรที่เหลือในชุดข้อมูล</p></li>
<li><p>ทวนซ้ำโดยแทนค่าที่ทดแทนใน <code>x1</code> กลับไปเป็น <code>NA</code> แล้วทดแทนด้วยข้อมูลที่เหลือ</p></li>
<li><p>…</p></li>
</ol>
<p>ทำไปเรื่อย ๆ จนกระทั่งค่าทดแทนค่าสูญหายไม่เปลี่ยนแปลงหรือลู่เข้า ลองทดลองทำดู</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>missing_data2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/choat/Downloads/exam.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>     ach <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">|</span> engage <span class="sc">==</span> <span class="st">"moderate engage"</span>  <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.3</span>,<span class="cn">NA</span>, learning_performance) ,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> learning_performance</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ach_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    learning_performance_mar <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">|</span> engage <span class="sc">==</span> <span class="st">"little engage"</span> <span class="sc">~</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, ach) ,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> ach</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">practice_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>   ach <span class="sc">&lt;</span><span class="dv">20</span> <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">387</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.8</span>,<span class="cn">NA</span>, practice) ,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">.default =</span> practice</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ach_mar, learning_performance_mar, practice_mar, engage, ontime_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create chain imputation</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>missing_pattern <span class="ot">&lt;-</span> missing_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>ach_imp <span class="ot">&lt;-</span> missing_data2<span class="sc">$</span>ach_mar</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>lp_imp <span class="ot">&lt;-</span> missing_data2<span class="sc">$</span>learning_performance_mar</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>practice_imp <span class="ot">&lt;-</span> missing_data2<span class="sc">$</span>practice_mar</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>missing <span class="ot">&lt;-</span> missing_data2</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> missing <span class="sc">%&gt;%</span> </span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ach_mar =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>ach_mar_NA), <span class="cn">NA</span>, ach_mar)) <span class="sc">%&gt;%</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_lm</span>(ach_mar <span class="sc">~</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">learning_performance_mar =</span> </span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>learning_performance_mar_NA), </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">NA</span>, learning_performance_mar)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_lm</span>(learning_performance_mar <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">practice_mar =</span> </span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>practice_mar_NA), <span class="cn">NA</span>, practice_mar)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(practice_mar <span class="sc">~</span> .)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#impute_lm(ach_mar ~ -learning_performance_mar) %&gt;% </span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#impute_lm(learning_performance_mar ~ practice_mar + engage + ontime_clas)  </span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>missing <span class="ot">&lt;-</span> imp</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>ach_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ach_imp,imp<span class="sc">$</span>ach_mar)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>lp_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lp_imp, imp<span class="sc">$</span>learning_performance_mar)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>practice_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(practice_imp, imp<span class="sc">$</span>practice_mar)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>imp <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation"</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>imp <span class="sc">%&gt;%</span> </span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> ach_mar_NA))<span class="sc">+</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation"</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span>imp <span class="sc">%&gt;%</span> </span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> practice_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">col =</span> practice_mar_NA))<span class="sc">+</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation"</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2<span class="sc">/</span>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="em-algorithm" class="level5" data-number="3.3.3.2">
<h5 data-number="3.3.3.2" class="anchored" data-anchor-id="em-algorithm"><span class="header-section-number">3.3.3.2</span> EM-algorithm</h5>
<p>EM Algorithm (Expectation-Maximization Algorithm) เป็นวิธีการที่ใช้บ่อยในการทดแทนค่าสูญหาย โดยเฉพาะในกรณีที่มีข้อมูลสูญหายแบบ MAR (Missing at Random) ซึ่งข้อมูลสูญหายไม่ได้เป็นอิสระจากข้อมูลอื่น แต่สัมพันธ์กับตัวแปรอื่นในชุดข้อมูล</p>
<ol type="1">
<li><p>Initial Step : ประมาณค่าสูญหายให้เป็นค่าเริ่มต้น</p></li>
<li><p>เข้ากระบวนการ EM</p></li>
</ol>
<ul>
<li><p>E-step (Expectaion): คำนวณ expected value ของค่าสูญหายที่ไม่มีข้อมูล</p></li>
<li><p>M-step (Maximization): ปรับค่าพารามิเตอร์ในโมเดลทำนายค่าสูญหายให้เหมาะสม</p></li>
</ul>
<p>ทวนซ้ำ 2. จนกระทั่งลู่เข้า</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("missMethods")</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missMethods)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>missing_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_EM</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create chain imputation</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>missing_pattern <span class="ot">&lt;-</span> missing_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>imp2 <span class="ot">&lt;-</span> missing_data2</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co">#imp2 %&gt;% arrange(ach_mar)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">#imp2[imp2$ach_mar &lt;0.5,1] &lt;- 0</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>imp1 <span class="ot">&lt;-</span> imp2 <span class="sc">%&gt;%</span> </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ach_mar =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>ach_mar_NA), <span class="cn">NA</span>, ach_mar),</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">learning_performance_mar =</span> </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>learning_performance_mar_NA), </span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">NA</span>, learning_performance_mar)) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_EM</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ach_mar =</span> <span class="fu">ifelse</span>(ach_mar <span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,ach_mar)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">learning_performance_mar =</span> </span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(learning_performance_mar <span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,learning_performance_mar))</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>imp2<span class="ot">&lt;-</span> imp1 <span class="sc">%&gt;%</span> </span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(missing <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">is.numeric</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">practice_mar =</span> </span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(<span class="fu">is.na</span>(missing_pattern<span class="sc">$</span>practice_mar_NA), <span class="cn">NA</span>, practice_mar)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(practice_mar <span class="sc">~</span> .)</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> imp2 <span class="sc">%&gt;%</span> </span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> learning_performance_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> learning_performance_mar_NA))<span class="sc">+</span></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation with EM"</span>)</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>imp2 <span class="sc">%&gt;%</span> </span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a> <span class="fu">bind_cols</span>(missing_data2 <span class="sc">%&gt;%</span> <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"NA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> practice_mar, <span class="at">y =</span> ach_mar))<span class="sc">+</span></span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">col =</span> practice_mar_NA))<span class="sc">+</span></span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>,<span class="st">"maroon"</span>))<span class="sc">+</span></span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model-Based Imputation"</span>)</span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>การประเมินผลกระทบจากการทดแทนค่าสูญหายที่แตกต่างวิธีการสามารถพิจารณาผ่านผลการวิเคราะห์หลักที่ใช้ในการวิจัยได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fit_complete_case <span class="ot">&lt;-</span> <span class="fu">lm</span>(ach_mar <span class="sc">~</span> learning_performance_mar <span class="sc">+</span> practice_mar, <span class="at">data =</span> missing_data2)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fit_model_imp <span class="ot">&lt;-</span> <span class="fu">lm</span>(ach_mar <span class="sc">~</span> learning_performance_mar <span class="sc">+</span> practice_mar, <span class="at">data =</span> imp)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>fit_model_em <span class="ot">&lt;-</span> <span class="fu">lm</span>(ach_mar <span class="sc">~</span> learning_performance_mar <span class="sc">+</span> practice_mar, <span class="at">data =</span> imp2)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_complete_case) <span class="sc">%&gt;%</span> </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">glance</span>(fit_model_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">glance</span>(fit_model_em))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.644         0.641  8.19      197. 1.95e- 49     2  -773. 1554. 1568.
2     0.823         0.822  6.88      876. 2.81e-142     2 -1267. 2542. 2558.
3     0.744         0.743  8.73      558. 2.55e-114     2 -1386. 2781. 2796.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-imputation" class="level4" data-number="3.3.4">
<h4 data-number="3.3.4" class="anchored" data-anchor-id="multiple-imputation"><span class="header-section-number">3.3.4</span> Multiple Imputation</h4>
<p>การทดแทนค่าสูญหายแบบค่าเดียวมีจุดสังเกตหนึ่งที่เป็นปัญหาคือ ค่าสูญหายเป็นค่าที่ไม่ทราบ การทดแทนเพียงค่าเดียวจึงเป็นการละเลยความไม่แน่นอน (ความเป็นไปได้ที่มีหลากหลาย) ของค่าสูญหายนั้น ซึ่งเพิ่มโอกาสของการเกิดความลำเอียงในผลการวิเคราะห์ นอกจากนี้ในกรณีที่ใช้โมเดลทำนายเป็นโมเดลทดแทนค่าสูญหาย การทดแทนแบบค่าเดียวอาจทำให้ผู้วิเคราะห์ประสบปัญหาความแปรปรวนต่ำเกินไป นื่องจากค่าสูญหายทั้งหมดถูกแทนด้วยค่าเดียวที่คำนวณจากโมเดล ทำให้ขาดการสะท้อนความหลากหลายของข้อมูลที่แท้จริง</p>
<p>จากปัญหาดังกล่าวจึงมีการพัฒนาวิธีการทดแทนค่าสูญหายแบบหลายค่า เรียกว่า multiple imputation วิธีการนี้ใช้ประโยชน์จากการสุ่มตัวอย่างแบบใส่คืนมาสร้างตัวอย่าง bootstrap จำนวนหลาย ๆ ชุด โดยแต่ละชุดจะนำมาดำเนินการทดแทนค่าสูญหาย วิเคราะห์ ผลที่ได้จากกระบวนการนี้จะทำให้ผู้วิเคราะห์มีผลการวิเคราะห์จากตัวอย่างดังกล่าวหลายชุด ผลการวิเคราะห์ดังกล่าวจะถูกนำมารวมกันเพื่อคำนวณเป็นค่าประมาณพารามิเตอร์ในโมเดลตามวัตถุประสงค์หลักของการวิจัย</p>
<p><img src="img/MI.png" class="img-fluid"></p>
<p>library สำคัญสำหรับการทำ multiple imputation คือ {<code>mice</code>} การทำงานหลัก ๆ ของ library นี้ประกอบด้วย 3 ขั้นตอนได้แก่ <span class="citation" data-cites="mice">(<a href="#ref-mice" role="doc-biblioref">Buuren and Groothuis-Oudshoorn 2011</a>)</span></p>
<ul>
<li><p><code>mice()</code></p></li>
<li><p><code>with()</code></p></li>
<li><p><code>pool()</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>missing_data2 <span class="sc">%&gt;%</span> <span class="fu">miss_var_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  variable                 n_miss pct_miss
  &lt;chr&gt;                     &lt;int&gt;    &lt;num&gt;
1 ach_mar                     115    29.7 
2 learning_performance_mar     53    13.7 
3 practice_mar                 29     7.49
4 engage                        0     0   
5 ontime_class                  0     0   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-58"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-58-1" class="code-annotation-target"><a href="#annotated-cell-58-1" aria-hidden="true" tabindex="-1"></a>imp_data_mice <span class="ot">&lt;-</span> <span class="fu">mice</span>(missing_data2, <span class="at">m =</span> <span class="dv">5</span>)</span>
<span id="annotated-cell-58-2"><a href="#annotated-cell-58-2" aria-hidden="true" tabindex="-1"></a>lm_mice <span class="ot">&lt;-</span> imp_data_mice <span class="sc">%&gt;%</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-58-3" class="code-annotation-target"><a href="#annotated-cell-58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(ach_mar <span class="sc">~</span> learning_performance_mar <span class="sc">+</span> practice_mar <span class="sc">+</span> engage <span class="sc">+</span> ontime_class))</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-58-4" class="code-annotation-target"><a href="#annotated-cell-58-4" aria-hidden="true" tabindex="-1"></a>lm_mice_pooled <span class="ot">&lt;-</span> <span class="fu">pool</span>(lm_mice)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-58-5" class="code-annotation-target"><a href="#annotated-cell-58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_mice_pooled, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-58" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-58" data-code-lines="1" data-code-annotation="1">สุ่มซ้ำและทดแทนค่าสูญหาย</span>
</dd>
<dt data-target-cell="annotated-cell-58" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-58" data-code-lines="3" data-code-annotation="2">สร้างโมเดลตามวัตถุประสงค์ของการวิจัย</span>
</dd>
<dt data-target-cell="annotated-cell-58" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-58" data-code-lines="4" data-code-annotation="3">รวมผลการวิเคราะห์จากแต่ละชุด</span>
</dd>
<dt data-target-cell="annotated-cell-58" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-58" data-code-lines="5" data-code-annotation="4">สรุปผลการวิเคราะห์</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  ach_mar  learning_performance_mar
  1   2  ach_mar  learning_performance_mar
  1   3  ach_mar  learning_performance_mar
  1   4  ach_mar  learning_performance_mar
  1   5  ach_mar  learning_performance_mar
  2   1  ach_mar  learning_performance_mar
  2   2  ach_mar  learning_performance_mar
  2   3  ach_mar  learning_performance_mar
  2   4  ach_mar  learning_performance_mar
  2   5  ach_mar  learning_performance_mar
  3   1  ach_mar  learning_performance_mar
  3   2  ach_mar  learning_performance_mar
  3   3  ach_mar  learning_performance_mar
  3   4  ach_mar  learning_performance_mar
  3   5  ach_mar  learning_performance_mar
  4   1  ach_mar  learning_performance_mar
  4   2  ach_mar  learning_performance_mar
  4   3  ach_mar  learning_performance_mar
  4   4  ach_mar  learning_performance_mar
  4   5  ach_mar  learning_performance_mar
  5   1  ach_mar  learning_performance_mar
  5   2  ach_mar  learning_performance_mar
  5   3  ach_mar  learning_performance_mar
  5   4  ach_mar  learning_performance_mar
  5   5  ach_mar  learning_performance_mar
                      term     estimate  std.error    statistic      p.value
1              (Intercept) 15.994257853 2.33310541  6.855351574 4.288307e-05
2 learning_performance_mar  0.562885159 0.02828525 19.900308532 1.371906e-12
3  practice_mardo practice  2.052202927 1.18363461  1.733814568 8.401985e-02
4    engagemoderate engage  0.803671122 1.91843330  0.418920543 6.777977e-01
5        engagemuch engage  0.620402986 1.67681028  0.369989971 7.132889e-01
6          engageno engage  0.007758402 2.92975597  0.002648139 9.979108e-01
7 ontime_classused to late  0.761052472 1.06256611  0.716240115 4.751837e-01
    conf.low  conf.high           b        df dfcom        fmi     lambda m
1 10.8003425 21.1881732 2.752717791  10.06529   351 0.66702389 0.60684002 5
2  0.5028486  0.6229217 0.000320938  15.75926   351 0.53666662 0.48137379 5
3 -0.2774565  4.3818623 0.050761355 288.34785   351 0.05004514 0.04347896 5
4 -3.0889691  4.6963114 0.950502122  35.50686   351 0.34575606 0.30991381 5
5 -2.7656889  4.0064948 0.667883248  41.11804   351 0.31745633 0.28504534 5
6 -6.0661414  6.0816582 2.875417089  22.12832   351 0.44958987 0.40199366 5
7 -1.3419683  2.8640733 0.129097033 124.57201   351 0.15073627 0.13720994 5
         riv         ubar
1 1.54349387 2.1401195103
2 0.92817097 0.0004149296
3 0.04545531 1.3400772605
4 0.44909435 2.5397837962
5 0.39869009 2.0102328050
6 0.67222307 5.1329695178
7 0.15903051 0.9741302967</code></pre>
</div>
</div>
<p>ผลการวิเคราะห์ข้างต้นมีค่าสถิติที่สำคัญได้แก่</p>
<ul>
<li><p>lambda (imputation variance) คือสัดส่วนความแปรปรวนที่เกิดจากการทดแทนค่าสูญหาย [0,1] มีค่าสูงแปลว่าความแปรปรวนในการประมาณค่าพารามิเตอร์นี้ส่วนใหญ่เกิดจากการทดแทนค่าสูญหาย</p></li>
<li><p>fmi (fraction of missing information) คือสัดส่วนของข้อมูลสูญหายที่มีผลต่อความไม่แน่นอนในการวิเคราะห์ [0,1]</p></li>
<li><p>riv (relative increase in variance) คืออัตราส่วนความแปรปรวนระหว่างความแปรปรวนที่เกิดจากการทดแทนค่าสูญหายต่อความแปรปรวนส่วนเหลือ</p></li>
<li><p>ubar ค่าเฉลี่ยความแปรปรวนของพารามิเตอร์ที่ได้จากชุดข้อมูลที่ทดแทนค่าสูญหายแต่ละชุด</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>imp_data_mice <span class="sc">%&gt;%</span> <span class="fu">densityplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>imp_data_mice <span class="sc">%&gt;%</span> <span class="fu">densityplot</span>( <span class="sc">~</span> ach_mar<span class="sc">|</span>engage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_data_mice, learning_performance_mar, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-54-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(imp_data_mice, learning_performance_mar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-54-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(imp_data_mice, learning_performance_mar <span class="sc">~</span> practice_mar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_files/figure-html/unnamed-chunk-54-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>

</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-baraldi2010introduction" class="csl-entry" role="listitem">
Baraldi, Amanda N, and Craig K Enders. 2010. <span>“An Introduction to Modern Missing Data Analyses.”</span> <em>Journal of School Psychology</em> 48 (1): 5–37. <a href="https://doi.org/10.1016/j.jsp.2009.10.001">https://doi.org/10.1016/j.jsp.2009.10.001</a>.
</div>
<div id="ref-mice" class="csl-entry" role="listitem">
Buuren, Stef van, and Karin Groothuis-Oudshoorn. 2011. <span>“Mice: Multivariate Imputation by Chained Equations in r.”</span> <em>Journal of Statistical Software</em> 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>.
</div>
<div id="ref-Galimard2018" class="csl-entry" role="listitem">
Galimard, Jean-Emmanuel, Sylvie Chevret, Emmanuel Curis, and Matthieu Resche-Rigon. 2018. <span>“Heckman Imputation Models for Binary or Continuous MNAR Outcomes and MAR Predictors.”</span> <em>BMC Medical Research Methodology</em> 18 (1): 90. <a href="https://doi.org/10.1186/s12874-018-0547-1">https://doi.org/10.1186/s12874-018-0547-1</a>.
</div>
<div id="ref-little2014statistical" class="csl-entry" role="listitem">
Little, Roderick J. A., and Donald B. Rubin. 2014. <em>Statistical Analysis with Missing Data</em>. 3rd ed. Hoboken, NJ: John Wiley &amp; Sons.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>