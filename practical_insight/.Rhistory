5*10
exp(2)
log(10)
log(10, base = 10)
5*10
exp(2)
log(10)
log(10, base = 10)
# 2. การดำเนินการทางคณิตศาสตร์พื้นฐาน
โปรแกรม R มีฟังก์ชันสำหรับการดำเนินงานทางคณิตศาสตร์จำนวนมาก เช่น
1+1
5*10
exp(2)
log(10)
log(10, base = 10)
library(dplyr)
library(tidyr)
library(ggplot2)
set.seed(123)
# สร้างข้อมูลนักเรียน
students <- data.frame(
student_id = 1:100,
school_id = rep(1:10, each = 10),
learning_loss_group = sample(c("high", "medium", "low"), 100, replace = TRUE),
recovery_group = sample(rev(c("high", "medium", "low")), 100, replace = TRUE)
)
# สร้างข้อมูลผลสัมฤทธิ์ทางการเรียน
data <- expand.grid(
student_id = 1:100,
year = seq(1, 10, by = 1)
) %>%
left_join(students, by = "student_id") %>%
group_by(student_id) %>%
mutate(
period = case_when(
year <= 4 ~ "before",
year <= 7 ~ "during",
TRUE ~ "after"
),
learning_loss = case_when(
period == "before" ~ 0,
period == "during" & learning_loss_group == "high" ~ -25 + rnorm(1, mean = 0, sd = 1),
period == "during" & learning_loss_group == "medium" ~ -10 + rnorm(1, mean = 0, sd = 3),
period == "during" & learning_loss_group == "low" ~ -5 + rnorm(1, mean = 0, sd = 5),
period == "after" ~ -5,
TRUE ~ 0
),
recovery = case_when(
period == "before" ~ 0,
period == "during" ~ 0,
period == "after" & recovery_group == "high" ~ 5.5 * (year - 7) + rnorm(1, mean = 0, sd = 1),
period == "after" & recovery_group == "medium" ~ -5 * (year - 7) + rnorm(1, mean = 0, sd = 0.05),
period == "after" & recovery_group == "low" ~ -10.5 * (year - 7) + rnorm(1, mean = 0, sd = 0.08),
TRUE ~ 0
),
score = 50 + 0.5 * year + learning_loss + recovery + rnorm(n(), mean = 0, sd = 5)
) %>%
ungroup()
# ดูข้อมูล
data
# พล็อตข้อมูล
data %>%
mutate(period = factor(period , levels=c("before","during","after"))) %>%
ggplot(aes(x = year, y = score, group = student_id, color = learning_loss_group)) +
geom_line(alpha = 0.5) +
labs(title = "Learning Loss and Recovery Simulation",
x = "Year",
y = "Score") +
theme_minimal()
library(brms)
# กำหนดตัวแปร Dummy สำหรับช่วงเวลา (ตัวแปร S ในสมการ)
data <- data %>%
mutate(
during = ifelse(year > 4 & year <= 7, 1, 0),
after = ifelse(year > 7, 1, 0),
year_during = ifelse(during == 1, year - 5, 0),  # ปรับเลื่อนแกนเวลาในช่วง during
year_after = ifelse(after == 1, year - 8, 0)    # ปรับเลื่อนแกนเวลาในช่วง after
)
formula <- bf(
score ~ 1 + during + after + year +  year_during + year_after +
(1 + during + after + year + year_during + year_after | student_id) +
(1 + during + after + year + year_during + year_after | school_id),
nl = F
)
fit <- brm(
formula = formula,
data = data,
family = gaussian(),
#prior = priors,
chains = 4,
iter = 2000,
thin = 4,
cores = getOption("mc.cores", 4)
)
summary(fit)
library(readxl)
messy_dat <- read_excel("dataset/messydata.xlsx")
library(readxl)
messy_dat <- read_excel("messydata.xlsx")
library(readxl)
messy_dat <- read_excel("dataset/messydata.xlsx")
messy_dat <- read_excel("dataset/messydata.xlsx")
messy_dat <- read_excel("dataset/messydata.xlsx")
messy_dat
