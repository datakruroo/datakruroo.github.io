"0","library(dplyr)"
"2","
Attaching package: ‘dplyr’

"
"2","The following objects are masked from ‘package:stats’:

    filter, lag

"
"2","The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

"
"0","library(tidyr)"
"0","library(ggplot2)"
"0",""
"0","set.seed(123)"
"0",""
"0",""
"0","# สร้างข้อมูลนักเรียน"
"0","students <- data.frame("
"0","  student_id = 1:100,"
"0","  school_id = rep(1:10, each = 10),"
"0","  learning_loss_group = sample(c(""high"", ""medium"", ""low""), 100, replace = TRUE),"
"0","  recovery_group = sample(rev(c(""high"", ""medium"", ""low"")), 100, replace = TRUE)"
"0",")"
"0",""
"0","# สร้างข้อมูลผลสัมฤทธิ์ทางการเรียน"
"0","data <- expand.grid("
"0","  student_id = 1:100,"
"0","  year = seq(1, 10, by = 1)"
"0",") %>%"
"0","  left_join(students, by = ""student_id"") %>%"
"0","  group_by(student_id) %>%"
"0","  mutate("
"0","    period = case_when("
"0","      year <= 4 ~ ""before"","
"0","      year <= 7 ~ ""during"","
"0","      TRUE ~ ""after"""
"0","    ),"
"0","    learning_loss = case_when("
"0","      period == ""before"" ~ 0,"
"0","      period == ""during"" & learning_loss_group == ""high"" ~ -25 + rnorm(1, mean = 0, sd = 1),"
"0","      period == ""during"" & learning_loss_group == ""medium"" ~ -10 + rnorm(1, mean = 0, sd = 3),"
"0","      period == ""during"" & learning_loss_group == ""low"" ~ -5 + rnorm(1, mean = 0, sd = 5),"
"0","      period == ""after"" ~ -5,"
"0","      TRUE ~ 0"
"0","    ),"
"0","    recovery = case_when("
"0","      period == ""before"" ~ 0,"
"0","      period == ""during"" ~ 0,"
"0","      period == ""after"" & recovery_group == ""high"" ~ 5.5 * (year - 7) + rnorm(1, mean = 0, sd = 1),"
"0","      period == ""after"" & recovery_group == ""medium"" ~ -5 * (year - 7) + rnorm(1, mean = 0, sd = 0.05),"
"0","      period == ""after"" & recovery_group == ""low"" ~ -10.5 * (year - 7) + rnorm(1, mean = 0, sd = 0.08),"
"0","      TRUE ~ 0"
"0","    ),"
"0","    score = 50 + 0.5 * year + learning_loss + recovery + rnorm(n(), mean = 0, sd = 5)"
"0","  ) %>%"
"0","  ungroup()"
"0","# ดูข้อมูล"
"0","data"
