[
  {
    "objectID": "materials/07HLMs.html#hsb-dataset",
    "href": "materials/07HLMs.html#hsb-dataset",
    "title": "Hierarchical Linear Modelling",
    "section": "HSB Dataset",
    "text": "HSB Dataset\n\nHSB = HighSchool & Beyond Survey (Raudenbush & Bryk, 2002)\n\nmathach = ผลสัมฤทธิ์ทางการเรียนคณิตศาสตร์ของนักเรียน\nses = เศรษฐานะของนักเรียน\nsector = ประเภทของโรงเรียน (1 = Catholic, 0 = Public)\nschid = รหัสโรงเรียนของนักเรียน\n\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(haven)\nlibrary(descriptr)\ndat <- read_spss(\"datasets/HSB.SAV\")\nglimpse(dat)\n\nRows: 7,185\nColumns: 4\n$ schid   <chr> \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\"…\n$ sector  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ ses     <dbl> -1.528, -0.588, -0.528, -0.668, -0.158, 0.022, -0.618, -0.998,…\n$ mathach <dbl> 5.876, 19.708, 20.349, 8.781, 17.898, 4.583, -2.832, 0.523, 1.…"
  },
  {
    "objectID": "materials/07HLMs.html#hierarchical-general-linear-models",
    "href": "materials/07HLMs.html#hierarchical-general-linear-models",
    "title": "Hierarchical Linear Modelling",
    "section": "Hierarchical General Linear models",
    "text": "Hierarchical General Linear models\n\nOne-way ANOVA with random effect model\nMeans as outcomes regression model (random intercept model)\nOne-way ANCOVA with random effect model\nNon-randomly varying slopes\nRandom-coefficient regression model\nIntercept-and-slope as outcome model"
  },
  {
    "objectID": "materials/07HLMs.html#กจกรรม-5-นาท",
    "href": "materials/07HLMs.html#กจกรรม-5-นาท",
    "title": "Hierarchical Linear Modelling",
    "section": "กิจกรรม (5 นาที)",
    "text": "กิจกรรม (5 นาที)\n\nคำนวณค่าเฉลี่ยของ mathach ระดับโรงเรียน จะมีค่าเฉลี่ยกี่ค่า?\nค่าเฉลี่ย mathach ของโรงเรียนมีความแตกต่างกันอย่างไร?"
  },
  {
    "objectID": "materials/07HLMs.html#modelling",
    "href": "materials/07HLMs.html#modelling",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling",
    "text": "Modelling\n\n\nstudent-level model\n\\(math_{ij} = \\beta_{0j} + \\epsilon_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} + u_{0j}\\)\ncombined model\n\\(math_{ij} = \\gamma_{00} + u_{0j} + \\epsilon_{ij}\\)\n\n\n\n\nมีข้อตกลงเบื้องต้นคือ\n\n\\(\\epsilon_{ij} \\sim N(0, \\sigma^2)\\)\n\\(u_{0j} \\sim N(0, \\tau_{00})\\)\n\nเรียก \\(\\sigma^2\\) = level-1 variance และ \\(\\tau_{00}\\) = level-2 variance\nโมเดลข้างต้นมีพารามิเตอร์กี่ตัว อะไรบ้าง และพารามิเตอร์แต่ละตัวมีความหมาย/ให้สารสนเทศอะไร"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-parameter-estimation",
    "href": "materials/07HLMs.html#modelling-parameter-estimation",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: parameter estimation",
    "text": "Modelling: parameter estimation\n\nlibrary(lme4)\nlibrary(lmerTest)\nfit_nullmodel <- lmer(mathach ~ 1 + (1|schid), data = dat)\nsummary(fit_nullmodel)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: mathach ~ 1 + (1 | schid)\n   Data: dat\n\nREML criterion at convergence: 47116.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.0631 -0.7539  0.0267  0.7606  2.7426 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n schid    (Intercept)  8.614   2.935   \n Residual             39.148   6.257   \nNumber of obs: 7185, groups:  schid, 160\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(>|t|)    \n(Intercept)  12.6370     0.2444 156.6473   51.71   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-พารามเตอรสำคญ",
    "href": "materials/07HLMs.html#modelling-พารามเตอรสำคญ",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: พารามิเตอร์สำคัญ",
    "text": "Modelling: พารามิเตอร์สำคัญ\nOne-way ANOVA with random effect มักใช้เป็นโมเดลเพื่อตรวจสอบโครงสร้างระดับลดหลั่นของข้อมูล สารสนเทศสำคัญ ได้แก่ point estimate และ interval estimate ของ\n\n\\(\\gamma_{00}\\)\n\\(\\sigma^2\\)\n\\(\\tau_{00}\\)\nIntraclass correlation = \\(\\rho = \\frac{\\tau_{00}}{\\tau_{00} + \\sigma^2}\\)\n\nมีฟังก์ชันที่สำคัญสองตัวได้แก่\n\nconfint(fit_nullmodel) ซึ่งจะให้ช่วงความเชื่อมั่นของค่าประมาณพารามิเตอร์ของโมเดล\nranova(fit_nullmodel) จะให้ผลการทดสอบอัตราส่วนภาวะความน่าจะเป็น (likelihood ratio test) ของ random effect term ในโมเดล"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-ชวงความเชอมน",
    "href": "materials/07HLMs.html#modelling-ชวงความเชอมน",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: ช่วงความเชื่อมั่น",
    "text": "Modelling: ช่วงความเชื่อมั่น\nผลการวิเคราะห์นี้ให้สารสนเทศอะไร ใช้ประโยชน์อะไรได้บ้าง?\n\nconfint(fit_nullmodel, level = 0.95)\n\nComputing profile confidence intervals ...\n\n\n                2.5 %    97.5 %\n.sig01       2.594729  3.315880\n.sigma       6.154803  6.361786\n(Intercept) 12.156289 13.117121"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-test-for-random-effects",
    "href": "materials/07HLMs.html#modelling-test-for-random-effects",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Test for Random-Effects",
    "text": "Modelling: Test for Random-Effects\n\\(H_0: \\tau_{00} =0\\) vs \\(H_1: \\tau_{00}>0\\)\n\nranova(fit_nullmodel)\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nmathach ~ (1 | schid)\n            npar logLik   AIC    LRT Df Pr(>Chisq)    \n<none>         3 -23558 47123                         \n(1 | schid)    2 -24052 48107 986.12  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nIn certain cases tests of non-nested models may be generated. An example is when (0 + poly(x, 2) | gr) is reduced (the default) to (1 | gr). To our best knowledge non-nested model comparisons are only generated in cases which are statistical nonsense anyway (such as in this example where the random intercept is suppressed).\nNote that anova can be used to compare two models and will often be able to produce the same tests as ranova. This is, however, not always the case as illustrated in the examples."
  },
  {
    "objectID": "materials/07HLMs.html#icc",
    "href": "materials/07HLMs.html#icc",
    "title": "Hierarchical Linear Modelling",
    "section": "ICC",
    "text": "ICC\n\\[\n\\rho = \\frac{\\tau_{00}}{\\tau_{00} + \\sigma^2}\n\\]\n\nThe ICC can be interpreted as “the proportion of the variance explained by the grouping structure in the population”\nICC indexes how strongly measurements in the same group resemble each other\nthe ICC - sometimes conceptualized as the measurement repeatability - “can also be interpreted as the expected correlation between two randomly drawn units that are in the same group” (Hox 2010: 15)\n\nNote: This definition might not apply to mixed models with more complex random effects structures"
  },
  {
    "objectID": "materials/07HLMs.html#icc-1",
    "href": "materials/07HLMs.html#icc-1",
    "title": "Hierarchical Linear Modelling",
    "section": "ICC",
    "text": "ICC\n\n#install.packages(\"performance\")\nlibrary(performance)\n#insight::get_variance(fit_nullmodel)\nicc(fit_nullmodel)\n\n# Intraclass Correlation Coefficient\n\n    Adjusted ICC: 0.180\n  Unadjusted ICC: 0.180\n\n\n\nicc() calculates an adjusted and an unadjusted ICC, which both take all sources of uncertainty (i.e. of all random effects) into account. While the adjusted ICC only relates to the random effects, the unadjusted ICC also takes the fixed effects variances into account\nThe fixed effects variance is added to the denominator of the formula to calculate the ICC"
  },
  {
    "objectID": "materials/07HLMs.html#r2",
    "href": "materials/07HLMs.html#r2",
    "title": "Hierarchical Linear Modelling",
    "section": "R2",
    "text": "R2\n\nThe coefficient of determination R2 quantifies the proportion of variance explained by a statistical model. More precisely, R2 is the proportion of the explained variance (of the full model)\n\n\nr2(fit_nullmodel)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.180\n     Marginal R2: 0.000\n\n\n\nR2 กับ ICC แตกต่างกันหรือไม่ อย่างไร?"
  },
  {
    "objectID": "materials/07HLMs.html#estimated-value-of-beta_0j",
    "href": "materials/07HLMs.html#estimated-value-of-beta_0j",
    "title": "Hierarchical Linear Modelling",
    "section": "Estimated value of \\(\\beta_{0j}\\)",
    "text": "Estimated value of \\(\\beta_{0j}\\)\nNull model จะให้ค่าประมาณของค่าเฉลี่ยระดับกลุ่ม (ในที่นี้คือค่าเฉลี่ยผลสัมฤทธิ์ทางการเรียนคณิตศาสตร์) ซึ่งสามารถคำนวณได้ดังนี้\n\nbeta0j <- coef(fit_nullmodel)\nbeta0j$schid %>% summary()\n\n  (Intercept)    \n Min.   : 5.234  \n 1st Qu.:10.731  \n Median :12.871  \n Mean   :12.637  \n 3rd Qu.:14.463  \n Max.   :19.115"
  },
  {
    "objectID": "materials/07HLMs.html#writting-report",
    "href": "materials/07HLMs.html#writting-report",
    "title": "Hierarchical Linear Modelling",
    "section": "Writting Report",
    "text": "Writting Report\n\nที่มา : Randenbush & Bryk (2002)"
  },
  {
    "objectID": "materials/07HLMs.html#กจกรรม-2-นาท",
    "href": "materials/07HLMs.html#กจกรรม-2-นาท",
    "title": "Hierarchical Linear Modelling",
    "section": "กิจกรรม (2 นาที)",
    "text": "กิจกรรม (2 นาที)\nค่าเฉลี่ยผลสัมฤทธิ์ทางการเรียนคณิตศาสตร์ระดับโรงเรียนมีความแตกต่างกันระหว่างสังกัดของโรงเรียนอย่างไร?"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-1",
    "href": "materials/07HLMs.html#modelling-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling",
    "text": "Modelling\n\nstudent-level model\n\\(math_{ij} = \\beta_{0j} + \\epsilon_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} +\\gamma_{01}W_j+u_{0j}\\)\ncombined model\n\\(math_{ij} = \\gamma_{00} + \\gamma_{01}W_j +u_{0j} + \\epsilon_{ij}\\)\n\n\n\n\n\n\n\n\nมีข้อตกลงเบื้องต้นคือ\n\n\\(\\epsilon_{ij} \\sim N(0, \\sigma^2)\\)\n\\(u_{0j} \\sim N(0, \\tau_{00})\\)\n\n\nโมเดลนี้มีพารามิเตอร์อะไรบ้าง และมีความหมายอย่างไร\nพารามิเตอร์เดิมที่อยู่ภายในโมเดลมีความหมายเหมือนหรือแตกต่างไปจาก null model อย่างไร"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-parameter-estimation-1",
    "href": "materials/07HLMs.html#modelling-parameter-estimation-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: parameter estimation",
    "text": "Modelling: parameter estimation\n\nfit_randIntercept <- lmer(mathach ~ 1 + sector + (1|schid), data = dat)\nsummary(fit_randIntercept)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: mathach ~ 1 + sector + (1 | schid)\n   Data: dat\n\nREML criterion at convergence: 47080.1\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.0130 -0.7523  0.0253  0.7602  2.7472 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n schid    (Intercept)  6.677   2.584   \n Residual             39.151   6.257   \nNumber of obs: 7185, groups:  schid, 160\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(>|t|)    \n(Intercept)  11.3930     0.2928 158.5371  38.907  < 2e-16 ***\nsector        2.8049     0.4391 153.5006   6.388  1.9e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n       (Intr)\nsector -0.667"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-confidence-interval",
    "href": "materials/07HLMs.html#modelling-confidence-interval",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Confidence Interval",
    "text": "Modelling: Confidence Interval\n\nconfint(fit_randIntercept)\n\nComputing profile confidence intervals ...\n\n\n                2.5 %    97.5 %\n.sig01       2.265614  2.918854\n.sigma       6.155051  6.362058\n(Intercept) 10.819305 11.966760\nsector       1.944660  3.665259"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-test-for-random-effects-1",
    "href": "materials/07HLMs.html#modelling-test-for-random-effects-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Test for random effects",
    "text": "Modelling: Test for random effects\nผลการวิเคราะห์ด้านล่างเป็นการทดสอบอะไร?\n\nranova(fit_randIntercept)\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nmathach ~ sector + (1 | schid)\n            npar logLik   AIC    LRT Df Pr(>Chisq)    \n<none>         4 -23540 47088                         \n(1 | schid)    3 -23900 47805 719.29  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-icc",
    "href": "materials/07HLMs.html#modelling-icc",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: ICC",
    "text": "Modelling: ICC\nadjusted กับ unadjusted ICC มีความหมายแตกต่างกันอย่างไร\n\nicc(fit_randIntercept)\n\n# Intraclass Correlation Coefficient\n\n    Adjusted ICC: 0.146\n  Unadjusted ICC: 0.140\n\ninsight::get_variance(fit_randIntercept)\n\n$var.fixed\n[1] 1.966748\n\n$var.random\n[1] 6.676957\n\n$var.residual\n[1] 39.1514\n\n$var.distribution\n[1] 39.1514\n\n$var.dispersion\n[1] 0\n\n$var.intercept\n   schid \n6.676957"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-variance-explained",
    "href": "materials/07HLMs.html#modelling-variance-explained",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Variance Explained",
    "text": "Modelling: Variance Explained\n\nr2(fit_randIntercept)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.181\n     Marginal R2: 0.041"
  },
  {
    "objectID": "materials/07HLMs.html#multiparameter-tests-deviance-test",
    "href": "materials/07HLMs.html#multiparameter-tests-deviance-test",
    "title": "Hierarchical Linear Modelling",
    "section": "Multiparameter tests (Deviance Test)",
    "text": "Multiparameter tests (Deviance Test)\nนอกจากการทดสอบสมมุติฐานเพื่อตรวจสอบนัยสำคัญของพารามิเตอร์ภายในโมเดลเป็นรายตัวแล้ว เราสามารถทำการตรวจสอบนัยสำคัญของพารามิเตอร์หลายตัวพร้อมกันได้ด้วย ซึ่งมีประโยชน์ในเชิงของการเปรียบเทียบโมเดลคู่แข่งขัน (nested model) วิธีการหนึ่งที่สามารถนำมาใช้ได้เรียกว่า likelihood ratio test\nสมมุติต้องการเปรียบเทียบระหว่าง null model กับ โมเดลในกิจกรรมที่ผ่านมา (M2 model) สามารถดำเนินการได้ดังนี้\n\\[\nH_0: M_{null} = M_2\n\\\\\nH_1: M_{null} \\neq M_2\n\\]\n\nคำนวณ \\(D_0 = -2log(L_{null})\\) เรียกค่านี้ว่า deviance ของ null model\nคำนวณ \\(D_2 = -2log(L_{M2})\\) เรียกค่านี้ว่า deviance ของ M2 model\nภายใต้ \\(H_0\\) เป็นจริง \\(\\chi^2 = D_0 - D_2 \\sim \\chi^2_{df}\\) เมื่อ \\(df\\) คือผลต่างของจำนวนพารามิเตอร์ระหว่างโมเดลคู่แข่งขันทั้งสอง"
  },
  {
    "objectID": "materials/07HLMs.html#multiparameter-tests",
    "href": "materials/07HLMs.html#multiparameter-tests",
    "title": "Hierarchical Linear Modelling",
    "section": "Multiparameter tests",
    "text": "Multiparameter tests\n\nanova(fit_nullmodel, fit_randIntercept)\n\nrefitting model(s) with ML (instead of REML)\n\n\nData: dat\nModels:\nfit_nullmodel: mathach ~ 1 + (1 | schid)\nfit_randIntercept: mathach ~ 1 + sector + (1 | schid)\n                  npar   AIC   BIC logLik deviance  Chisq Df Pr(>Chisq)    \nfit_nullmodel        3 47122 47142 -23558    47116                         \nfit_randIntercept    4 47087 47115 -23540    47079 36.705  1  1.374e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "materials/07HLMs.html#กจกรรม-5-6-นาท",
    "href": "materials/07HLMs.html#กจกรรม-5-6-นาท",
    "title": "Hierarchical Linear Modelling",
    "section": "กิจกรรม (5-6 นาที)",
    "text": "กิจกรรม (5-6 นาที)\nวิเคราะห์และแปลผลโมเดลต่อไปนี้\n\nstudent-level model\n\\(math_{ij} = \\beta_{0j} + \\epsilon_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} +\\gamma_{01}Sector_j+ \\gamma_{02}MeanSES + u_{0j}\\)\ncombined model\n\\(math_{ij} = \\gamma_{00} +\\gamma_{01}Sector_j+ \\gamma_{02}MeanSES +u_{0j} + \\epsilon_{ij}\\)"
  },
  {
    "objectID": "materials/07HLMs.html#writting-report-1",
    "href": "materials/07HLMs.html#writting-report-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Writting Report",
    "text": "Writting Report\n\nที่มา : Raudenbush & Bryk (2002)"
  },
  {
    "objectID": "materials/07HLMs.html#random-intercept-model",
    "href": "materials/07HLMs.html#random-intercept-model",
    "title": "Hierarchical Linear Modelling",
    "section": "Random Intercept model",
    "text": "Random Intercept model\n\nlibrary(gridExtra)\n\n\nAttaching package: 'gridExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\ntemp<-dat%>%\n  group_by(schid) %>%\n  summarise(meanses = mean(ses)) %>%\n  left_join(dat,., by=\"schid\")\nfit<- lmer(mathach ~ 1 + meanses + (1|schid), data = temp)\ncoef<-coef(fit)\ncoef <- data.frame(coef$schid, schid = rownames(coef$schid)) %>%\n  rename(group_intercept = X.Intercept.,\n         meanses_slope = meanses)\nset.seed(123)\nsubset <- sample(temp$schid,10)\np1<-coef %>% filter(schid %in% subset) %>%\n  ggplot()+\n  geom_point(data = temp %>%\n               filter(schid %in% subset), \n             aes(x=ses, y=mathach, col = schid),\n             alpha=0.5,\n             show.legend = F)+\n  geom_abline(aes(intercept = group_intercept,\n                  slope = meanses_slope, col = schid),\n              show.legend = F)+\n  scale_x_continuous(limits = c(-2,3))+\n  theme_light()+\n  ggtitle(\"random intercept model (10 schools)\")\n\np2<-coef %>%\n  ggplot()+\n  geom_point(data = temp,\n             aes(x=ses, y=mathach),\n             alpha=0.3,\n             show.legend = F)+\n  geom_abline(aes(intercept = group_intercept,\n                  slope = meanses_slope), alpha = 0.3,\n              show.legend = F)+\n  theme_light()+\n  scale_x_continuous(limits = c(-2,3))+\n  ggtitle(\"random intercept model (all schools)\")\ngrid.arrange(p1,p2, ncol=2)\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\nWarning: Removed 41 rows containing missing values (`geom_point()`)."
  },
  {
    "objectID": "materials/07HLMs.html#กจกรรม-5-นาท-1",
    "href": "materials/07HLMs.html#กจกรรม-5-นาท-1",
    "title": "Hierarchical Linear Modelling",
    "section": "กิจกรรม (5 นาที)",
    "text": "กิจกรรม (5 นาที)\nความสัมพันธ์ระหว่าง mathach กับ ses ของนักเรียนมีความเหมือนหรือแตกต่างกันระหว่างโรงเรียนอย่างไร"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-2",
    "href": "materials/07HLMs.html#modelling-2",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling",
    "text": "Modelling\n\nstudent-level model\n\\(math_{ij} = \\beta_{0j} + \\beta_{1j} SES_{ij} + \\epsilon_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} +u_{0j}\\)\n\\(\\beta_{1j} = \\gamma_{10}+u_{1j}\\)\ncombined model (เขียนเอง กิจกรรม 1 นาที)\n\n\n\n\n\n\n\n\nมีข้อตกลงเบื้องต้นคือ\n\n\\(\\epsilon_{ij} \\sim N(0, \\sigma^2)\\)\n\\(\\bf{u} \\sim N(0, T)\\) โดยที่ \\(\\bf{u} = (u_{0j}, u_{1j})^T\\) และ \\(T = \\begin{pmatrix} \\tau_{00} & \\tau_{01} \\\\ \\tau_{10} & \\tau_{11}\\end{pmatrix}\\)\n\n\nโมเดลนี้มีพารามิเตอร์อะไรบ้าง และมีความหมายอย่างไร"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-parameter-estimation-2",
    "href": "materials/07HLMs.html#modelling-parameter-estimation-2",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Parameter Estimation",
    "text": "Modelling: Parameter Estimation\n\nfit_randCoeff <- lmer(mathach ~ 1 + ses + (1 + ses|schid), data = dat)\nsummary(fit_randCoeff)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: mathach ~ 1 + ses + (1 + ses | schid)\n   Data: dat\n\nREML criterion at convergence: 46640.4\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-3.12272 -0.73046  0.02144  0.75610  2.94356 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n schid    (Intercept)  4.8287  2.1974        \n          ses          0.4129  0.6426   -0.11\n Residual             36.8301  6.0688        \nNumber of obs: 7185, groups:  schid, 160\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(>|t|)    \n(Intercept)  12.6650     0.1898 145.5479   66.71   <2e-16 ***\nses           2.3938     0.1181 157.5299   20.27   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n    (Intr)\nses -0.045"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-confidence-interval-1",
    "href": "materials/07HLMs.html#modelling-confidence-interval-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Confidence Interval",
    "text": "Modelling: Confidence Interval\n\nconfint(fit_randCoeff)\n\nComputing profile confidence intervals ...\n\n\nWarning in FUN(X[[i]], ...): non-monotonic profile for .sig02\n\n\nWarning in confint.thpr(pp, level = level, zeta = zeta): bad spline fit for\n.sig02: falling back to linear interpolation\n\n\n                  2.5 %     97.5 %\n.sig01       1.91159331  2.5112989\n.sig02      -1.00000000  0.3078580\n.sig03       0.08487641  0.9666694\n.sigma       5.96867353  6.1719565\n(Intercept) 12.28852890 13.0406703\nses          2.15925014  2.6317003"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-level-1-intercepts-and-slopes",
    "href": "materials/07HLMs.html#modelling-level-1-intercepts-and-slopes",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Level-1 Intercepts and Slopes",
    "text": "Modelling: Level-1 Intercepts and Slopes\n\ncoef<-coef(fit_randCoeff)\ncoef <- data.frame(coef$schid, schid = rownames(coef$schid))\nhead(coef)\n\n     X.Intercept.      ses schid\n1224    11.060022 2.504083  1224\n1288    13.073615 2.477930  1288\n1296     9.197291 2.352981  1296\n1308    14.384652 2.309294  1308\n1317    12.449142 2.237431  1317\n1358    11.520351 2.753447  1358"
  },
  {
    "objectID": "materials/07HLMs.html#writting-report-2",
    "href": "materials/07HLMs.html#writting-report-2",
    "title": "Hierarchical Linear Modelling",
    "section": "Writting Report",
    "text": "Writting Report"
  },
  {
    "objectID": "materials/07HLMs.html#modelling-level-1-intercepts-and-slopes-1",
    "href": "materials/07HLMs.html#modelling-level-1-intercepts-and-slopes-1",
    "title": "Hierarchical Linear Modelling",
    "section": "Modelling: Level-1 Intercepts and Slopes",
    "text": "Modelling: Level-1 Intercepts and Slopes\n\np1<-dat %>% group_by(schid) %>%\n  summarise(sector = mean(sector),\n            meanSES = mean(ses))%>%\n  left_join(., coef, by = \"schid\") %>%\n  rename(Intercept = X.Intercept.,\n         Slope_ses = ses) %>%\n  ggplot(aes(x = Slope_ses,\n             y = Intercept))+\n  geom_point(aes(col = factor(sector, labels = c(\"Catholic\",\"Public\"))))+\n  labs(col = \"Sector\")\n\np2<-dat %>% group_by(schid) %>%\n  summarise(sector = mean(sector),\n            meanSES = mean(ses))%>%\n  left_join(., coef, by = \"schid\") %>%\n  rename(Intercept = X.Intercept.,\n         Slope_ses = ses) %>%\n  ggplot(aes(x = Slope_ses,\n             y = Intercept))+\n  geom_point(aes(col = meanSES))\n\ngrid.arrange(p1,p2, ncol=2)\n\n\n\n\n\n\n\nDataKruROO MSEM"
  },
  {
    "objectID": "materials/08HypotheticalModel.html",
    "href": "materials/08HypotheticalModel.html",
    "title": "Hypothetical Model",
    "section": "",
    "text": "ขอให้นิสิตใช้ไฟล์ข้อมูล hsb.sav และ hsb2.sav สำหรับวิเคราะห์เพื่อตอบคำถามวิจัยต่อไปนี้"
  },
  {
    "objectID": "materials/08HypotheticalModel.html#คำอธบายขอมล",
    "href": "materials/08HypotheticalModel.html#คำอธบายขอมล",
    "title": "Hypothetical Model",
    "section": "คำอธิบายข้อมูล",
    "text": "คำอธิบายข้อมูล\n\nsize คือ จำนวนนักเรียนภายในโรงเรียน\nsector คือ ประเภทของโรงเรียน (เหมือน hsb.sav)\npracad คือ สัดส่วนของนักเรียนในโรงเรียนที่เรียนสายสามัญ\ndisclim คือ คะแนนบรรยากาศความมีวิจัยในโรงเรียน\nhimnty คือ ตัวแปรดัมมี่ (1 = มีชนกลุ่มน้อยในโรงเรียนมากกว่าร้อยละ 40, 0 = น้อยกว่าร้อยละ 40)\nmeanses คือ ค่าเฉลี่ยของคะแนนเศรษฐานะระดับโรงเรียน"
  },
  {
    "objectID": "materials/08HypotheticalModel.html#คำถามวจย",
    "href": "materials/08HypotheticalModel.html#คำถามวจย",
    "title": "Hypothetical Model",
    "section": "คำถามวิจัย",
    "text": "คำถามวิจัย\n\nผลสัมฤทธิ์ทางการเรียนโดยเฉลี่ยระดับโรงเรียนมีความแตกต่างกันระหว่างสังกัด (sector) อย่างไร\nอิทธิพลของเศรษฐานะของครอบครัวนักเรียนที่มีต่อผลสัมฤทธิ์ทางการเรียนวิชาคณิตศาสตร์ของนักเรียน มีความแตกต่างกันอย่างไร ตามประเภทของโรงเรียน (sector) และสัดส่วนชนกลุ่มน้อยในโรงเรียน (himnty)"
  },
  {
    "objectID": "materials/08HypotheticalModel.html#modelling",
    "href": "materials/08HypotheticalModel.html#modelling",
    "title": "Hypothetical Model",
    "section": "modelling",
    "text": "modelling\nstudent-level model\n\\(mathach_{ij} = \\beta_{0j} + \\beta_{1j}SES_{ij} + e_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} + \\gamma_{01}Sector_j + u_{0j}\\)\n\\(\\beta_{1j} = \\gamma_{10} + \\gamma_{11}Sector_j + \\gamma_{12}Himnty_j + u_{1j}\\)\nCombined-model\n\\(mathach_{ij} = \\gamma_{00} + \\gamma_{01}Sector_j + u_{0j} + ( \\gamma_{10} + \\gamma_{11}Sector_j + \\gamma_{12}Himnty_j + u_{1j})SES_{ij} + e_{ij}\\)\n\\(mathach_{ij} = \\gamma_{00} + \\gamma_{01}Sector_j + u_{0j} + \\gamma_{10}SES_{ij} + \\gamma_{11}Sector_jSES_{ij} + \\gamma_{12}Himnty_jSES_{ij} + u_{1j}SES_{ij} + e_{ij}\\)\n\\(mathach_{ij} = \\gamma_{00} + \\gamma_{01}Sector_j + \\gamma_{10}SES_{ij} + \\gamma_{11}Sector_jSES_{ij} + \\gamma_{12}Himnty_jSES_{ij} + u_{0j}+u_{1j}SES_{ij} + e_{ij}\\)\n\nlibrary(dplyr)\nlibrary(haven)\n# student level data\ndat<-read_spss(\"datasets/HSB.SAV\")\nglimpse(dat)\n\nRows: 7,185\nColumns: 4\n$ schid   <chr> \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\", \"1224\"…\n$ sector  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ ses     <dbl> -1.528, -0.588, -0.528, -0.668, -0.158, 0.022, -0.618, -0.998,…\n$ mathach <dbl> 5.876, 19.708, 20.349, 8.781, 17.898, 4.583, -2.832, 0.523, 1.…\n\nsummary(dat)\n\n    schid               sector            ses               mathach      \n Length:7185        Min.   :0.0000   Min.   :-3.758000   Min.   :-2.832  \n Class :character   1st Qu.:0.0000   1st Qu.:-0.538000   1st Qu.: 7.275  \n Mode  :character   Median :0.0000   Median : 0.002000   Median :13.131  \n                    Mean   :0.4931   Mean   : 0.000143   Mean   :12.748  \n                    3rd Qu.:1.0000   3rd Qu.: 0.602000   3rd Qu.:18.317  \n                    Max.   :1.0000   Max.   : 2.692000   Max.   :24.993  \n\n# school level data\ndat2<-read_spss(\"/Users/siwachoat/Library/CloudStorage/OneDrive-ChulalongkornUniversity/Documents/MSEM/MSEM/datasets/hsb2.sav\")\nhead(dat2)\n\n# A tibble: 6 × 7\n  schoolid  size sector pracad disclim himnty meanses\n     <dbl> <dbl>  <dbl>  <dbl>   <dbl>  <dbl>   <dbl>\n1     1224   842      0   0.35   1.60       0  -0.428\n2     1288  1855      0   0.27   0.174      0   0.128\n3     1296  1719      0   0.32  -0.137      1  -0.42 \n4     1308   716      1   0.96  -0.622      0   0.534\n5     1317   455      1   0.95  -1.69       1   0.351\n6     1358  1430      0   0.25   1.54       0  -0.014\n\n## merging data\nmerge.dat <- merge(dat, dat2, by.x = \"schid\", by.y =\"schoolid\")\nhead(merge.dat)\n\n  schid sector.x    ses mathach size sector.y pracad disclim himnty meanses\n1  1224        0 -1.528   5.876  842        0   0.35   1.597      0  -0.428\n2  1224        0 -0.588  19.708  842        0   0.35   1.597      0  -0.428\n3  1224        0 -0.528  20.349  842        0   0.35   1.597      0  -0.428\n4  1224        0 -0.668   8.781  842        0   0.35   1.597      0  -0.428\n5  1224        0 -0.158  17.898  842        0   0.35   1.597      0  -0.428\n6  1224        0  0.022   4.583  842        0   0.35   1.597      0  -0.428\n\nmerge.dat <- merge.dat %>%\n  select(-sector.x)\n\nnames(merge.dat)[5]<-\"sector\"\n\n# modeling\nlibrary(lme4)\n\nLoading required package: Matrix\n\nfit<-lmer(mathach ~ 1+sector+ses+sector*ses+himnty*ses + (1 + ses | schid), \n          data= merge.dat)\n\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.00428662 (tol = 0.002, component 1)\n\nsummary(fit)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: mathach ~ 1 + sector + ses + sector * ses + himnty * ses + (1 +  \n    ses | schid)\n   Data: merge.dat\n\nREML criterion at convergence: 46541.2\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-3.10322 -0.72947  0.01724  0.75783  2.99649 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr\n schid    (Intercept)  3.07538 1.7537       \n          ses          0.04075 0.2019   1.00\n Residual             36.78875 6.0654       \nNumber of obs: 7185, groups:  schid, 160\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  12.2300     0.2307  53.007\nsector        2.2349     0.3179   7.030\nses           3.0640     0.1571  19.507\nhimnty       -1.9782     0.3570  -5.541\nsector:ses   -1.2706     0.2128  -5.971\nses:himnty   -0.5387     0.2289  -2.353\n\nCorrelation of Fixed Effects:\n           (Intr) sector ses    himnty sctr:s\nsector     -0.595                            \nses         0.161 -0.136                     \nhimnty     -0.376 -0.064 -0.012              \nsector:ses -0.135  0.127 -0.580 -0.024       \nses:himnty -0.018 -0.020 -0.428  0.249 -0.041\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00428662 (tol = 0.002, component 1)\n\n\n\n\\(\\gamma_{00} = 12.23\\) คือ ค่าเฉลี่ย mathach ของนักเรียนที่มีฐานะปานกลาง ในโรงเรียนรัฐ\nค่าเฉลี่ย mathach ของนักเรียนที่มีฐานะปานกลางในโรงเรียน car เท่ากับ 12.23 + 2.2349 \\(=\\gamma_{00} + \\gamma_{01}(1)\\)\n\\(\\beta_{1j}\\) คืออัตราการเปลี่ยนของ mathach เมื่อเทียบกับ ses ของโรงเรียนที่ j\n\\(\\gamma_{10} = 3.06\\) คือ ค่าเฉลี่ยของอัตราการเปลี่ยนของ mathach เมื่อเทียบกับ ses ของนักเรียนในโรงเรียนรัฐที่มีนักเรียนต่างชาติเป็นส่วนน้อย\nค่าเฉลี่ยของอัตราการเปลี่ยนของ mathach เมื่อเทียบกับ ses ของนักเรียนในโรงเรียน car เท่ากับ 3.06 - 1.27 = 1.79 เมื่อควบคุมให้ปัจจัยจำนวนนักเรียนต่างชาติในโรงเรียนคงที่\n\\(\\beta_{0j}\\) คือค่าเฉลี่ย mathach ของนักเรียนที่มีฐานะปานกลางในโรงเรียน j\n\nlibrary(lmerTest)\n\n\nAttaching package: 'lmerTest'\n\n\nThe following object is masked from 'package:lme4':\n\n    lmer\n\n\nThe following object is masked from 'package:stats':\n\n    step\n\ncoef(fit)\n\n$schid\n     (Intercept)   sector      ses    himnty sector:ses ses:himnty\n1224   11.241236 2.234865 2.950165 -1.978184  -1.270557  -0.538727\n1288   12.845183 2.234865 3.134783 -1.978184  -1.270557  -0.538727\n1296   10.906321 2.234865 2.911614 -1.978184  -1.270557  -0.538727\n1308   12.724127 2.234865 3.120848 -1.978184  -1.270557  -0.538727\n1317   12.431322 2.234865 3.087147 -1.978184  -1.270557  -0.538727\n1358   11.612052 2.234865 2.992851 -1.978184  -1.270557  -0.538727\n1374   10.540892 2.234865 2.869557 -1.978184  -1.270557  -0.538727\n1433   15.068397 2.234865 3.390681 -1.978184  -1.270557  -0.538727\n1436   14.216680 2.234865 3.292645 -1.978184  -1.270557  -0.538727\n1461   14.128594 2.234865 3.282513 -1.978184  -1.270557  -0.538727\n1462   11.159206 2.234865 2.940720 -1.978184  -1.270557  -0.538727\n1477   11.775880 2.234865 3.011702 -1.978184  -1.270557  -0.538727\n1499   11.100892 2.234865 2.934018 -1.978184  -1.270557  -0.538727\n1637   11.232796 2.234865 2.949197 -1.978184  -1.270557  -0.538727\n1906   12.711631 2.234865 3.119412 -1.978184  -1.270557  -0.538727\n1909   13.210379 2.234865 3.176817 -1.978184  -1.270557  -0.538727\n1942   14.761318 2.234865 3.355332 -1.978184  -1.270557  -0.538727\n1946   12.758830 2.234865 3.124844 -1.978184  -1.270557  -0.538727\n2030   11.267216 2.234865 2.953151 -1.978184  -1.270557  -0.538727\n2208   12.401674 2.234865 3.083736 -1.978184  -1.270557  -0.538727\n2277   10.102000 2.234865 2.819029 -1.978184  -1.270557  -0.538727\n2305   11.636863 2.234865 2.995695 -1.978184  -1.270557  -0.538727\n2336   14.451603 2.234865 3.319682 -1.978184  -1.270557  -0.538727\n2458   13.277136 2.234865 3.184507 -1.978184  -1.270557  -0.538727\n2467   11.341851 2.234865 2.961748 -1.978184  -1.270557  -0.538727\n2526   13.785120 2.234865 3.242966 -1.978184  -1.270557  -0.538727\n2626   13.297116 2.234865 3.186802 -1.978184  -1.270557  -0.538727\n2629   12.728091 2.234865 3.121299 -1.978184  -1.270557  -0.538727\n2639   11.115892 2.234865 2.935733 -1.978184  -1.270557  -0.538727\n2651   11.282684 2.234865 2.954940 -1.978184  -1.270557  -0.538727\n2655   15.630348 2.234865 3.455362 -1.978184  -1.270557  -0.538727\n2658   10.840484 2.234865 2.904040 -1.978184  -1.270557  -0.538727\n2755   12.965991 2.234865 3.148685 -1.978184  -1.270557  -0.538727\n2768   11.463639 2.234865 2.975766 -1.978184  -1.270557  -0.538727\n2771   12.810725 2.234865 3.130818 -1.978184  -1.270557  -0.538727\n2818   13.229949 2.234865 3.179069 -1.978184  -1.270557  -0.538727\n2917   11.904652 2.234865 3.026519 -1.978184  -1.270557  -0.538727\n2990   16.148529 2.234865 3.515006 -1.978184  -1.270557  -0.538727\n2995   10.696677 2.234865 2.887480 -1.978184  -1.270557  -0.538727\n3013   12.668131 2.234865 3.114405 -1.978184  -1.270557  -0.538727\n3020   11.832330 2.234865 3.018201 -1.978184  -1.270557  -0.538727\n3039   14.821412 2.234865 3.362253 -1.978184  -1.270557  -0.538727\n3088   12.255043 2.234865 3.066854 -1.978184  -1.270557  -0.538727\n3152   12.922423 2.234865 3.143671 -1.978184  -1.270557  -0.538727\n3332   12.331004 2.234865 3.075598 -1.978184  -1.270557  -0.538727\n3351   12.516525 2.234865 3.096953 -1.978184  -1.270557  -0.538727\n3377   12.412745 2.234865 3.084998 -1.978184  -1.270557  -0.538727\n3427   16.081490 2.234865 3.507280 -1.978184  -1.270557  -0.538727\n3498   12.753804 2.234865 3.124261 -1.978184  -1.270557  -0.538727\n3499   12.388022 2.234865 3.082162 -1.978184  -1.270557  -0.538727\n3533    9.101190 2.234865 2.703841 -1.978184  -1.270557  -0.538727\n3610   12.833726 2.234865 3.133468 -1.978184  -1.270557  -0.538727\n3657   11.665625 2.234865 2.999018 -1.978184  -1.270557  -0.538727\n3688   11.817302 2.234865 3.016471 -1.978184  -1.270557  -0.538727\n3705   10.330004 2.234865 2.845281 -1.978184  -1.270557  -0.538727\n3716   13.365258 2.234865 3.194655 -1.978184  -1.270557  -0.538727\n3838   14.939202 2.234865 3.375805 -1.978184  -1.270557  -0.538727\n3881   11.699266 2.234865 3.002885 -1.978184  -1.270557  -0.538727\n3967   12.646379 2.234865 3.111900 -1.978184  -1.270557  -0.538727\n3992   13.553270 2.234865 3.216283 -1.978184  -1.270557  -0.538727\n3999   13.038337 2.234865 3.157020 -1.978184  -1.270557  -0.538727\n4042   11.518782 2.234865 2.982111 -1.978184  -1.270557  -0.538727\n4173   10.880516 2.234865 2.908650 -1.978184  -1.270557  -0.538727\n4223   12.511361 2.234865 3.096361 -1.978184  -1.270557  -0.538727\n4253    9.940387 2.234865 2.800432 -1.978184  -1.270557  -0.538727\n4292   13.029757 2.234865 3.156021 -1.978184  -1.270557  -0.538727\n4325   13.154704 2.234865 3.170407 -1.978184  -1.270557  -0.538727\n4350   11.666444 2.234865 2.999110 -1.978184  -1.270557  -0.538727\n4383   11.643714 2.234865 2.996495 -1.978184  -1.270557  -0.538727\n4410   12.946636 2.234865 3.146459 -1.978184  -1.270557  -0.538727\n4420   13.934848 2.234865 3.260203 -1.978184  -1.270557  -0.538727\n4458   10.634489 2.234865 2.880328 -1.978184  -1.270557  -0.538727\n4511   11.454390 2.234865 2.974696 -1.978184  -1.270557  -0.538727\n4523    9.045434 2.234865 2.697431 -1.978184  -1.270557  -0.538727\n4530    9.894653 2.234865 2.795177 -1.978184  -1.270557  -0.538727\n4642   13.900599 2.234865 3.256263 -1.978184  -1.270557  -0.538727\n4868   10.187720 2.234865 2.828903 -1.978184  -1.270557  -0.538727\n4931   11.128000 2.234865 2.937129 -1.978184  -1.270557  -0.538727\n5192    9.466926 2.234865 2.745941 -1.978184  -1.270557  -0.538727\n5404   11.807702 2.234865 3.015365 -1.978184  -1.270557  -0.538727\n5619   12.500174 2.234865 3.095082 -1.978184  -1.270557  -0.538727\n5640   13.482620 2.234865 3.208154 -1.978184  -1.270557  -0.538727\n5650   13.578211 2.234865 3.219153 -1.978184  -1.270557  -0.538727\n5667   11.130301 2.234865 2.937402 -1.978184  -1.270557  -0.538727\n5720   12.061825 2.234865 3.044619 -1.978184  -1.270557  -0.538727\n5761   10.021360 2.234865 2.809763 -1.978184  -1.270557  -0.538727\n5762    9.785882 2.234865 2.782653 -1.978184  -1.270557  -0.538727\n5783   12.504746 2.234865 3.095598 -1.978184  -1.270557  -0.538727\n5815   10.239523 2.234865 2.834870 -1.978184  -1.270557  -0.538727\n5819   11.681413 2.234865 3.000828 -1.978184  -1.270557  -0.538727\n5838   12.892546 2.234865 3.140232 -1.978184  -1.270557  -0.538727\n5937   13.927826 2.234865 3.259395 -1.978184  -1.270557  -0.538727\n6074   12.061170 2.234865 3.044541 -1.978184  -1.270557  -0.538727\n6089   14.412208 2.234865 3.315146 -1.978184  -1.270557  -0.538727\n6144   10.339590 2.234865 2.846386 -1.978184  -1.270557  -0.538727\n6170   15.341175 2.234865 3.422077 -1.978184  -1.270557  -0.538727\n6291   13.176073 2.234865 3.172870 -1.978184  -1.270557  -0.538727\n6366   12.732186 2.234865 3.121776 -1.978184  -1.270557  -0.538727\n6397   14.846659 2.234865 3.365154 -1.978184  -1.270557  -0.538727\n6415   12.419251 2.234865 3.085759 -1.978184  -1.270557  -0.538727\n6443   10.830719 2.234865 2.902906 -1.978184  -1.270557  -0.538727\n6464   11.121082 2.234865 2.936335 -1.978184  -1.270557  -0.538727\n6469   14.285111 2.234865 3.300522 -1.978184  -1.270557  -0.538727\n6484   13.064661 2.234865 3.160039 -1.978184  -1.270557  -0.538727\n6578   10.937312 2.234865 2.915187 -1.978184  -1.270557  -0.538727\n6600   12.007583 2.234865 3.038380 -1.978184  -1.270557  -0.538727\n6808   11.647540 2.234865 2.996931 -1.978184  -1.270557  -0.538727\n6816   13.325227 2.234865 3.190037 -1.978184  -1.270557  -0.538727\n6897   13.655799 2.234865 3.228088 -1.978184  -1.270557  -0.538727\n6990    9.566972 2.234865 2.757451 -1.978184  -1.270557  -0.538727\n7011   11.897801 2.234865 3.025743 -1.978184  -1.270557  -0.538727\n7101   11.859391 2.234865 3.021312 -1.978184  -1.270557  -0.538727\n7172    8.984370 2.234865 2.690399 -1.978184  -1.270557  -0.538727\n7232   12.769498 2.234865 3.126075 -1.978184  -1.270557  -0.538727\n7276   12.438962 2.234865 3.088029 -1.978184  -1.270557  -0.538727\n7332   11.973258 2.234865 3.034424 -1.978184  -1.270557  -0.538727\n7341   10.565674 2.234865 2.872402 -1.978184  -1.270557  -0.538727\n7342   11.574087 2.234865 2.988478 -1.978184  -1.270557  -0.538727\n7345   13.153956 2.234865 3.170331 -1.978184  -1.270557  -0.538727\n7364   12.090375 2.234865 3.047901 -1.978184  -1.270557  -0.538727\n7635   12.386644 2.234865 3.082006 -1.978184  -1.270557  -0.538727\n7688   15.099570 2.234865 3.394262 -1.978184  -1.270557  -0.538727\n7697   14.164556 2.234865 3.286645 -1.978184  -1.270557  -0.538727\n7734   13.416151 2.234865 3.200509 -1.978184  -1.270557  -0.538727\n7890   10.183108 2.234865 2.828367 -1.978184  -1.270557  -0.538727\n7919   13.143945 2.234865 3.169172 -1.978184  -1.270557  -0.538727\n8009   11.222824 2.234865 2.948045 -1.978184  -1.270557  -0.538727\n8150   12.044569 2.234865 3.042626 -1.978184  -1.270557  -0.538727\n8165   13.352519 2.234865 3.193178 -1.978184  -1.270557  -0.538727\n8175   13.578912 2.234865 3.219233 -1.978184  -1.270557  -0.538727\n8188   12.337848 2.234865 3.076390 -1.978184  -1.270557  -0.538727\n8193   13.889837 2.234865 3.255024 -1.978184  -1.270557  -0.538727\n8202   11.680047 2.234865 3.000675 -1.978184  -1.270557  -0.538727\n8357   13.909138 2.234865 3.257243 -1.978184  -1.270557  -0.538727\n8367    7.972658 2.234865 2.573945 -1.978184  -1.270557  -0.538727\n8477   12.950399 2.234865 3.146895 -1.978184  -1.270557  -0.538727\n8531   12.275810 2.234865 3.069247 -1.978184  -1.270557  -0.538727\n8627   10.833120 2.234865 2.903187 -1.978184  -1.270557  -0.538727\n8628   14.160225 2.234865 3.286143 -1.978184  -1.270557  -0.538727\n8707   12.389007 2.234865 3.082277 -1.978184  -1.270557  -0.538727\n8775   10.737122 2.234865 2.892137 -1.978184  -1.270557  -0.538727\n8800    9.104465 2.234865 2.704229 -1.978184  -1.270557  -0.538727\n8854    7.903701 2.234865 2.566014 -1.978184  -1.270557  -0.538727\n8857   13.962803 2.234865 3.263422 -1.978184  -1.270557  -0.538727\n8874   12.938358 2.234865 3.145509 -1.978184  -1.270557  -0.538727\n8946   11.494372 2.234865 2.979297 -1.978184  -1.270557  -0.538727\n8983   11.886324 2.234865 3.024412 -1.978184  -1.270557  -0.538727\n9021   11.551381 2.234865 2.985865 -1.978184  -1.270557  -0.538727\n9104   13.027622 2.234865 3.155782 -1.978184  -1.270557  -0.538727\n9158   10.226599 2.234865 2.833385 -1.978184  -1.270557  -0.538727\n9198   14.880062 2.234865 3.369003 -1.978184  -1.270557  -0.538727\n9225   13.444720 2.234865 3.203790 -1.978184  -1.270557  -0.538727\n9292   13.144134 2.234865 3.169190 -1.978184  -1.270557  -0.538727\n9340   12.355989 2.234865 3.078476 -1.978184  -1.270557  -0.538727\n9347   11.210474 2.234865 2.946628 -1.978184  -1.270557  -0.538727\n9359   12.291179 2.234865 3.071010 -1.978184  -1.270557  -0.538727\n9397   10.411716 2.234865 2.854685 -1.978184  -1.270557  -0.538727\n9508   11.808596 2.234865 3.015473 -1.978184  -1.270557  -0.538727\n9550   11.354209 2.234865 2.963171 -1.978184  -1.270557  -0.538727\n9586   11.661078 2.234865 2.998490 -1.978184  -1.270557  -0.538727\n\nattr(,\"class\")\n[1] \"coef.mer\"\n\nranova(fit)\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nmathach ~ sector + ses + himnty + (1 + ses | schid) + sector:ses + ses:himnty\n                         npar logLik   AIC    LRT Df Pr(>Chisq)\n<none>                     10 -23271 46561                     \nses in (1 + ses | schid)    8 -23272 46560 2.6556  2     0.2651\n\n\n\ncentering\n\nfit<-lmer(mathach ~ 1+ses + (1 + ses | schid), \n          data= merge.dat)\nsummary(fit)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: mathach ~ 1 + ses + (1 + ses | schid)\n   Data: merge.dat\n\nREML criterion at convergence: 46640.4\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-3.12272 -0.73046  0.02144  0.75610  2.94356 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n schid    (Intercept)  4.8287  2.1974        \n          ses          0.4129  0.6426   -0.11\n Residual             36.8301  6.0688        \nNumber of obs: 7185, groups:  schid, 160\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(>|t|)    \n(Intercept)  12.6650     0.1898 145.5479   66.71   <2e-16 ***\nses           2.3938     0.1181 157.5299   20.27   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n    (Intr)\nses -0.045\n\n\n\ntype 1\nstudent-level model\n\\(mathach_{ij} = \\beta_{0j} + \\beta_{1j}SES_{ij} + e_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} + u_{0j}\\)\n\\(\\beta_{1j} = \\gamma_{10} + u_{1j}\\)\n\\(\\gamma_{00} = 12.66\\) ค่าเฉลี่นย mathach ของนักเรียนที่มีฐานะปานกลาง ในโรงเรียน j\n\\(\\beta_{0j}\\) ค่าเฉลี่ย mathach ของนักเรียนที่มีฐานะอยู่ในระดับปานกลางของประเทศ ในโรงเรียนที่ j\n\n\ntype2 : centering SES ด้วย group means\nstudent-level model\n\\(mathach_{ij} = \\beta_{0j} + \\beta_{1j}(SES_{ij}-\\overline{SES}_{.j}) + e_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} + u_{0j}\\)\n\\(\\beta_{1j} = \\gamma_{10} + u_{1j}\\)\nintercepe ==> \\(\\beta_{0j}\\) <-- ค่าของ y เมื่อ x เป็น 0 —> ค่าเฉลี่ยของ mathach เมื่อ centering term เป็น 0\n\\(\\beta_{0j}\\) ค่าเฉลี่ย mathach ของนักเรียนที่มีฐานะปานกลางของโรงเรียนที่ j\n\n\ntype3 : centering SES ด้วย grand means\nstudent-level model\n\\(mathach_{ij} = \\beta_{0j} + \\beta_{1j}(SES_{ij}-\\overline{SES}_{..}) + e_{ij}\\)\nschool-level model\n\\(\\beta_{0j} = \\gamma_{00} + u_{0j}\\)\n\\(\\beta_{1j} = \\gamma_{10} + u_{1j}\\)"
  },
  {
    "objectID": "instructors.html",
    "href": "instructors.html",
    "title": "Instructor",
    "section": "",
    "text": "ท่านหัวหน้าภาควิชาวิจัยและจิตวิทยาการศึกษา คณะครุศาสตร์ จุฬาลงกรณ์มหาวิทยาลัย\nKruRoo Co-Founder\n\n\n\n\nวิธีวิทยาการวิจัยเพื่อพัฒนานวัตกรรมทางการศึกษา\n\nการวิจัยปฏิบัติการทางการศึกษา\nการวิจัยการออกแบบ\nการวิจัยการคิดเชิงออกแบบ\n\nการวิจัยสมการโครงสร้าง\nการวิจัยโมเดลสมการเชิงโครงสร้างพหุระดับ\nการวิเคราะห์ข้อมูลการวิจัยด้วยโปรแกรมคอมพิวเตอร์ เช่น SPSS, Mplus, LISREL\nการเลือกและซื้อกระเป๋า Brand name สำหรับการสะสมและลงทุน\n\n\n\n\nกนิษฐ์ ศรีเคลือบ, สิวะโชติ ศรีสุทธิยากร และคณะ. (2562). รายงานผลการสำรวจการวิเคราะห์ความต้องการและความจำเป็นของนักเรียนทุนเสมอภาคในสถานการณ์การระบาดไวรัสโคโรนา (COVID-19). กองทุนเพื่อความเสมอภาคทางการศึกษา (กสศ.)"
  },
  {
    "objectID": "instructors.html#ผศ.ดร.สวะโชต-ศรสทธยากร",
    "href": "instructors.html#ผศ.ดร.สวะโชต-ศรสทธยากร",
    "title": "Instructor",
    "section": "ผศ.ดร.สิวะโชติ ศรีสุทธิยากร",
    "text": "ผศ.ดร.สิวะโชติ ศรีสุทธิยากร\n\n\nอาจารย์ประจำภาควิชาวิจัยและจิตวิทยาการศึกษา คณะครุศาสตร์ จุฬาลงกรณ์มหาวิทยาลัย\nKruRoo Co-Founder\nDataKruRoo Founder\n\n\nความเชี่ยวชาญเฉพาะ\n\nสถิติและวิทยาการข้อมูลทางการศึกษา\nการพัฒนาทัศนภาพข้อมูลทางการศึกษา\nการเรียนรู้ของเครื่องและการประยุกต์สำหรับการวิจัยทางการศึกษา\nการจำลองแบบมอนติคาร์โล\nสถิติวิเคราะห์แบบเบย์\nR programming\n\n\n\nผลงานทางวิชาการ\nPanidvadtana, P., Sujiva, S., & Srisuttiyakorn, S. (2021). A Comparison of the Accuracy of Multidimensional IRT equating methods for Mixed-Format Tests, Kasetsart Journal of Social Sciences, 42, 215-220. (Scopus)\nสิวะโชติ ศรีสุทธิยากร. (2562). ความเหลื่อมล้ำทางการศึกษาและปัจจัยที่ส่งผล : การวิเคราะห์พหุระดับร่วมกับดัชนีเอ็นโทรปีนัยทั่วไปที่อิงมัธยฐาน. วารสารวิธีวิทยาการวิจัย. 32(3), 342-379. (TCI1)\nวรรณี แกมเกตุ, ดวงกมล ไตรวิจิตรคุณ, สิวะโชติ ศรีสุทธิยากร, เมษา นวลศรี, กษิดิศ ครุฑางคะ  และภานุวัฒน์ เข็มกลัด. (2562). รายงานการติดตามและประเมินผลการดำเนินงานตามแผนการศึกษาแห่งชาติ พ.ศ. 2560-2579 : ช่วงปี พ.ศ. 2560-2562. สำนักงานเลขาธิการสภาการศึกษา กระทรวงศึกษาธิการ.\nกนิษฐ์ ศรีเคลือบ, สิวะโชติ ศรีสุทธิยากร และคณะ. (2562). รายงานผลการสำรวจการวิเคราะห์ความต้องการและความจำเป็นของนักเรียนทุนเสมอภาคในสถานการณ์การระบาดไวรัสโคโรนา (COVID-19). กองทุนเพื่อความเสมอภาคทางการศึกษา (กสศ.)\n\n\nหนังสือ\nสิวะโชติ ศรีสุทธิยากร. (2564). สถิติและวิทยาการข้อมูลทางการศึกษา : R สำหรับจัดระเบียบและจัดกระทำข้อมูล. กรุงเทพมหานคร : คณะครุศาสตร์ จุฬาลงกรณ์มหาวิทยาลัย. สืบค้นจาก https://m.chulabook.com/th/product-details/120204"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "2756713 MSEM RES",
    "section": "Overview",
    "text": "Overview\nรหัสวิชา 2756713 การวิจัยโมเดลสมการโครงสร้างพหุระดับ 2(2-0-6) หน่วยกิต\nมโนทัศน์ สาระสำคัญของการวิจัยโมเดลสมการโครงสร้างพหุระดับ ลักษณะของข้อมูลพหุระดับแบบต่าง ๆ (โมเดลซ้อน โมเดลจำแนกข้ามกลุ่ม โมเดลพหุระดับพหุสมาชิก) ความเชื่อมโยงระหว่างข้อมูลพหุระดับ ตัวแปรปรับ อิทธิพลปฏิสัมพันธ์ การกำหนดปัญหาวิจัย สมมุติฐาน กรอบแนวคิด การกำหนดตัวอย่างวิจัย เครื่องมือวิจัย และการวิเคราะห์ข้อมูลพหุระดับ ได้แก่ การวิเคราะห์องค์ประกอบเชิงสำรวจและเชิงยืนยันพหุระดับ โมเดลสมการโครงสร้างเชิงเส้นตรงระดับลดหลั่น การวิเคราะห์เส้นทางแบบพหุระดับ โมเดลสมการโครงสร้างพหุระดับที่มีตัวแปรแฝง การวิเคราะห์พหุระดับและพหุกลุ่ม การวิเคราะห์พหุระดับที่มีตัวแปรส่งผ่าน ตัวแปรปรับ และการวิเคราะห์ปฏิสัมพันธ์ข้ามระดับ\n\n\n\n\n\n\nImportant\n\n\n\nช่องทางการเข้าห้องเรียน ผ่าน zoom กดลิงค์ด้านขวาเลย here"
  },
  {
    "objectID": "index.html#materials",
    "href": "index.html#materials",
    "title": "2756713 MSEM RES",
    "section": "Materials",
    "text": "Materials\nMaterial สำหรับรายวิชา การวิจัยโมเดลสมการโครงสร้างพหุระดับ\n\n\n\n\n\n\n\n\n\n\n\nสัปดาห์ที่\nวันที่\nหัวข้อ\nเอกสาร\nชุดข้อมูลตัวอย่าง\nกิจกรรม/การบ้าน\n\n\n\n\n7\n3 มี.ค. 66\nHierarchical Linear Modelling 🖥️\n📖 HLM\nHSB.csv, HSB.sav\n😓 HW07\n\n\n8\n10 มี.ค.\nHierarchical Linear Modelling 2\n\n\n\n\n\n9\n17 มี.ค.\nHierarchical Linear Modelling 3\nHLM2\nHSB2.sav"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "homeworks/hw_wk07.html",
    "href": "homeworks/hw_wk07.html",
    "title": "2756714 MSEM RES",
    "section": "",
    "text": "ชุดข้อมูล sleepstudy เป็นชุดข้อมูลตัวอย่างของ pacakge lme4 ในการวิจัยที่ศึกษาการอดนอนของคน ตัวแปรตามคือ Reaction เป็นค่าเฉลี่ยของความเร็วในการตอบสนองของผู้เข้าร่วมวิจัย (ms) ส่วนตัวแปรที่เหลือได้แก่ day คือจำนวนวันที่อดนอน และ subject คือรหัสของผู้เข้าร่วมวิจัย\n\n#install.packages(lme4)\nlibrary(lme4)\n\nLoading required package: Matrix\n\nhead(sleepstudy)\n\n  Reaction Days Subject\n1 249.5600    0     308\n2 258.7047    1     308\n3 250.8006    2     308\n4 321.4398    3     308\n5 356.8519    4     308\n6 414.6901    5     308\n\n\nหากลองสำรวจข้อมูลข้างต้นจะเห็นว่ามีโครงสร้างเป็นข้อมูลระดับลดหลั่นแบบ 2 ระดับ โดยระดับที่ 1 คือวันที่อดนอน และระดับที่ 2 คือผู้เข้าร่วมวิจัย\n\n\n\nทดลองวิเคราะห์ ols regression โดยตัวแปรตามเป็น Reaction และตัวแปรอิสระเป็น Day ผลที่ได้เป็นอย่างไร?\nพิจารณาผลการสำรวจข้อมูลในรูปด้านล่าง นิสิตสามารถสรุปอะไรได้บ้าง?\n\n\n\n\n\n\n\nเมื่อพิจารณารูปแล้วนิสิตคิดว่า ols regression ในข้อ 1. เป็นโมเดลที่เหมาะสำหรับวิเคราะห์ข้อมูลชุดนี้อยู่หรือไม่ เพราะเหตุใด\nจงดำเนินการวิเคราะห์ข้อมูลเพื่อตอบคำถามวิจัย “ค่าเฉลี่ยของความเร็วในการตอบสนองของคนที่อดนอนมีความแตกต่างกันอย่างไร”\nจงดำเนินการวิเคราะห์ข้อมูลเพื่อตอบคำถามวิจัย “ระยะเวลาการอดนอน (วัน) มีผลต่อค่าเฉลี่ยของความเร็วในการตอบสนองของคนที่อดนอนอย่างไร”\nจงดำเนินการวิเคราะห์ข้อมูลเพื่อตอบคำถามวิจัย “อิทธิพลของการอดนอนที่มีต่อความเร็วในการตอบสนองต่อส่ิงเร้า มีความแตกต่างกันระหว่างผู้เข้าร่วมวิจัยหรือไม่”\n\n\n\n\nส่งงานโดยแนบ file มาใน padlet ด้านล่างนี้"
  }
]